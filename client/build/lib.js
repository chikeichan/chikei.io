(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
(function(){
"use strict";
var GLOBAL_AJAX_REQUEST_INTERCEPT = function(req) { 
    return req;
};
var GLOBAL_AJAX_RESPONSE_INTERCEPT = function(res) {
    return res;
};

var Ajax = function(opts) {
    var xhr        = new XMLHttpRequest();
    xhr.onload  = function() {
        var response = GLOBAL_AJAX_RESPONSE_INTERCEPT(xhr);
        opts.onload(response);
    };

    this.url     = opts.url;
    this.type    = opts.type.toUpperCase();
    this.headers = {};
    this.xhr     = xhr;
    GLOBAL_AJAX_REQUEST_INTERCEPT(this);
};

Ajax.prototype.setUrl = function(url) {
    if (!url) throw new Error('Expect parameter: url.');
    this.url = url;
};

Ajax.prototype.setType = function(type) {
    if (!type) throw new Error('Expect parameter: type.');
    this.type = type.toUpperCase();
};

Ajax.prototype.setHeader = function(key, value) {
    this.headers[key] = value;
};

Ajax.prototype.send = function(payload) {
    if (!this.url) throw new Error('Expect request to contain property: url.');
    if (!this.type) throw new Error('Expect request to contain property: type.');

    this.xhr.open(this.type, this.url);

    for (var header in this.headers) {
        this.xhr.setRequestHeader(header, this.headers[header]);
    }

    if (payload) {
        this.xhr.send(payload);
    } else {
        this.xhr.send();
    }
};

function defaults(obj, def) {
    def = def || {};
    
    for (var key in def) {
        if (!obj[key]) {
            obj[key] = def[key];
        }
    }

    return obj;
}
function extend(methods) {
    var parent = this._constructor;

    if (!parent) {
        return;
    }

    var staticAttr = {};
    var child = function() {
        for (var key in staticAttr) {
            this[key] = staticAttr[key];
        }
        parent.apply(this, arguments);
    };
    
    var extended = {};

    for (var prop in parent.prototype) {
        if (Object.prototype.hasOwnProperty.call(parent.prototype, prop)) {
            extended[prop] = parent.prototype[prop];
        }
    }

    for (var met in methods) {
        if (Object.prototype.hasOwnProperty.call(methods, met)) {
            var method = methods[met];
            if (typeof method === 'function') {
                extended[met] = methods[met];
            } else {
                staticAttr[met] = methods[met];
            }
        }
    }

    child.prototype = Object.create(extended);

    return child;
}

function idGenerator(str) {
    var count = 1;

    return function() {
        var id = str + count;
        count++;
        return id;
    };
}

/**
 * @license
 * Copyright (c) 2014 The Polymer Project Authors. All rights reserved.
 * This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
 * The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
 * The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
 * Code distributed by Google as part of the polymer project is also
 * subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
 */
// @version 0.7.12-86a041b
window.WebComponents=window.WebComponents||{},function(e){var t=e.flags||{},n="webcomponents.js",r=document.querySelector('script[src*="'+n+'"]');if(!t.noOpts){if(location.search.slice(1).split("&").forEach(function(e){var n,r=e.split("=");r[0]&&(n=r[0].match(/wc-(.+)/))&&(t[n[1]]=r[1]||!0)}),r)for(var o,i=0;o=r.attributes[i];i++)"src"!==o.name&&(t[o.name]=o.value||!0);if(t.log&&t.log.split){var a=t.log.split(",");t.log={},a.forEach(function(e){t.log[e]=!0})}else t.log={}}t.shadow=t.shadow||t.shadowdom||t.polyfill,"native"===t.shadow?t.shadow=!1:t.shadow=t.shadow||!HTMLElement.prototype.createShadowRoot,t.register&&(window.CustomElements=window.CustomElements||{flags:{}},window.CustomElements.flags.register=t.register),e.flags=t}(WebComponents),WebComponents.flags.shadow&&("undefined"==typeof WeakMap&&!function(){var e=Object.defineProperty,t=Date.now()%1e9,n=function(){this.name="__st"+(1e9*Math.random()>>>0)+(t++ +"__")};n.prototype={set:function(t,n){var r=t[this.name];return r&&r[0]===t?r[1]=n:e(t,this.name,{value:[t,n],writable:!0}),this},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},"delete":function(e){var t=e[this.name];return t&&t[0]===e?(t[0]=t[1]=void 0,!0):!1},has:function(e){var t=e[this.name];return t?t[0]===e:!1}},window.WeakMap=n}(),window.ShadowDOMPolyfill={},function(e){"use strict";function t(){if("undefined"!=typeof chrome&&chrome.app&&chrome.app.runtime)return!1;if(navigator.getDeviceStorage)return!1;try{var e=new Function("return true;");return e()}catch(t){return!1}}function n(e){if(!e)throw new Error("Assertion failed")}function r(e,t){for(var n=W(t),r=0;r<n.length;r++){var o=n[r];A(e,o,F(t,o))}return e}function o(e,t){for(var n=W(t),r=0;r<n.length;r++){var o=n[r];switch(o){case"arguments":case"caller":case"length":case"name":case"prototype":case"toString":continue}A(e,o,F(t,o))}return e}function i(e,t){for(var n=0;n<t.length;n++)if(t[n]in e)return t[n]}function a(e,t,n){U.value=n,A(e,t,U)}function s(e,t){var n=e.__proto__||Object.getPrototypeOf(e);if(q)try{W(n)}catch(r){n=n.__proto__}var o=R.get(n);if(o)return o;var i=s(n),a=E(i);return g(n,a,t),a}function c(e,t){w(e,t,!0)}function l(e,t){w(t,e,!1)}function u(e){return/^on[a-z]+$/.test(e)}function d(e){return/^[a-zA-Z_$][a-zA-Z_$0-9]*$/.test(e)}function p(e){return k&&d(e)?new Function("return this.__impl4cf1e782hg__."+e):function(){return this.__impl4cf1e782hg__[e]}}function h(e){return k&&d(e)?new Function("v","this.__impl4cf1e782hg__."+e+" = v"):function(t){this.__impl4cf1e782hg__[e]=t}}function f(e){return k&&d(e)?new Function("return this.__impl4cf1e782hg__."+e+".apply(this.__impl4cf1e782hg__, arguments)"):function(){return this.__impl4cf1e782hg__[e].apply(this.__impl4cf1e782hg__,arguments)}}function m(e,t){try{return Object.getOwnPropertyDescriptor(e,t)}catch(n){return B}}function w(t,n,r,o){for(var i=W(t),a=0;a<i.length;a++){var s=i[a];if("polymerBlackList_"!==s&&!(s in n||t.polymerBlackList_&&t.polymerBlackList_[s])){q&&t.__lookupGetter__(s);var c,l,d=m(t,s);if("function"!=typeof d.value){var w=u(s);c=w?e.getEventHandlerGetter(s):p(s),(d.writable||d.set||V)&&(l=w?e.getEventHandlerSetter(s):h(s));var v=V||d.configurable;A(n,s,{get:c,set:l,configurable:v,enumerable:d.enumerable})}else r&&(n[s]=f(s))}}}function v(e,t,n){if(null!=e){var r=e.prototype;g(r,t,n),o(t,e)}}function g(e,t,r){var o=t.prototype;n(void 0===R.get(e)),R.set(e,t),I.set(o,e),c(e,o),r&&l(o,r),a(o,"constructor",t),t.prototype=o}function b(e,t){return R.get(t.prototype)===e}function y(e){var t=Object.getPrototypeOf(e),n=s(t),r=E(n);return g(t,r,e),r}function E(e){function t(t){e.call(this,t)}var n=Object.create(e.prototype);return n.constructor=t,t.prototype=n,t}function _(e){return e&&e.__impl4cf1e782hg__}function S(e){return!_(e)}function T(e){if(null===e)return null;n(S(e));var t=e.__wrapper8e3dd93a60__;return null!=t?t:e.__wrapper8e3dd93a60__=new(s(e,e))(e)}function M(e){return null===e?null:(n(_(e)),e.__impl4cf1e782hg__)}function O(e){return e.__impl4cf1e782hg__}function L(e,t){t.__impl4cf1e782hg__=e,e.__wrapper8e3dd93a60__=t}function N(e){return e&&_(e)?M(e):e}function C(e){return e&&!_(e)?T(e):e}function j(e,t){null!==t&&(n(S(e)),n(void 0===t||_(t)),e.__wrapper8e3dd93a60__=t)}function D(e,t,n){G.get=n,A(e.prototype,t,G)}function H(e,t){D(e,t,function(){return T(this.__impl4cf1e782hg__[t])})}function x(e,t){e.forEach(function(e){t.forEach(function(t){e.prototype[t]=function(){var e=C(this);return e[t].apply(e,arguments)}})})}var R=new WeakMap,I=new WeakMap,P=Object.create(null),k=t(),A=Object.defineProperty,W=Object.getOwnPropertyNames,F=Object.getOwnPropertyDescriptor,U={value:void 0,configurable:!0,enumerable:!1,writable:!0};W(window);var q=/Firefox/.test(navigator.userAgent),B={get:function(){},set:function(e){},configurable:!0,enumerable:!0},V=function(){var e=Object.getOwnPropertyDescriptor(Node.prototype,"nodeType");return e&&!e.get&&!e.set}(),G={get:void 0,configurable:!0,enumerable:!0};e.assert=n,e.constructorTable=R,e.defineGetter=D,e.defineWrapGetter=H,e.forwardMethodsToWrapper=x,e.isIdentifierName=d,e.isWrapper=_,e.isWrapperFor=b,e.mixin=r,e.nativePrototypeTable=I,e.oneOf=i,e.registerObject=y,e.registerWrapper=v,e.rewrap=j,e.setWrapper=L,e.unsafeUnwrap=O,e.unwrap=M,e.unwrapIfNeeded=N,e.wrap=T,e.wrapIfNeeded=C,e.wrappers=P}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e,t,n){return{index:e,removed:t,addedCount:n}}function n(){}var r=0,o=1,i=2,a=3;n.prototype={calcEditDistances:function(e,t,n,r,o,i){for(var a=i-o+1,s=n-t+1,c=new Array(a),l=0;a>l;l++)c[l]=new Array(s),c[l][0]=l;for(var u=0;s>u;u++)c[0][u]=u;for(var l=1;a>l;l++)for(var u=1;s>u;u++)if(this.equals(e[t+u-1],r[o+l-1]))c[l][u]=c[l-1][u-1];else{var d=c[l-1][u]+1,p=c[l][u-1]+1;c[l][u]=p>d?d:p}return c},spliceOperationsFromEditDistances:function(e){for(var t=e.length-1,n=e[0].length-1,s=e[t][n],c=[];t>0||n>0;)if(0!=t)if(0!=n){var l,u=e[t-1][n-1],d=e[t-1][n],p=e[t][n-1];l=p>d?u>d?d:u:u>p?p:u,l==u?(u==s?c.push(r):(c.push(o),s=u),t--,n--):l==d?(c.push(a),t--,s=d):(c.push(i),n--,s=p)}else c.push(a),t--;else c.push(i),n--;return c.reverse(),c},calcSplices:function(e,n,s,c,l,u){var d=0,p=0,h=Math.min(s-n,u-l);if(0==n&&0==l&&(d=this.sharedPrefix(e,c,h)),s==e.length&&u==c.length&&(p=this.sharedSuffix(e,c,h-d)),n+=d,l+=d,s-=p,u-=p,s-n==0&&u-l==0)return[];if(n==s){for(var f=t(n,[],0);u>l;)f.removed.push(c[l++]);return[f]}if(l==u)return[t(n,[],s-n)];for(var m=this.spliceOperationsFromEditDistances(this.calcEditDistances(e,n,s,c,l,u)),f=void 0,w=[],v=n,g=l,b=0;b<m.length;b++)switch(m[b]){case r:f&&(w.push(f),f=void 0),v++,g++;break;case o:f||(f=t(v,[],0)),f.addedCount++,v++,f.removed.push(c[g]),g++;break;case i:f||(f=t(v,[],0)),f.addedCount++,v++;break;case a:f||(f=t(v,[],0)),f.removed.push(c[g]),g++}return f&&w.push(f),w},sharedPrefix:function(e,t,n){for(var r=0;n>r;r++)if(!this.equals(e[r],t[r]))return r;return n},sharedSuffix:function(e,t,n){for(var r=e.length,o=t.length,i=0;n>i&&this.equals(e[--r],t[--o]);)i++;return i},calculateSplices:function(e,t){return this.calcSplices(e,0,e.length,t,0,t.length)},equals:function(e,t){return e===t}},e.ArraySplice=n}(window.ShadowDOMPolyfill),function(e){"use strict";function t(){a=!1;var e=i.slice(0);i=[];for(var t=0;t<e.length;t++)e[t]()}function n(e){i.push(e),a||(a=!0,r(t,0))}var r,o=window.MutationObserver,i=[],a=!1;if(o){var s=1,c=new o(t),l=document.createTextNode(s);c.observe(l,{characterData:!0}),r=function(){s=(s+1)%2,l.data=s}}else r=window.setTimeout;e.setEndOfMicrotask=n}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){e.scheduled_||(e.scheduled_=!0,f.push(e),m||(u(n),m=!0))}function n(){for(m=!1;f.length;){var e=f;f=[],e.sort(function(e,t){return e.uid_-t.uid_});for(var t=0;t<e.length;t++){var n=e[t];n.scheduled_=!1;var r=n.takeRecords();i(n),r.length&&n.callback_(r,n)}}}function r(e,t){this.type=e,this.target=t,this.addedNodes=new p.NodeList,this.removedNodes=new p.NodeList,this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function o(e,t){for(;e;e=e.parentNode){var n=h.get(e);if(n)for(var r=0;r<n.length;r++){var o=n[r];o.options.subtree&&o.addTransientObserver(t)}}}function i(e){for(var t=0;t<e.nodes_.length;t++){var n=e.nodes_[t],r=h.get(n);if(!r)return;for(var o=0;o<r.length;o++){var i=r[o];i.observer===e&&i.removeTransientObservers()}}}function a(e,n,o){for(var i=Object.create(null),a=Object.create(null),s=e;s;s=s.parentNode){var c=h.get(s);if(c)for(var l=0;l<c.length;l++){var u=c[l],d=u.options;if((s===e||d.subtree)&&("attributes"!==n||d.attributes)&&("attributes"!==n||!d.attributeFilter||null===o.namespace&&-1!==d.attributeFilter.indexOf(o.name))&&("characterData"!==n||d.characterData)&&("childList"!==n||d.childList)){var p=u.observer;i[p.uid_]=p,("attributes"===n&&d.attributeOldValue||"characterData"===n&&d.characterDataOldValue)&&(a[p.uid_]=o.oldValue)}}}for(var f in i){var p=i[f],m=new r(n,e);"name"in o&&"namespace"in o&&(m.attributeName=o.name,m.attributeNamespace=o.namespace),o.addedNodes&&(m.addedNodes=o.addedNodes),o.removedNodes&&(m.removedNodes=o.removedNodes),o.previousSibling&&(m.previousSibling=o.previousSibling),o.nextSibling&&(m.nextSibling=o.nextSibling),void 0!==a[f]&&(m.oldValue=a[f]),t(p),p.records_.push(m)}}function s(e){if(this.childList=!!e.childList,this.subtree=!!e.subtree,"attributes"in e||!("attributeOldValue"in e||"attributeFilter"in e)?this.attributes=!!e.attributes:this.attributes=!0,"characterDataOldValue"in e&&!("characterData"in e)?this.characterData=!0:this.characterData=!!e.characterData,!this.attributes&&(e.attributeOldValue||"attributeFilter"in e)||!this.characterData&&e.characterDataOldValue)throw new TypeError;if(this.characterData=!!e.characterData,this.attributeOldValue=!!e.attributeOldValue,this.characterDataOldValue=!!e.characterDataOldValue,"attributeFilter"in e){if(null==e.attributeFilter||"object"!=typeof e.attributeFilter)throw new TypeError;this.attributeFilter=w.call(e.attributeFilter)}else this.attributeFilter=null}function c(e){this.callback_=e,this.nodes_=[],this.records_=[],this.uid_=++v,this.scheduled_=!1}function l(e,t,n){this.observer=e,this.target=t,this.options=n,this.transientObservedNodes=[]}var u=e.setEndOfMicrotask,d=e.wrapIfNeeded,p=e.wrappers,h=new WeakMap,f=[],m=!1,w=Array.prototype.slice,v=0;c.prototype={constructor:c,observe:function(e,t){e=d(e);var n,r=new s(t),o=h.get(e);o||h.set(e,o=[]);for(var i=0;i<o.length;i++)o[i].observer===this&&(n=o[i],n.removeTransientObservers(),n.options=r);n||(n=new l(this,e,r),o.push(n),this.nodes_.push(e))},disconnect:function(){this.nodes_.forEach(function(e){for(var t=h.get(e),n=0;n<t.length;n++){var r=t[n];if(r.observer===this){t.splice(n,1);break}}},this),this.records_=[]},takeRecords:function(){var e=this.records_;return this.records_=[],e}},l.prototype={addTransientObserver:function(e){if(e!==this.target){t(this.observer),this.transientObservedNodes.push(e);var n=h.get(e);n||h.set(e,n=[]),n.push(this)}},removeTransientObservers:function(){var e=this.transientObservedNodes;this.transientObservedNodes=[];for(var t=0;t<e.length;t++)for(var n=e[t],r=h.get(n),o=0;o<r.length;o++)if(r[o]===this){r.splice(o,1);break}}},e.enqueueMutation=a,e.registerTransientObservers=o,e.wrappers.MutationObserver=c,e.wrappers.MutationRecord=r}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e,t){this.root=e,this.parent=t}function n(e,t){if(e.treeScope_!==t){e.treeScope_=t;for(var r=e.shadowRoot;r;r=r.olderShadowRoot)r.treeScope_.parent=t;for(var o=e.firstChild;o;o=o.nextSibling)n(o,t)}}function r(n){if(n instanceof e.wrappers.Window,n.treeScope_)return n.treeScope_;var o,i=n.parentNode;return o=i?r(i):new t(n,null),n.treeScope_=o}t.prototype={get renderer(){return this.root instanceof e.wrappers.ShadowRoot?e.getRendererForHost(this.root.host):null},contains:function(e){for(;e;e=e.parent)if(e===this)return!0;return!1}},e.TreeScope=t,e.getTreeScope=r,e.setTreeScope=n}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){return e instanceof G.ShadowRoot}function n(e){return A(e).root}function r(e,r){var s=[],c=e;for(s.push(c);c;){var l=a(c);if(l&&l.length>0){for(var u=0;u<l.length;u++){var p=l[u];if(i(p)){var h=n(p),f=h.olderShadowRoot;f&&s.push(f)}s.push(p)}c=l[l.length-1]}else if(t(c)){if(d(e,c)&&o(r))break;c=c.host,s.push(c)}else c=c.parentNode,c&&s.push(c)}return s}function o(e){if(!e)return!1;switch(e.type){case"abort":case"error":case"select":case"change":case"load":case"reset":case"resize":case"scroll":case"selectstart":return!0}return!1}function i(e){return e instanceof HTMLShadowElement}function a(t){return e.getDestinationInsertionPoints(t)}function s(e,t){if(0===e.length)return t;t instanceof G.Window&&(t=t.document);for(var n=A(t),r=e[0],o=A(r),i=l(n,o),a=0;a<e.length;a++){var s=e[a];if(A(s)===i)return s}return e[e.length-1]}function c(e){for(var t=[];e;e=e.parent)t.push(e);return t}function l(e,t){for(var n=c(e),r=c(t),o=null;n.length>0&&r.length>0;){var i=n.pop(),a=r.pop();if(i!==a)break;o=i}return o}function u(e,t,n){t instanceof G.Window&&(t=t.document);var o,i=A(t),a=A(n),s=r(n,e),o=l(i,a);o||(o=a.root);for(var c=o;c;c=c.parent)for(var u=0;u<s.length;u++){var d=s[u];if(A(d)===c)return d}return null}function d(e,t){return A(e)===A(t)}function p(e){if(!K.get(e)&&(K.set(e,!0),f(V(e),V(e.target)),P)){var t=P;throw P=null,t}}function h(e){switch(e.type){case"load":case"beforeunload":case"unload":return!0}return!1}function f(t,n){if($.get(t))throw new Error("InvalidStateError");$.set(t,!0),e.renderAllPending();var o,i,a;if(h(t)&&!t.bubbles){var s=n;s instanceof G.Document&&(a=s.defaultView)&&(i=s,o=[])}if(!o)if(n instanceof G.Window)a=n,o=[];else if(o=r(n,t),!h(t)){var s=o[o.length-1];s instanceof G.Document&&(a=s.defaultView)}return ne.set(t,o),m(t,o,a,i)&&w(t,o,a,i)&&v(t,o,a,i),J.set(t,re),Y["delete"](t,null),$["delete"](t),t.defaultPrevented}function m(e,t,n,r){var o=oe;if(n&&!g(n,e,o,t,r))return!1;for(var i=t.length-1;i>0;i--)if(!g(t[i],e,o,t,r))return!1;return!0}function w(e,t,n,r){var o=ie,i=t[0]||n;return g(i,e,o,t,r)}function v(e,t,n,r){for(var o=ae,i=1;i<t.length;i++)if(!g(t[i],e,o,t,r))return;n&&t.length>0&&g(n,e,o,t,r)}function g(e,t,n,r,o){var i=z.get(e);if(!i)return!0;var a=o||s(r,e);if(a===e){if(n===oe)return!0;n===ae&&(n=ie)}else if(n===ae&&!t.bubbles)return!0;if("relatedTarget"in t){var c=B(t),l=c.relatedTarget;if(l){if(l instanceof Object&&l.addEventListener){var d=V(l),p=u(t,e,d);if(p===a)return!0}else p=null;Z.set(t,p)}}J.set(t,n);var h=t.type,f=!1;X.set(t,a),Y.set(t,e),i.depth++;for(var m=0,w=i.length;w>m;m++){var v=i[m];if(v.removed)f=!0;else if(!(v.type!==h||!v.capture&&n===oe||v.capture&&n===ae))try{if("function"==typeof v.handler?v.handler.call(e,t):v.handler.handleEvent(t),ee.get(t))return!1}catch(g){P||(P=g)}}if(i.depth--,f&&0===i.depth){var b=i.slice();i.length=0;for(var m=0;m<b.length;m++)b[m].removed||i.push(b[m])}return!Q.get(t)}function b(e,t,n){this.type=e,this.handler=t,this.capture=Boolean(n)}function y(e,t){if(!(e instanceof se))return V(T(se,"Event",e,t));var n=e;return ge||"beforeunload"!==n.type||this instanceof M?void U(n,this):new M(n)}function E(e){return e&&e.relatedTarget?Object.create(e,{relatedTarget:{value:B(e.relatedTarget)}}):e}function _(e,t,n){var r=window[e],o=function(t,n){return t instanceof r?void U(t,this):V(T(r,e,t,n))};if(o.prototype=Object.create(t.prototype),n&&W(o.prototype,n),r)try{F(r,o,new r("temp"))}catch(i){F(r,o,document.createEvent(e))}return o}function S(e,t){return function(){arguments[t]=B(arguments[t]);var n=B(this);n[e].apply(n,arguments)}}function T(e,t,n,r){if(we)return new e(n,E(r));var o=B(document.createEvent(t)),i=me[t],a=[n];return Object.keys(i).forEach(function(e){var t=null!=r&&e in r?r[e]:i[e];"relatedTarget"===e&&(t=B(t)),a.push(t)}),o["init"+t].apply(o,a),o}function M(e){y.call(this,e)}function O(e){return"function"==typeof e?!0:e&&e.handleEvent}function L(e){switch(e){case"DOMAttrModified":case"DOMAttributeNameChanged":case"DOMCharacterDataModified":case"DOMElementNameChanged":case"DOMNodeInserted":case"DOMNodeInsertedIntoDocument":case"DOMNodeRemoved":case"DOMNodeRemovedFromDocument":case"DOMSubtreeModified":return!0}return!1}function N(e){U(e,this)}function C(e){return e instanceof G.ShadowRoot&&(e=e.host),B(e)}function j(e,t){var n=z.get(e);if(n)for(var r=0;r<n.length;r++)if(!n[r].removed&&n[r].type===t)return!0;return!1}function D(e,t){for(var n=B(e);n;n=n.parentNode)if(j(V(n),t))return!0;return!1}function H(e){k(e,ye)}function x(t,n,o,i){e.renderAllPending();var a=V(Ee.call(q(n),o,i));if(!a)return null;var c=r(a,null),l=c.lastIndexOf(t);return-1==l?null:(c=c.slice(0,l),s(c,t))}function R(e){return function(){var t=te.get(this);return t&&t[e]&&t[e].value||null}}function I(e){var t=e.slice(2);return function(n){var r=te.get(this);r||(r=Object.create(null),te.set(this,r));var o=r[e];if(o&&this.removeEventListener(t,o.wrapped,!1),"function"==typeof n){var i=function(t){var r=n.call(this,t);r===!1?t.preventDefault():"onbeforeunload"===e&&"string"==typeof r&&(t.returnValue=r)};this.addEventListener(t,i,!1),r[e]={value:n,wrapped:i}}}}var P,k=e.forwardMethodsToWrapper,A=e.getTreeScope,W=e.mixin,F=e.registerWrapper,U=e.setWrapper,q=e.unsafeUnwrap,B=e.unwrap,V=e.wrap,G=e.wrappers,z=(new WeakMap,new WeakMap),K=new WeakMap,$=new WeakMap,X=new WeakMap,Y=new WeakMap,Z=new WeakMap,J=new WeakMap,Q=new WeakMap,ee=new WeakMap,te=new WeakMap,ne=new WeakMap,re=0,oe=1,ie=2,ae=3;b.prototype={equals:function(e){return this.handler===e.handler&&this.type===e.type&&this.capture===e.capture},get removed(){return null===this.handler},remove:function(){this.handler=null}};var se=window.Event;se.prototype.polymerBlackList_={returnValue:!0,keyLocation:!0},y.prototype={get target(){return X.get(this)},get currentTarget(){return Y.get(this)},get eventPhase(){return J.get(this)},get path(){var e=ne.get(this);return e?e.slice():[]},stopPropagation:function(){Q.set(this,!0)},stopImmediatePropagation:function(){Q.set(this,!0),ee.set(this,!0)}},F(se,y,document.createEvent("Event"));var ce=_("UIEvent",y),le=_("CustomEvent",y),ue={get relatedTarget(){var e=Z.get(this);return void 0!==e?e:V(B(this).relatedTarget)}},de=W({initMouseEvent:S("initMouseEvent",14)},ue),pe=W({initFocusEvent:S("initFocusEvent",5)},ue),he=_("MouseEvent",ce,de),fe=_("FocusEvent",ce,pe),me=Object.create(null),we=function(){try{new window.FocusEvent("focus")}catch(e){return!1}return!0}();if(!we){var ve=function(e,t,n){if(n){var r=me[n];t=W(W({},r),t)}me[e]=t};ve("Event",{bubbles:!1,cancelable:!1}),ve("CustomEvent",{detail:null},"Event"),ve("UIEvent",{view:null,detail:0},"Event"),ve("MouseEvent",{screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:null},"UIEvent"),ve("FocusEvent",{relatedTarget:null},"UIEvent")}var ge=window.BeforeUnloadEvent;M.prototype=Object.create(y.prototype),W(M.prototype,{get returnValue(){return q(this).returnValue},set returnValue(e){q(this).returnValue=e}}),ge&&F(ge,M);var be=window.EventTarget,ye=["addEventListener","removeEventListener","dispatchEvent"];[Node,Window].forEach(function(e){var t=e.prototype;ye.forEach(function(e){Object.defineProperty(t,e+"_",{value:t[e]})})}),N.prototype={addEventListener:function(e,t,n){if(O(t)&&!L(e)){var r=new b(e,t,n),o=z.get(this);if(o){for(var i=0;i<o.length;i++)if(r.equals(o[i]))return}else o=[],o.depth=0,z.set(this,o);o.push(r);var a=C(this);a.addEventListener_(e,p,!0)}},removeEventListener:function(e,t,n){n=Boolean(n);var r=z.get(this);if(r){for(var o=0,i=!1,a=0;a<r.length;a++)r[a].type===e&&r[a].capture===n&&(o++,r[a].handler===t&&(i=!0,r[a].remove()));if(i&&1===o){var s=C(this);s.removeEventListener_(e,p,!0)}}},dispatchEvent:function(t){var n=B(t),r=n.type;K.set(n,!1),e.renderAllPending();var o;D(this,r)||(o=function(){},this.addEventListener(r,o,!0));try{return B(this).dispatchEvent_(n)}finally{o&&this.removeEventListener(r,o,!0)}}},be&&F(be,N);var Ee=document.elementFromPoint;e.elementFromPoint=x,e.getEventHandlerGetter=R,e.getEventHandlerSetter=I,e.wrapEventTargetMethods=H,e.wrappers.BeforeUnloadEvent=M,e.wrappers.CustomEvent=le,e.wrappers.Event=y,e.wrappers.EventTarget=N,e.wrappers.FocusEvent=fe,e.wrappers.MouseEvent=he,e.wrappers.UIEvent=ce}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e,t){Object.defineProperty(e,t,m)}function n(e){l(e,this)}function r(){this.length=0,t(this,"length")}function o(e){for(var t=new r,o=0;o<e.length;o++)t[o]=new n(e[o]);return t.length=o,t}function i(e){a.call(this,e)}var a=e.wrappers.UIEvent,s=e.mixin,c=e.registerWrapper,l=e.setWrapper,u=e.unsafeUnwrap,d=e.wrap,p=window.TouchEvent;if(p){var h;try{h=document.createEvent("TouchEvent")}catch(f){return}var m={enumerable:!1};n.prototype={get target(){return d(u(this).target)}};var w={configurable:!0,enumerable:!0,get:null};["clientX","clientY","screenX","screenY","pageX","pageY","identifier","webkitRadiusX","webkitRadiusY","webkitRotationAngle","webkitForce"].forEach(function(e){w.get=function(){return u(this)[e]},Object.defineProperty(n.prototype,e,w)}),r.prototype={item:function(e){return this[e]}},i.prototype=Object.create(a.prototype),s(i.prototype,{get touches(){return o(u(this).touches)},get targetTouches(){return o(u(this).targetTouches)},get changedTouches(){return o(u(this).changedTouches)},initTouchEvent:function(){throw new Error("Not implemented")}}),c(p,i,h),e.wrappers.Touch=n,e.wrappers.TouchEvent=i,e.wrappers.TouchList=r}}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e,t){Object.defineProperty(e,t,s)}function n(){this.length=0,t(this,"length")}function r(e){if(null==e)return e;for(var t=new n,r=0,o=e.length;o>r;r++)t[r]=a(e[r]);return t.length=o,t}function o(e,t){e.prototype[t]=function(){return r(i(this)[t].apply(i(this),arguments))}}var i=e.unsafeUnwrap,a=e.wrap,s={enumerable:!1};n.prototype={item:function(e){return this[e]}},t(n.prototype,"item"),e.wrappers.NodeList=n,e.addWrapNodeListMethod=o,e.wrapNodeList=r}(window.ShadowDOMPolyfill),function(e){"use strict";e.wrapHTMLCollection=e.wrapNodeList,e.wrappers.HTMLCollection=e.wrappers.NodeList}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){O(e instanceof _)}function n(e){var t=new T;return t[0]=e,t.length=1,t}function r(e,t,n){N(t,"childList",{removedNodes:n,previousSibling:e.previousSibling,nextSibling:e.nextSibling})}function o(e,t){N(e,"childList",{removedNodes:t})}function i(e,t,r,o){if(e instanceof DocumentFragment){var i=s(e);U=!0;for(var a=i.length-1;a>=0;a--)e.removeChild(i[a]),i[a].parentNode_=t;U=!1;for(var a=0;a<i.length;a++)i[a].previousSibling_=i[a-1]||r,i[a].nextSibling_=i[a+1]||o;return r&&(r.nextSibling_=i[0]),o&&(o.previousSibling_=i[i.length-1]),i}var i=n(e),c=e.parentNode;return c&&c.removeChild(e),e.parentNode_=t,e.previousSibling_=r,e.nextSibling_=o,r&&(r.nextSibling_=e),o&&(o.previousSibling_=e),i}function a(e){if(e instanceof DocumentFragment)return s(e);var t=n(e),o=e.parentNode;return o&&r(e,o,t),t}function s(e){for(var t=new T,n=0,r=e.firstChild;r;r=r.nextSibling)t[n++]=r;return t.length=n,o(e,t),t}function c(e){return e}function l(e,t){R(e,t),e.nodeIsInserted_()}function u(e,t){for(var n=C(t),r=0;r<e.length;r++)l(e[r],n)}function d(e){R(e,new M(e,null))}function p(e){for(var t=0;t<e.length;t++)d(e[t])}function h(e,t){var n=e.nodeType===_.DOCUMENT_NODE?e:e.ownerDocument;n!==t.ownerDocument&&n.adoptNode(t)}function f(t,n){if(n.length){var r=t.ownerDocument;if(r!==n[0].ownerDocument)for(var o=0;o<n.length;o++)e.adoptNodeNoRemove(n[o],r)}}function m(e,t){f(e,t);var n=t.length;if(1===n)return P(t[0]);for(var r=P(e.ownerDocument.createDocumentFragment()),o=0;n>o;o++)r.appendChild(P(t[o]));return r}function w(e){if(void 0!==e.firstChild_)for(var t=e.firstChild_;t;){var n=t;t=t.nextSibling_,n.parentNode_=n.previousSibling_=n.nextSibling_=void 0}e.firstChild_=e.lastChild_=void 0}function v(e){if(e.invalidateShadowRenderer()){for(var t=e.firstChild;t;){O(t.parentNode===e);var n=t.nextSibling,r=P(t),o=r.parentNode;o&&X.call(o,r),t.previousSibling_=t.nextSibling_=t.parentNode_=null,t=n}e.firstChild_=e.lastChild_=null}else for(var n,i=P(e),a=i.firstChild;a;)n=a.nextSibling,X.call(i,a),a=n}function g(e){var t=e.parentNode;return t&&t.invalidateShadowRenderer()}function b(e){for(var t,n=0;n<e.length;n++)t=e[n],t.parentNode.removeChild(t)}function y(e,t,n){var r;if(r=A(n?q.call(n,I(e),!1):B.call(I(e),!1)),t){for(var o=e.firstChild;o;o=o.nextSibling)r.appendChild(y(o,!0,n));if(e instanceof F.HTMLTemplateElement)for(var i=r.content,o=e.content.firstChild;o;o=o.nextSibling)i.appendChild(y(o,!0,n))}return r}function E(e,t){if(!t||C(e)!==C(t))return!1;for(var n=t;n;n=n.parentNode)if(n===e)return!0;return!1}function _(e){O(e instanceof V),S.call(this,e),this.parentNode_=void 0,this.firstChild_=void 0,this.lastChild_=void 0,this.nextSibling_=void 0,this.previousSibling_=void 0,this.treeScope_=void 0}var S=e.wrappers.EventTarget,T=e.wrappers.NodeList,M=e.TreeScope,O=e.assert,L=e.defineWrapGetter,N=e.enqueueMutation,C=e.getTreeScope,j=e.isWrapper,D=e.mixin,H=e.registerTransientObservers,x=e.registerWrapper,R=e.setTreeScope,I=e.unsafeUnwrap,P=e.unwrap,k=e.unwrapIfNeeded,A=e.wrap,W=e.wrapIfNeeded,F=e.wrappers,U=!1,q=document.importNode,B=window.Node.prototype.cloneNode,V=window.Node,G=window.DocumentFragment,z=(V.prototype.appendChild,V.prototype.compareDocumentPosition),K=V.prototype.isEqualNode,$=V.prototype.insertBefore,X=V.prototype.removeChild,Y=V.prototype.replaceChild,Z=/Trident|Edge/.test(navigator.userAgent),J=Z?function(e,t){try{X.call(e,t)}catch(n){if(!(e instanceof G))throw n}}:function(e,t){X.call(e,t)};_.prototype=Object.create(S.prototype),D(_.prototype,{appendChild:function(e){return this.insertBefore(e,null)},insertBefore:function(e,n){t(e);var r;n?j(n)?r=P(n):(r=n,n=A(r)):(n=null,r=null),n&&O(n.parentNode===this);var o,s=n?n.previousSibling:this.lastChild,c=!this.invalidateShadowRenderer()&&!g(e);if(o=c?a(e):i(e,this,s,n),c)h(this,e),w(this),$.call(I(this),P(e),r);else{s||(this.firstChild_=o[0]),n||(this.lastChild_=o[o.length-1],void 0===this.firstChild_&&(this.firstChild_=this.firstChild));var l=r?r.parentNode:I(this);l?$.call(l,m(this,o),r):f(this,o)}return N(this,"childList",{addedNodes:o,nextSibling:n,previousSibling:s}),u(o,this),e},removeChild:function(e){if(t(e),e.parentNode!==this){for(var r=!1,o=(this.childNodes,this.firstChild);o;o=o.nextSibling)if(o===e){r=!0;break}if(!r)throw new Error("NotFoundError")}var i=P(e),a=e.nextSibling,s=e.previousSibling;if(this.invalidateShadowRenderer()){var c=this.firstChild,l=this.lastChild,u=i.parentNode;u&&J(u,i),c===e&&(this.firstChild_=a),l===e&&(this.lastChild_=s),s&&(s.nextSibling_=a),a&&(a.previousSibling_=s),e.previousSibling_=e.nextSibling_=e.parentNode_=void 0}else w(this),J(I(this),i);return U||N(this,"childList",{removedNodes:n(e),nextSibling:a,previousSibling:s}),H(this,e),e},replaceChild:function(e,r){t(e);var o;if(j(r)?o=P(r):(o=r,r=A(o)),r.parentNode!==this)throw new Error("NotFoundError");var s,c=r.nextSibling,l=r.previousSibling,p=!this.invalidateShadowRenderer()&&!g(e);return p?s=a(e):(c===e&&(c=e.nextSibling),s=i(e,this,l,c)),p?(h(this,e),w(this),Y.call(I(this),P(e),o)):(this.firstChild===r&&(this.firstChild_=s[0]),this.lastChild===r&&(this.lastChild_=s[s.length-1]),r.previousSibling_=r.nextSibling_=r.parentNode_=void 0,o.parentNode&&Y.call(o.parentNode,m(this,s),o)),N(this,"childList",{addedNodes:s,removedNodes:n(r),nextSibling:c,previousSibling:l}),d(r),u(s,this),r},nodeIsInserted_:function(){for(var e=this.firstChild;e;e=e.nextSibling)e.nodeIsInserted_()},hasChildNodes:function(){return null!==this.firstChild},get parentNode(){return void 0!==this.parentNode_?this.parentNode_:A(I(this).parentNode)},get firstChild(){return void 0!==this.firstChild_?this.firstChild_:A(I(this).firstChild)},get lastChild(){return void 0!==this.lastChild_?this.lastChild_:A(I(this).lastChild)},get nextSibling(){return void 0!==this.nextSibling_?this.nextSibling_:A(I(this).nextSibling)},get previousSibling(){return void 0!==this.previousSibling_?this.previousSibling_:A(I(this).previousSibling)},get parentElement(){for(var e=this.parentNode;e&&e.nodeType!==_.ELEMENT_NODE;)e=e.parentNode;return e},get textContent(){for(var e="",t=this.firstChild;t;t=t.nextSibling)t.nodeType!=_.COMMENT_NODE&&(e+=t.textContent);return e},set textContent(e){null==e&&(e="");var t=c(this.childNodes);if(this.invalidateShadowRenderer()){if(v(this),""!==e){var n=I(this).ownerDocument.createTextNode(e);this.appendChild(n)}}else w(this),I(this).textContent=e;var r=c(this.childNodes);N(this,"childList",{addedNodes:r,removedNodes:t}),p(t),u(r,this)},get childNodes(){for(var e=new T,t=0,n=this.firstChild;n;n=n.nextSibling)e[t++]=n;return e.length=t,e},cloneNode:function(e){return y(this,e)},contains:function(e){return E(this,W(e))},compareDocumentPosition:function(e){return z.call(I(this),k(e))},isEqualNode:function(e){return K.call(I(this),k(e))},normalize:function(){for(var e,t,n=c(this.childNodes),r=[],o="",i=0;i<n.length;i++)t=n[i],t.nodeType===_.TEXT_NODE?e||t.data.length?e?(o+=t.data,r.push(t)):e=t:this.removeChild(t):(e&&r.length&&(e.data+=o,b(r)),r=[],o="",e=null,t.childNodes.length&&t.normalize());e&&r.length&&(e.data+=o,b(r))}}),L(_,"ownerDocument"),x(V,_,document.createDocumentFragment()),delete _.prototype.querySelector,delete _.prototype.querySelectorAll,_.prototype=D(Object.create(S.prototype),_.prototype),e.cloneNode=y,e.nodeWasAdded=l,e.nodeWasRemoved=d,e.nodesWereAdded=u,e.nodesWereRemoved=p,e.originalInsertBefore=$,e.originalRemoveChild=X,e.snapshotNodeList=c,e.wrappers.Node=_}(window.ShadowDOMPolyfill),function(e){"use strict";function t(t,n,r,o){for(var i=null,a=null,s=0,c=t.length;c>s;s++)i=b(t[s]),!o&&(a=v(i).root)&&a instanceof e.wrappers.ShadowRoot||(r[n++]=i);return n}function n(e){return String(e).replace(/\/deep\/|::shadow|>>>/g," ")}function r(e){return String(e).replace(/:host\(([^\s]+)\)/g,"$1").replace(/([^\s]):host/g,"$1").replace(":host","*").replace(/\^|\/shadow\/|\/shadow-deep\/|::shadow|\/deep\/|::content|>>>/g," ")}function o(e,t){for(var n,r=e.firstElementChild;r;){if(r.matches(t))return r;if(n=o(r,t))return n;r=r.nextElementSibling}return null}function i(e,t){return e.matches(t)}function a(e,t,n){var r=e.localName;return r===t||r===n&&e.namespaceURI===j}function s(){return!0}function c(e,t,n){return e.localName===n}function l(e,t){return e.namespaceURI===t}function u(e,t,n){return e.namespaceURI===t&&e.localName===n}function d(e,t,n,r,o,i){for(var a=e.firstElementChild;a;)r(a,o,i)&&(n[t++]=a),t=d(a,t,n,r,o,i),a=a.nextElementSibling;return t}function p(n,r,o,i,a){var s,c=g(this),l=v(this).root;if(l instanceof e.wrappers.ShadowRoot)return d(this,r,o,n,i,null);if(c instanceof N)s=S.call(c,i);else{if(!(c instanceof C))return d(this,r,o,n,i,null);s=_.call(c,i)}return t(s,r,o,a)}function h(n,r,o,i,a){var s,c=g(this),l=v(this).root;if(l instanceof e.wrappers.ShadowRoot)return d(this,r,o,n,i,a);if(c instanceof N)s=M.call(c,i,a);else{if(!(c instanceof C))return d(this,r,o,n,i,a);s=T.call(c,i,a)}return t(s,r,o,!1)}function f(n,r,o,i,a){var s,c=g(this),l=v(this).root;if(l instanceof e.wrappers.ShadowRoot)return d(this,r,o,n,i,a);if(c instanceof N)s=L.call(c,i,a);else{if(!(c instanceof C))return d(this,r,o,n,i,a);s=O.call(c,i,a)}return t(s,r,o,!1)}var m=e.wrappers.HTMLCollection,w=e.wrappers.NodeList,v=e.getTreeScope,g=e.unsafeUnwrap,b=e.wrap,y=document.querySelector,E=document.documentElement.querySelector,_=document.querySelectorAll,S=document.documentElement.querySelectorAll,T=document.getElementsByTagName,M=document.documentElement.getElementsByTagName,O=document.getElementsByTagNameNS,L=document.documentElement.getElementsByTagNameNS,N=window.Element,C=window.HTMLDocument||window.Document,j="http://www.w3.org/1999/xhtml",D={querySelector:function(t){var r=n(t),i=r!==t;t=r;var a,s=g(this),c=v(this).root;if(c instanceof e.wrappers.ShadowRoot)return o(this,t);if(s instanceof N)a=b(E.call(s,t));else{
if(!(s instanceof C))return o(this,t);a=b(y.call(s,t))}return a&&!i&&(c=v(a).root)&&c instanceof e.wrappers.ShadowRoot?o(this,t):a},querySelectorAll:function(e){var t=n(e),r=t!==e;e=t;var o=new w;return o.length=p.call(this,i,0,o,e,r),o}},H={matches:function(t){return t=r(t),e.originalMatches.call(g(this),t)}},x={getElementsByTagName:function(e){var t=new m,n="*"===e?s:a;return t.length=h.call(this,n,0,t,e,e.toLowerCase()),t},getElementsByClassName:function(e){return this.querySelectorAll("."+e)},getElementsByTagNameNS:function(e,t){var n=new m,r=null;return r="*"===e?"*"===t?s:c:"*"===t?l:u,n.length=f.call(this,r,0,n,e||null,t),n}};e.GetElementsByInterface=x,e.SelectorsInterface=D,e.MatchesInterface=H}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){for(;e&&e.nodeType!==Node.ELEMENT_NODE;)e=e.nextSibling;return e}function n(e){for(;e&&e.nodeType!==Node.ELEMENT_NODE;)e=e.previousSibling;return e}var r=e.wrappers.NodeList,o={get firstElementChild(){return t(this.firstChild)},get lastElementChild(){return n(this.lastChild)},get childElementCount(){for(var e=0,t=this.firstElementChild;t;t=t.nextElementSibling)e++;return e},get children(){for(var e=new r,t=0,n=this.firstElementChild;n;n=n.nextElementSibling)e[t++]=n;return e.length=t,e},remove:function(){var e=this.parentNode;e&&e.removeChild(this)}},i={get nextElementSibling(){return t(this.nextSibling)},get previousElementSibling(){return n(this.previousSibling)}},a={getElementById:function(e){return/[ \t\n\r\f]/.test(e)?null:this.querySelector('[id="'+e+'"]')}};e.ChildNodeInterface=i,e.NonElementParentNodeInterface=a,e.ParentNodeInterface=o}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){r.call(this,e)}var n=e.ChildNodeInterface,r=e.wrappers.Node,o=e.enqueueMutation,i=e.mixin,a=e.registerWrapper,s=e.unsafeUnwrap,c=window.CharacterData;t.prototype=Object.create(r.prototype),i(t.prototype,{get nodeValue(){return this.data},set nodeValue(e){this.data=e},get textContent(){return this.data},set textContent(e){this.data=e},get data(){return s(this).data},set data(e){var t=s(this).data;o(this,"characterData",{oldValue:t}),s(this).data=e}}),i(t.prototype,n),a(c,t,document.createTextNode("")),e.wrappers.CharacterData=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){return e>>>0}function n(e){r.call(this,e)}var r=e.wrappers.CharacterData,o=(e.enqueueMutation,e.mixin),i=e.registerWrapper,a=window.Text;n.prototype=Object.create(r.prototype),o(n.prototype,{splitText:function(e){e=t(e);var n=this.data;if(e>n.length)throw new Error("IndexSizeError");var r=n.slice(0,e),o=n.slice(e);this.data=r;var i=this.ownerDocument.createTextNode(o);return this.parentNode&&this.parentNode.insertBefore(i,this.nextSibling),i}}),i(a,n,document.createTextNode("")),e.wrappers.Text=n}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){return i(e).getAttribute("class")}function n(e,t){a(e,"attributes",{name:"class",namespace:null,oldValue:t})}function r(t){e.invalidateRendererBasedOnAttribute(t,"class")}function o(e,o,i){var a=e.ownerElement_;if(null==a)return o.apply(e,i);var s=t(a),c=o.apply(e,i);return t(a)!==s&&(n(a,s),r(a)),c}if(!window.DOMTokenList)return void console.warn("Missing DOMTokenList prototype, please include a compatible classList polyfill such as http://goo.gl/uTcepH.");var i=e.unsafeUnwrap,a=e.enqueueMutation,s=DOMTokenList.prototype.add;DOMTokenList.prototype.add=function(){o(this,s,arguments)};var c=DOMTokenList.prototype.remove;DOMTokenList.prototype.remove=function(){o(this,c,arguments)};var l=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(){return o(this,l,arguments)}}(window.ShadowDOMPolyfill),function(e){"use strict";function t(t,n){var r=t.parentNode;if(r&&r.shadowRoot){var o=e.getRendererForHost(r);o.dependsOnAttribute(n)&&o.invalidate()}}function n(e,t,n){u(e,"attributes",{name:t,namespace:null,oldValue:n})}function r(e){a.call(this,e)}var o=e.ChildNodeInterface,i=e.GetElementsByInterface,a=e.wrappers.Node,s=e.ParentNodeInterface,c=e.SelectorsInterface,l=e.MatchesInterface,u=(e.addWrapNodeListMethod,e.enqueueMutation),d=e.mixin,p=(e.oneOf,e.registerWrapper),h=e.unsafeUnwrap,f=e.wrappers,m=window.Element,w=["matches","mozMatchesSelector","msMatchesSelector","webkitMatchesSelector"].filter(function(e){return m.prototype[e]}),v=w[0],g=m.prototype[v],b=new WeakMap;r.prototype=Object.create(a.prototype),d(r.prototype,{createShadowRoot:function(){var t=new f.ShadowRoot(this);h(this).polymerShadowRoot_=t;var n=e.getRendererForHost(this);return n.invalidate(),t},get shadowRoot(){return h(this).polymerShadowRoot_||null},setAttribute:function(e,r){var o=h(this).getAttribute(e);h(this).setAttribute(e,r),n(this,e,o),t(this,e)},removeAttribute:function(e){var r=h(this).getAttribute(e);h(this).removeAttribute(e),n(this,e,r),t(this,e)},get classList(){var e=b.get(this);if(!e){if(e=h(this).classList,!e)return;e.ownerElement_=this,b.set(this,e)}return e},get className(){return h(this).className},set className(e){this.setAttribute("class",e)},get id(){return h(this).id},set id(e){this.setAttribute("id",e)}}),w.forEach(function(e){"matches"!==e&&(r.prototype[e]=function(e){return this.matches(e)})}),m.prototype.webkitCreateShadowRoot&&(r.prototype.webkitCreateShadowRoot=r.prototype.createShadowRoot),d(r.prototype,o),d(r.prototype,i),d(r.prototype,s),d(r.prototype,c),d(r.prototype,l),p(m,r,document.createElementNS(null,"x")),e.invalidateRendererBasedOnAttribute=t,e.matchesNames=w,e.originalMatches=g,e.wrappers.Element=r}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){switch(e){case"&":return"&amp;";case"<":return"&lt;";case">":return"&gt;";case'"':return"&quot;";case" ":return"&nbsp;"}}function n(e){return e.replace(L,t)}function r(e){return e.replace(N,t)}function o(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;return t}function i(e){if(e.namespaceURI!==D)return!0;var t=e.ownerDocument.doctype;return t&&t.publicId&&t.systemId}function a(e,t){switch(e.nodeType){case Node.ELEMENT_NODE:for(var o,a=e.tagName.toLowerCase(),c="<"+a,l=e.attributes,u=0;o=l[u];u++)c+=" "+o.name+'="'+n(o.value)+'"';return C[a]?(i(e)&&(c+="/"),c+">"):c+">"+s(e)+"</"+a+">";case Node.TEXT_NODE:var d=e.data;return t&&j[t.localName]?d:r(d);case Node.COMMENT_NODE:return"<!--"+e.data+"-->";default:throw console.error(e),new Error("not implemented")}}function s(e){e instanceof O.HTMLTemplateElement&&(e=e.content);for(var t="",n=e.firstChild;n;n=n.nextSibling)t+=a(n,e);return t}function c(e,t,n){var r=n||"div";e.textContent="";var o=T(e.ownerDocument.createElement(r));o.innerHTML=t;for(var i;i=o.firstChild;)e.appendChild(M(i))}function l(e){m.call(this,e)}function u(e,t){var n=T(e.cloneNode(!1));n.innerHTML=t;for(var r,o=T(document.createDocumentFragment());r=n.firstChild;)o.appendChild(r);return M(o)}function d(t){return function(){return e.renderAllPending(),S(this)[t]}}function p(e){w(l,e,d(e))}function h(t){Object.defineProperty(l.prototype,t,{get:d(t),set:function(n){e.renderAllPending(),S(this)[t]=n},configurable:!0,enumerable:!0})}function f(t){Object.defineProperty(l.prototype,t,{value:function(){return e.renderAllPending(),S(this)[t].apply(S(this),arguments)},configurable:!0,enumerable:!0})}var m=e.wrappers.Element,w=e.defineGetter,v=e.enqueueMutation,g=e.mixin,b=e.nodesWereAdded,y=e.nodesWereRemoved,E=e.registerWrapper,_=e.snapshotNodeList,S=e.unsafeUnwrap,T=e.unwrap,M=e.wrap,O=e.wrappers,L=/[&\u00A0"]/g,N=/[&\u00A0<>]/g,C=o(["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"]),j=o(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]),D="http://www.w3.org/1999/xhtml",H=/MSIE/.test(navigator.userAgent),x=window.HTMLElement,R=window.HTMLTemplateElement;l.prototype=Object.create(m.prototype),g(l.prototype,{get innerHTML(){return s(this)},set innerHTML(e){if(H&&j[this.localName])return void(this.textContent=e);var t=_(this.childNodes);this.invalidateShadowRenderer()?this instanceof O.HTMLTemplateElement?c(this.content,e):c(this,e,this.tagName):!R&&this instanceof O.HTMLTemplateElement?c(this.content,e):S(this).innerHTML=e;var n=_(this.childNodes);v(this,"childList",{addedNodes:n,removedNodes:t}),y(t),b(n,this)},get outerHTML(){return a(this,this.parentNode)},set outerHTML(e){var t=this.parentNode;if(t){t.invalidateShadowRenderer();var n=u(t,e);t.replaceChild(n,this)}},insertAdjacentHTML:function(e,t){var n,r;switch(String(e).toLowerCase()){case"beforebegin":n=this.parentNode,r=this;break;case"afterend":n=this.parentNode,r=this.nextSibling;break;case"afterbegin":n=this,r=this.firstChild;break;case"beforeend":n=this,r=null;break;default:return}var o=u(n,t);n.insertBefore(o,r)},get hidden(){return this.hasAttribute("hidden")},set hidden(e){e?this.setAttribute("hidden",""):this.removeAttribute("hidden")}}),["clientHeight","clientLeft","clientTop","clientWidth","offsetHeight","offsetLeft","offsetTop","offsetWidth","scrollHeight","scrollWidth"].forEach(p),["scrollLeft","scrollTop"].forEach(h),["getBoundingClientRect","getClientRects","scrollIntoView"].forEach(f),E(x,l,document.createElement("b")),e.wrappers.HTMLElement=l,e.getInnerHTML=s,e.setInnerHTML=c}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){n.call(this,e)}var n=e.wrappers.HTMLElement,r=e.mixin,o=e.registerWrapper,i=e.unsafeUnwrap,a=e.wrap,s=window.HTMLCanvasElement;t.prototype=Object.create(n.prototype),r(t.prototype,{getContext:function(){var e=i(this).getContext.apply(i(this),arguments);return e&&a(e)}}),o(s,t,document.createElement("canvas")),e.wrappers.HTMLCanvasElement=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){n.call(this,e)}var n=e.wrappers.HTMLElement,r=e.mixin,o=e.registerWrapper,i=window.HTMLContentElement;t.prototype=Object.create(n.prototype),r(t.prototype,{constructor:t,get select(){return this.getAttribute("select")},set select(e){this.setAttribute("select",e)},setAttribute:function(e,t){n.prototype.setAttribute.call(this,e,t),"select"===String(e).toLowerCase()&&this.invalidateShadowRenderer(!0)}}),i&&o(i,t),e.wrappers.HTMLContentElement=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){n.call(this,e)}var n=e.wrappers.HTMLElement,r=e.mixin,o=e.registerWrapper,i=e.wrapHTMLCollection,a=e.unwrap,s=window.HTMLFormElement;t.prototype=Object.create(n.prototype),r(t.prototype,{get elements(){return i(a(this).elements)}}),o(s,t,document.createElement("form")),e.wrappers.HTMLFormElement=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){r.call(this,e)}function n(e,t){if(!(this instanceof n))throw new TypeError("DOM object constructor cannot be called as a function.");var o=i(document.createElement("img"));r.call(this,o),a(o,this),void 0!==e&&(o.width=e),void 0!==t&&(o.height=t)}var r=e.wrappers.HTMLElement,o=e.registerWrapper,i=e.unwrap,a=e.rewrap,s=window.HTMLImageElement;t.prototype=Object.create(r.prototype),o(s,t,document.createElement("img")),n.prototype=t.prototype,e.wrappers.HTMLImageElement=t,e.wrappers.Image=n}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){n.call(this,e)}var n=e.wrappers.HTMLElement,r=(e.mixin,e.wrappers.NodeList,e.registerWrapper),o=window.HTMLShadowElement;t.prototype=Object.create(n.prototype),t.prototype.constructor=t,o&&r(o,t),e.wrappers.HTMLShadowElement=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){if(!e.defaultView)return e;var t=d.get(e);if(!t){for(t=e.implementation.createHTMLDocument("");t.lastChild;)t.removeChild(t.lastChild);d.set(e,t)}return t}function n(e){for(var n,r=t(e.ownerDocument),o=c(r.createDocumentFragment());n=e.firstChild;)o.appendChild(n);return o}function r(e){if(o.call(this,e),!p){var t=n(e);u.set(this,l(t))}}var o=e.wrappers.HTMLElement,i=e.mixin,a=e.registerWrapper,s=e.unsafeUnwrap,c=e.unwrap,l=e.wrap,u=new WeakMap,d=new WeakMap,p=window.HTMLTemplateElement;r.prototype=Object.create(o.prototype),i(r.prototype,{constructor:r,get content(){return p?l(s(this).content):u.get(this)}}),p&&a(p,r),e.wrappers.HTMLTemplateElement=r}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){n.call(this,e)}var n=e.wrappers.HTMLElement,r=e.registerWrapper,o=window.HTMLMediaElement;o&&(t.prototype=Object.create(n.prototype),r(o,t,document.createElement("audio")),e.wrappers.HTMLMediaElement=t)}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){r.call(this,e)}function n(e){if(!(this instanceof n))throw new TypeError("DOM object constructor cannot be called as a function.");var t=i(document.createElement("audio"));r.call(this,t),a(t,this),t.setAttribute("preload","auto"),void 0!==e&&t.setAttribute("src",e)}var r=e.wrappers.HTMLMediaElement,o=e.registerWrapper,i=e.unwrap,a=e.rewrap,s=window.HTMLAudioElement;s&&(t.prototype=Object.create(r.prototype),o(s,t,document.createElement("audio")),n.prototype=t.prototype,e.wrappers.HTMLAudioElement=t,e.wrappers.Audio=n)}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){return e.replace(/\s+/g," ").trim()}function n(e){o.call(this,e)}function r(e,t,n,i){if(!(this instanceof r))throw new TypeError("DOM object constructor cannot be called as a function.");var a=c(document.createElement("option"));o.call(this,a),s(a,this),void 0!==e&&(a.text=e),void 0!==t&&a.setAttribute("value",t),n===!0&&a.setAttribute("selected",""),a.selected=i===!0}var o=e.wrappers.HTMLElement,i=e.mixin,a=e.registerWrapper,s=e.rewrap,c=e.unwrap,l=e.wrap,u=window.HTMLOptionElement;n.prototype=Object.create(o.prototype),i(n.prototype,{get text(){return t(this.textContent)},set text(e){this.textContent=t(String(e))},get form(){return l(c(this).form)}}),a(u,n,document.createElement("option")),r.prototype=n.prototype,e.wrappers.HTMLOptionElement=n,e.wrappers.Option=r}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){n.call(this,e)}var n=e.wrappers.HTMLElement,r=e.mixin,o=e.registerWrapper,i=e.unwrap,a=e.wrap,s=window.HTMLSelectElement;t.prototype=Object.create(n.prototype),r(t.prototype,{add:function(e,t){"object"==typeof t&&(t=i(t)),i(this).add(i(e),t)},remove:function(e){return void 0===e?void n.prototype.remove.call(this):("object"==typeof e&&(e=i(e)),void i(this).remove(e))},get form(){return a(i(this).form)}}),o(s,t,document.createElement("select")),e.wrappers.HTMLSelectElement=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){n.call(this,e)}var n=e.wrappers.HTMLElement,r=e.mixin,o=e.registerWrapper,i=e.unwrap,a=e.wrap,s=e.wrapHTMLCollection,c=window.HTMLTableElement;t.prototype=Object.create(n.prototype),r(t.prototype,{get caption(){return a(i(this).caption)},createCaption:function(){return a(i(this).createCaption())},get tHead(){return a(i(this).tHead)},createTHead:function(){return a(i(this).createTHead())},createTFoot:function(){return a(i(this).createTFoot())},get tFoot(){return a(i(this).tFoot)},get tBodies(){return s(i(this).tBodies)},createTBody:function(){return a(i(this).createTBody())},get rows(){return s(i(this).rows)},insertRow:function(e){return a(i(this).insertRow(e))}}),o(c,t,document.createElement("table")),e.wrappers.HTMLTableElement=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){n.call(this,e)}var n=e.wrappers.HTMLElement,r=e.mixin,o=e.registerWrapper,i=e.wrapHTMLCollection,a=e.unwrap,s=e.wrap,c=window.HTMLTableSectionElement;t.prototype=Object.create(n.prototype),r(t.prototype,{constructor:t,get rows(){return i(a(this).rows)},insertRow:function(e){return s(a(this).insertRow(e))}}),o(c,t,document.createElement("thead")),e.wrappers.HTMLTableSectionElement=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){n.call(this,e)}var n=e.wrappers.HTMLElement,r=e.mixin,o=e.registerWrapper,i=e.wrapHTMLCollection,a=e.unwrap,s=e.wrap,c=window.HTMLTableRowElement;t.prototype=Object.create(n.prototype),r(t.prototype,{get cells(){return i(a(this).cells)},insertCell:function(e){return s(a(this).insertCell(e))}}),o(c,t,document.createElement("tr")),e.wrappers.HTMLTableRowElement=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){switch(e.localName){case"content":return new n(e);case"shadow":return new o(e);case"template":return new i(e)}r.call(this,e)}var n=e.wrappers.HTMLContentElement,r=e.wrappers.HTMLElement,o=e.wrappers.HTMLShadowElement,i=e.wrappers.HTMLTemplateElement,a=(e.mixin,e.registerWrapper),s=window.HTMLUnknownElement;t.prototype=Object.create(r.prototype),a(s,t),e.wrappers.HTMLUnknownElement=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){n.call(this,e)}var n=e.wrappers.Element,r=e.wrappers.HTMLElement,o=e.registerWrapper,i=(e.defineWrapGetter,e.unsafeUnwrap),a=e.wrap,s=e.mixin,c="http://www.w3.org/2000/svg",l=window.SVGElement,u=document.createElementNS(c,"title");if(!("classList"in u)){var d=Object.getOwnPropertyDescriptor(n.prototype,"classList");Object.defineProperty(r.prototype,"classList",d),delete n.prototype.classList}t.prototype=Object.create(n.prototype),s(t.prototype,{get ownerSVGElement(){return a(i(this).ownerSVGElement)}}),o(l,t,document.createElementNS(c,"title")),e.wrappers.SVGElement=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){p.call(this,e)}var n=e.mixin,r=e.registerWrapper,o=e.unwrap,i=e.wrap,a=window.SVGUseElement,s="http://www.w3.org/2000/svg",c=i(document.createElementNS(s,"g")),l=document.createElementNS(s,"use"),u=c.constructor,d=Object.getPrototypeOf(u.prototype),p=d.constructor;t.prototype=Object.create(d),"instanceRoot"in l&&n(t.prototype,{get instanceRoot(){return i(o(this).instanceRoot)},get animatedInstanceRoot(){return i(o(this).animatedInstanceRoot)}}),r(a,t,l),e.wrappers.SVGUseElement=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){n.call(this,e)}var n=e.wrappers.EventTarget,r=e.mixin,o=e.registerWrapper,i=e.unsafeUnwrap,a=e.wrap,s=window.SVGElementInstance;s&&(t.prototype=Object.create(n.prototype),r(t.prototype,{get correspondingElement(){return a(i(this).correspondingElement)},get correspondingUseElement(){return a(i(this).correspondingUseElement)},get parentNode(){return a(i(this).parentNode)},get childNodes(){throw new Error("Not implemented")},get firstChild(){return a(i(this).firstChild)},get lastChild(){return a(i(this).lastChild)},get previousSibling(){return a(i(this).previousSibling)},get nextSibling(){return a(i(this).nextSibling)}}),o(s,t),e.wrappers.SVGElementInstance=t)}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){o(e,this)}var n=e.mixin,r=e.registerWrapper,o=e.setWrapper,i=e.unsafeUnwrap,a=e.unwrap,s=e.unwrapIfNeeded,c=e.wrap,l=window.CanvasRenderingContext2D;n(t.prototype,{get canvas(){return c(i(this).canvas)},drawImage:function(){arguments[0]=s(arguments[0]),i(this).drawImage.apply(i(this),arguments)},createPattern:function(){return arguments[0]=a(arguments[0]),i(this).createPattern.apply(i(this),arguments)}}),r(l,t,document.createElement("canvas").getContext("2d")),e.wrappers.CanvasRenderingContext2D=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){o(e,this)}var n=e.mixin,r=e.registerWrapper,o=e.setWrapper,i=e.unsafeUnwrap,a=e.unwrapIfNeeded,s=e.wrap,c=window.WebGLRenderingContext;if(c){n(t.prototype,{get canvas(){return s(i(this).canvas)},texImage2D:function(){arguments[5]=a(arguments[5]),i(this).texImage2D.apply(i(this),arguments)},texSubImage2D:function(){arguments[6]=a(arguments[6]),i(this).texSubImage2D.apply(i(this),arguments)}});var l=/WebKit/.test(navigator.userAgent)?{drawingBufferHeight:null,drawingBufferWidth:null}:{};r(c,t,l),e.wrappers.WebGLRenderingContext=t}}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){n.call(this,e)}var n=e.wrappers.Node,r=e.GetElementsByInterface,o=e.NonElementParentNodeInterface,i=e.ParentNodeInterface,a=e.SelectorsInterface,s=e.mixin,c=e.registerObject,l=e.registerWrapper,u=window.DocumentFragment;t.prototype=Object.create(n.prototype),s(t.prototype,i),s(t.prototype,a),s(t.prototype,r),s(t.prototype,o),l(u,t,document.createDocumentFragment()),e.wrappers.DocumentFragment=t;var d=c(document.createComment(""));e.wrappers.Comment=d}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){var t=d(u(e).ownerDocument.createDocumentFragment());n.call(this,t),c(t,this);var o=e.shadowRoot;h.set(this,o),this.treeScope_=new r(this,a(o||e)),p.set(this,e)}var n=e.wrappers.DocumentFragment,r=e.TreeScope,o=e.elementFromPoint,i=e.getInnerHTML,a=e.getTreeScope,s=e.mixin,c=e.rewrap,l=e.setInnerHTML,u=e.unsafeUnwrap,d=e.unwrap,p=new WeakMap,h=new WeakMap;t.prototype=Object.create(n.prototype),s(t.prototype,{constructor:t,get innerHTML(){return i(this)},set innerHTML(e){l(this,e),this.invalidateShadowRenderer()},get olderShadowRoot(){return h.get(this)||null},get host(){return p.get(this)||null},invalidateShadowRenderer:function(){return p.get(this).invalidateShadowRenderer()},elementFromPoint:function(e,t){return o(this,this.ownerDocument,e,t)}}),e.wrappers.ShadowRoot=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){var t=d(e).root;return t instanceof h?t.host:null}function n(t,n){if(t.shadowRoot){n=Math.min(t.childNodes.length-1,n);var r=t.childNodes[n];if(r){var o=e.getDestinationInsertionPoints(r);if(o.length>0){var i=o[0].parentNode;i.nodeType==Node.ELEMENT_NODE&&(t=i)}}}return t}function r(e){return e=u(e),t(e)||e}function o(e){a(e,this)}var i=e.registerWrapper,a=e.setWrapper,s=e.unsafeUnwrap,c=e.unwrap,l=e.unwrapIfNeeded,u=e.wrap,d=e.getTreeScope,p=window.Range,h=e.wrappers.ShadowRoot;o.prototype={get startContainer(){return r(s(this).startContainer)},get endContainer(){return r(s(this).endContainer)},get commonAncestorContainer(){return r(s(this).commonAncestorContainer)},setStart:function(e,t){e=n(e,t),s(this).setStart(l(e),t)},setEnd:function(e,t){e=n(e,t),s(this).setEnd(l(e),t)},setStartBefore:function(e){s(this).setStartBefore(l(e))},setStartAfter:function(e){s(this).setStartAfter(l(e))},setEndBefore:function(e){s(this).setEndBefore(l(e))},setEndAfter:function(e){s(this).setEndAfter(l(e))},selectNode:function(e){s(this).selectNode(l(e))},selectNodeContents:function(e){s(this).selectNodeContents(l(e))},compareBoundaryPoints:function(e,t){return s(this).compareBoundaryPoints(e,c(t))},extractContents:function(){return u(s(this).extractContents())},cloneContents:function(){return u(s(this).cloneContents())},insertNode:function(e){s(this).insertNode(l(e))},surroundContents:function(e){s(this).surroundContents(l(e))},cloneRange:function(){return u(s(this).cloneRange())},isPointInRange:function(e,t){return s(this).isPointInRange(l(e),t)},comparePoint:function(e,t){return s(this).comparePoint(l(e),t)},intersectsNode:function(e){return s(this).intersectsNode(l(e))},toString:function(){return s(this).toString()}},p.prototype.createContextualFragment&&(o.prototype.createContextualFragment=function(e){return u(s(this).createContextualFragment(e))}),i(window.Range,o,document.createRange()),e.wrappers.Range=o}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){e.previousSibling_=e.previousSibling,e.nextSibling_=e.nextSibling,e.parentNode_=e.parentNode}function n(n,o,i){var a=x(n),s=x(o),c=i?x(i):null;if(r(o),t(o),i)n.firstChild===i&&(n.firstChild_=i),i.previousSibling_=i.previousSibling;else{n.lastChild_=n.lastChild,n.lastChild===n.firstChild&&(n.firstChild_=n.firstChild);var l=R(a.lastChild);l&&(l.nextSibling_=l.nextSibling)}e.originalInsertBefore.call(a,s,c)}function r(n){var r=x(n),o=r.parentNode;if(o){var i=R(o);t(n),n.previousSibling&&(n.previousSibling.nextSibling_=n),n.nextSibling&&(n.nextSibling.previousSibling_=n),i.lastChild===n&&(i.lastChild_=n),i.firstChild===n&&(i.firstChild_=n),e.originalRemoveChild.call(o,r)}}function o(e){P.set(e,[])}function i(e){var t=P.get(e);return t||P.set(e,t=[]),t}function a(e){for(var t=[],n=0,r=e.firstChild;r;r=r.nextSibling)t[n++]=r;return t}function s(){for(var e=0;e<F.length;e++){var t=F[e],n=t.parentRenderer;n&&n.dirty||t.render()}F=[]}function c(){T=null,s()}function l(e){var t=A.get(e);return t||(t=new h(e),A.set(e,t)),t}function u(e){var t=j(e).root;return t instanceof C?t:null}function d(e){return l(e.host)}function p(e){this.skip=!1,this.node=e,this.childNodes=[]}function h(e){this.host=e,this.dirty=!1,this.invalidateAttributes(),this.associateNode(e)}function f(e){for(var t=[],n=e.firstChild;n;n=n.nextSibling)E(n)?t.push.apply(t,i(n)):t.push(n);return t}function m(e){if(e instanceof L)return e;if(e instanceof O)return null;for(var t=e.firstChild;t;t=t.nextSibling){var n=m(t);if(n)return n}return null}function w(e,t){i(t).push(e);var n=k.get(e);n?n.push(t):k.set(e,[t])}function v(e){return k.get(e)}function g(e){k.set(e,void 0)}function b(e,t){var n=t.getAttribute("select");if(!n)return!0;if(n=n.trim(),!n)return!0;if(!(e instanceof M))return!1;if(!q.test(n))return!1;try{return e.matches(n)}catch(r){return!1}}function y(e,t){var n=v(t);return n&&n[n.length-1]===e}function E(e){return e instanceof O||e instanceof L}function _(e){return e.shadowRoot}function S(e){for(var t=[],n=e.shadowRoot;n;n=n.olderShadowRoot)t.push(n);return t}var T,M=e.wrappers.Element,O=e.wrappers.HTMLContentElement,L=e.wrappers.HTMLShadowElement,N=e.wrappers.Node,C=e.wrappers.ShadowRoot,j=(e.assert,e.getTreeScope),D=(e.mixin,e.oneOf),H=e.unsafeUnwrap,x=e.unwrap,R=e.wrap,I=e.ArraySplice,P=new WeakMap,k=new WeakMap,A=new WeakMap,W=D(window,["requestAnimationFrame","mozRequestAnimationFrame","webkitRequestAnimationFrame","setTimeout"]),F=[],U=new I;U.equals=function(e,t){return x(e.node)===t},p.prototype={append:function(e){var t=new p(e);return this.childNodes.push(t),t},sync:function(e){if(!this.skip){for(var t=this.node,o=this.childNodes,i=a(x(t)),s=e||new WeakMap,c=U.calculateSplices(o,i),l=0,u=0,d=0,p=0;p<c.length;p++){for(var h=c[p];d<h.index;d++)u++,o[l++].sync(s);for(var f=h.removed.length,m=0;f>m;m++){var w=R(i[u++]);s.get(w)||r(w)}for(var v=h.addedCount,g=i[u]&&R(i[u]),m=0;v>m;m++){var b=o[l++],y=b.node;n(t,y,g),s.set(y,!0),b.sync(s)}d+=v}for(var p=d;p<o.length;p++)o[p].sync(s)}}},h.prototype={render:function(e){if(this.dirty){this.invalidateAttributes();var t=this.host;this.distribution(t);var n=e||new p(t);this.buildRenderTree(n,t);var r=!e;r&&n.sync(),this.dirty=!1}},get parentRenderer(){return j(this.host).renderer},invalidate:function(){if(!this.dirty){this.dirty=!0;var e=this.parentRenderer;if(e&&e.invalidate(),F.push(this),T)return;T=window[W](c,0)}},distribution:function(e){this.resetAllSubtrees(e),this.distributionResolution(e)},resetAll:function(e){E(e)?o(e):g(e),this.resetAllSubtrees(e)},resetAllSubtrees:function(e){for(var t=e.firstChild;t;t=t.nextSibling)this.resetAll(t);e.shadowRoot&&this.resetAll(e.shadowRoot),e.olderShadowRoot&&this.resetAll(e.olderShadowRoot)},distributionResolution:function(e){if(_(e)){for(var t=e,n=f(t),r=S(t),o=0;o<r.length;o++)this.poolDistribution(r[o],n);for(var o=r.length-1;o>=0;o--){var i=r[o],a=m(i);if(a){var s=i.olderShadowRoot;s&&(n=f(s));for(var c=0;c<n.length;c++)w(n[c],a)}this.distributionResolution(i)}}for(var l=e.firstChild;l;l=l.nextSibling)this.distributionResolution(l)},poolDistribution:function(e,t){if(!(e instanceof L))if(e instanceof O){var n=e;this.updateDependentAttributes(n.getAttribute("select"));for(var r=!1,o=0;o<t.length;o++){var e=t[o];e&&b(e,n)&&(w(e,n),t[o]=void 0,r=!0)}if(!r)for(var i=n.firstChild;i;i=i.nextSibling)w(i,n)}else for(var i=e.firstChild;i;i=i.nextSibling)this.poolDistribution(i,t)},buildRenderTree:function(e,t){for(var n=this.compose(t),r=0;r<n.length;r++){var o=n[r],i=e.append(o);this.buildRenderTree(i,o)}if(_(t)){var a=l(t);a.dirty=!1}},compose:function(e){for(var t=[],n=e.shadowRoot||e,r=n.firstChild;r;r=r.nextSibling)if(E(r)){this.associateNode(n);for(var o=i(r),a=0;a<o.length;a++){var s=o[a];y(r,s)&&t.push(s)}}else t.push(r);return t},invalidateAttributes:function(){this.attributes=Object.create(null)},updateDependentAttributes:function(e){if(e){var t=this.attributes;/\.\w+/.test(e)&&(t["class"]=!0),/#\w+/.test(e)&&(t.id=!0),e.replace(/\[\s*([^\s=\|~\]]+)/g,function(e,n){t[n]=!0})}},dependsOnAttribute:function(e){return this.attributes[e]},associateNode:function(e){H(e).polymerShadowRenderer_=this}};var q=/^(:not\()?[*.#[a-zA-Z_|]/;N.prototype.invalidateShadowRenderer=function(e){var t=H(this).polymerShadowRenderer_;return t?(t.invalidate(),!0):!1},O.prototype.getDistributedNodes=L.prototype.getDistributedNodes=function(){return s(),i(this)},M.prototype.getDestinationInsertionPoints=function(){return s(),v(this)||[]},O.prototype.nodeIsInserted_=L.prototype.nodeIsInserted_=function(){this.invalidateShadowRenderer();var e,t=u(this);t&&(e=d(t)),H(this).polymerShadowRenderer_=e,e&&e.invalidate()},e.getRendererForHost=l,e.getShadowTrees=S,e.renderAllPending=s,e.getDestinationInsertionPoints=v,e.visual={insertBefore:n,remove:r}}(window.ShadowDOMPolyfill),function(e){"use strict";function t(t){if(window[t]){r(!e.wrappers[t]);var c=function(e){n.call(this,e)};c.prototype=Object.create(n.prototype),o(c.prototype,{get form(){return s(a(this).form)}}),i(window[t],c,document.createElement(t.slice(4,-7))),e.wrappers[t]=c}}var n=e.wrappers.HTMLElement,r=e.assert,o=e.mixin,i=e.registerWrapper,a=e.unwrap,s=e.wrap,c=["HTMLButtonElement","HTMLFieldSetElement","HTMLInputElement","HTMLKeygenElement","HTMLLabelElement","HTMLLegendElement","HTMLObjectElement","HTMLOutputElement","HTMLTextAreaElement"];c.forEach(t)}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){r(e,this)}var n=e.registerWrapper,r=e.setWrapper,o=e.unsafeUnwrap,i=e.unwrap,a=e.unwrapIfNeeded,s=e.wrap,c=window.Selection;t.prototype={get anchorNode(){return s(o(this).anchorNode)},get focusNode(){return s(o(this).focusNode)},addRange:function(e){o(this).addRange(a(e))},collapse:function(e,t){o(this).collapse(a(e),t)},containsNode:function(e,t){return o(this).containsNode(a(e),t)},getRangeAt:function(e){return s(o(this).getRangeAt(e))},removeRange:function(e){o(this).removeRange(i(e))},selectAllChildren:function(e){o(this).selectAllChildren(a(e))},toString:function(){return o(this).toString()}},c.prototype.extend&&(t.prototype.extend=function(e,t){o(this).extend(a(e),t)}),n(window.Selection,t,window.getSelection()),e.wrappers.Selection=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){r(e,this)}var n=e.registerWrapper,r=e.setWrapper,o=e.unsafeUnwrap,i=e.unwrapIfNeeded,a=e.wrap,s=window.TreeWalker;t.prototype={get root(){return a(o(this).root)},get currentNode(){return a(o(this).currentNode)},set currentNode(e){o(this).currentNode=i(e)},get filter(){return o(this).filter},parentNode:function(){return a(o(this).parentNode())},firstChild:function(){return a(o(this).firstChild())},lastChild:function(){return a(o(this).lastChild())},previousSibling:function(){return a(o(this).previousSibling())},previousNode:function(){return a(o(this).previousNode())},nextNode:function(){return a(o(this).nextNode())}},n(s,t),e.wrappers.TreeWalker=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){u.call(this,e),this.treeScope_=new w(this,null)}function n(e){var n=document[e];t.prototype[e]=function(){return C(n.apply(L(this),arguments))}}function r(e,t){H.call(L(t),N(e)),o(e,t)}function o(e,t){e.shadowRoot&&t.adoptNode(e.shadowRoot),e instanceof m&&i(e,t);for(var n=e.firstChild;n;n=n.nextSibling)o(n,t)}function i(e,t){var n=e.olderShadowRoot;n&&t.adoptNode(n)}function a(e){O(e,this)}function s(e,t){var n=document.implementation[t];e.prototype[t]=function(){return C(n.apply(L(this),arguments))}}function c(e,t){var n=document.implementation[t];e.prototype[t]=function(){return n.apply(L(this),arguments)}}var l=e.GetElementsByInterface,u=e.wrappers.Node,d=e.ParentNodeInterface,p=e.NonElementParentNodeInterface,h=e.wrappers.Selection,f=e.SelectorsInterface,m=e.wrappers.ShadowRoot,w=e.TreeScope,v=e.cloneNode,g=e.defineWrapGetter,b=e.elementFromPoint,y=e.forwardMethodsToWrapper,E=e.matchesNames,_=e.mixin,S=e.registerWrapper,T=e.renderAllPending,M=e.rewrap,O=e.setWrapper,L=e.unsafeUnwrap,N=e.unwrap,C=e.wrap,j=e.wrapEventTargetMethods,D=(e.wrapNodeList,
new WeakMap);t.prototype=Object.create(u.prototype),g(t,"documentElement"),g(t,"body"),g(t,"head"),["createComment","createDocumentFragment","createElement","createElementNS","createEvent","createEventNS","createRange","createTextNode"].forEach(n);var H=document.adoptNode,x=document.getSelection;_(t.prototype,{adoptNode:function(e){return e.parentNode&&e.parentNode.removeChild(e),r(e,this),e},elementFromPoint:function(e,t){return b(this,this,e,t)},importNode:function(e,t){return v(e,t,L(this))},getSelection:function(){return T(),new h(x.call(N(this)))},getElementsByName:function(e){return f.querySelectorAll.call(this,"[name="+JSON.stringify(String(e))+"]")}});var R=document.createTreeWalker,I=e.wrappers.TreeWalker;if(t.prototype.createTreeWalker=function(e,t,n,r){var o=null;return n&&(n.acceptNode&&"function"==typeof n.acceptNode?o={acceptNode:function(e){return n.acceptNode(C(e))}}:"function"==typeof n&&(o=function(e){return n(C(e))})),new I(R.call(N(this),N(e),t,o,r))},document.registerElement){var P=document.registerElement;t.prototype.registerElement=function(t,n){function r(e){return e?void O(e,this):i?document.createElement(i,t):document.createElement(t)}var o,i;if(void 0!==n&&(o=n.prototype,i=n["extends"]),o||(o=Object.create(HTMLElement.prototype)),e.nativePrototypeTable.get(o))throw new Error("NotSupportedError");for(var a,s=Object.getPrototypeOf(o),c=[];s&&!(a=e.nativePrototypeTable.get(s));)c.push(s),s=Object.getPrototypeOf(s);if(!a)throw new Error("NotSupportedError");for(var l=Object.create(a),u=c.length-1;u>=0;u--)l=Object.create(l);["createdCallback","attachedCallback","detachedCallback","attributeChangedCallback"].forEach(function(e){var t=o[e];t&&(l[e]=function(){C(this)instanceof r||M(this),t.apply(C(this),arguments)})});var d={prototype:l};i&&(d["extends"]=i),r.prototype=o,r.prototype.constructor=r,e.constructorTable.set(l,r),e.nativePrototypeTable.set(o,l);P.call(N(this),t,d);return r},y([window.HTMLDocument||window.Document],["registerElement"])}y([window.HTMLBodyElement,window.HTMLDocument||window.Document,window.HTMLHeadElement,window.HTMLHtmlElement],["appendChild","compareDocumentPosition","contains","getElementsByClassName","getElementsByTagName","getElementsByTagNameNS","insertBefore","querySelector","querySelectorAll","removeChild","replaceChild"]),y([window.HTMLBodyElement,window.HTMLHeadElement,window.HTMLHtmlElement],E),y([window.HTMLDocument||window.Document],["adoptNode","importNode","contains","createComment","createDocumentFragment","createElement","createElementNS","createEvent","createEventNS","createRange","createTextNode","createTreeWalker","elementFromPoint","getElementById","getElementsByName","getSelection"]),_(t.prototype,l),_(t.prototype,d),_(t.prototype,f),_(t.prototype,p),_(t.prototype,{get implementation(){var e=D.get(this);return e?e:(e=new a(N(this).implementation),D.set(this,e),e)},get defaultView(){return C(N(this).defaultView)}}),S(window.Document,t,document.implementation.createHTMLDocument("")),window.HTMLDocument&&S(window.HTMLDocument,t),j([window.HTMLBodyElement,window.HTMLDocument||window.Document,window.HTMLHeadElement]);var k=document.implementation.createDocument;a.prototype.createDocument=function(){return arguments[2]=N(arguments[2]),C(k.apply(L(this),arguments))},s(a,"createDocumentType"),s(a,"createHTMLDocument"),c(a,"hasFeature"),S(window.DOMImplementation,a),y([window.DOMImplementation],["createDocument","createDocumentType","createHTMLDocument","hasFeature"]),e.adoptNodeNoRemove=r,e.wrappers.DOMImplementation=a,e.wrappers.Document=t}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){n.call(this,e)}var n=e.wrappers.EventTarget,r=e.wrappers.Selection,o=e.mixin,i=e.registerWrapper,a=e.renderAllPending,s=e.unwrap,c=e.unwrapIfNeeded,l=e.wrap,u=window.Window,d=window.getComputedStyle,p=window.getDefaultComputedStyle,h=window.getSelection;t.prototype=Object.create(n.prototype),u.prototype.getComputedStyle=function(e,t){return l(this||window).getComputedStyle(c(e),t)},p&&(u.prototype.getDefaultComputedStyle=function(e,t){return l(this||window).getDefaultComputedStyle(c(e),t)}),u.prototype.getSelection=function(){return l(this||window).getSelection()},delete window.getComputedStyle,delete window.getDefaultComputedStyle,delete window.getSelection,["addEventListener","removeEventListener","dispatchEvent"].forEach(function(e){u.prototype[e]=function(){var t=l(this||window);return t[e].apply(t,arguments)},delete window[e]}),o(t.prototype,{getComputedStyle:function(e,t){return a(),d.call(s(this),c(e),t)},getSelection:function(){return a(),new r(h.call(s(this)))},get document(){return l(s(this).document)}}),p&&(t.prototype.getDefaultComputedStyle=function(e,t){return a(),p.call(s(this),c(e),t)}),i(u,t,window),e.wrappers.Window=t}(window.ShadowDOMPolyfill),function(e){"use strict";var t=e.unwrap,n=window.DataTransfer||window.Clipboard,r=n.prototype.setDragImage;r&&(n.prototype.setDragImage=function(e,n,o){r.call(this,t(e),n,o)})}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){var t;t=e instanceof i?e:new i(e&&o(e)),r(t,this)}var n=e.registerWrapper,r=e.setWrapper,o=e.unwrap,i=window.FormData;i&&(n(i,t,new i),e.wrappers.FormData=t)}(window.ShadowDOMPolyfill),function(e){"use strict";var t=e.unwrapIfNeeded,n=XMLHttpRequest.prototype.send;XMLHttpRequest.prototype.send=function(e){return n.call(this,t(e))}}(window.ShadowDOMPolyfill),function(e){"use strict";function t(e){var t=n[e],r=window[t];if(r){var o=document.createElement(e),i=o.constructor;window[t]=i}}var n=(e.isWrapperFor,{a:"HTMLAnchorElement",area:"HTMLAreaElement",audio:"HTMLAudioElement",base:"HTMLBaseElement",body:"HTMLBodyElement",br:"HTMLBRElement",button:"HTMLButtonElement",canvas:"HTMLCanvasElement",caption:"HTMLTableCaptionElement",col:"HTMLTableColElement",content:"HTMLContentElement",data:"HTMLDataElement",datalist:"HTMLDataListElement",del:"HTMLModElement",dir:"HTMLDirectoryElement",div:"HTMLDivElement",dl:"HTMLDListElement",embed:"HTMLEmbedElement",fieldset:"HTMLFieldSetElement",font:"HTMLFontElement",form:"HTMLFormElement",frame:"HTMLFrameElement",frameset:"HTMLFrameSetElement",h1:"HTMLHeadingElement",head:"HTMLHeadElement",hr:"HTMLHRElement",html:"HTMLHtmlElement",iframe:"HTMLIFrameElement",img:"HTMLImageElement",input:"HTMLInputElement",keygen:"HTMLKeygenElement",label:"HTMLLabelElement",legend:"HTMLLegendElement",li:"HTMLLIElement",link:"HTMLLinkElement",map:"HTMLMapElement",marquee:"HTMLMarqueeElement",menu:"HTMLMenuElement",menuitem:"HTMLMenuItemElement",meta:"HTMLMetaElement",meter:"HTMLMeterElement",object:"HTMLObjectElement",ol:"HTMLOListElement",optgroup:"HTMLOptGroupElement",option:"HTMLOptionElement",output:"HTMLOutputElement",p:"HTMLParagraphElement",param:"HTMLParamElement",pre:"HTMLPreElement",progress:"HTMLProgressElement",q:"HTMLQuoteElement",script:"HTMLScriptElement",select:"HTMLSelectElement",shadow:"HTMLShadowElement",source:"HTMLSourceElement",span:"HTMLSpanElement",style:"HTMLStyleElement",table:"HTMLTableElement",tbody:"HTMLTableSectionElement",template:"HTMLTemplateElement",textarea:"HTMLTextAreaElement",thead:"HTMLTableSectionElement",time:"HTMLTimeElement",title:"HTMLTitleElement",tr:"HTMLTableRowElement",track:"HTMLTrackElement",ul:"HTMLUListElement",video:"HTMLVideoElement"});Object.keys(n).forEach(t),Object.getOwnPropertyNames(e.wrappers).forEach(function(t){window[t]=e.wrappers[t]})}(window.ShadowDOMPolyfill),function(e){function t(e,t){var n="";return Array.prototype.forEach.call(e,function(e){n+=e.textContent+"\n\n"}),t||(n=n.replace(d,"")),n}function n(e){var t=document.createElement("style");return t.textContent=e,t}function r(e){var t=n(e);document.head.appendChild(t);var r=[];if(t.sheet)try{r=t.sheet.cssRules}catch(o){}else console.warn("sheet not found",t);return t.parentNode.removeChild(t),r}function o(){C.initialized=!0,document.body.appendChild(C);var e=C.contentDocument,t=e.createElement("base");t.href=document.baseURI,e.head.appendChild(t)}function i(e){C.initialized||o(),document.body.appendChild(C),e(C.contentDocument),document.body.removeChild(C)}function a(e,t){if(t){var o;if(e.match("@import")&&D){var a=n(e);i(function(e){e.head.appendChild(a.impl),o=Array.prototype.slice.call(a.sheet.cssRules,0),t(o)})}else o=r(e),t(o)}}function s(e){e&&l().appendChild(document.createTextNode(e))}function c(e,t){var r=n(e);r.setAttribute(t,""),r.setAttribute(x,""),document.head.appendChild(r)}function l(){return j||(j=document.createElement("style"),j.setAttribute(x,""),j[x]=!0),j}var u={strictStyling:!1,registry:{},shimStyling:function(e,n,r){var o=this.prepareRoot(e,n,r),i=this.isTypeExtension(r),a=this.makeScopeSelector(n,i),s=t(o,!0);s=this.scopeCssText(s,a),e&&(e.shimmedStyle=s),this.addCssToDocument(s,n)},shimStyle:function(e,t){return this.shimCssText(e.textContent,t)},shimCssText:function(e,t){return e=this.insertDirectives(e),this.scopeCssText(e,t)},makeScopeSelector:function(e,t){return e?t?"[is="+e+"]":e:""},isTypeExtension:function(e){return e&&e.indexOf("-")<0},prepareRoot:function(e,t,n){var r=this.registerRoot(e,t,n);return this.replaceTextInStyles(r.rootStyles,this.insertDirectives),this.removeStyles(e,r.rootStyles),this.strictStyling&&this.applyScopeToContent(e,t),r.scopeStyles},removeStyles:function(e,t){for(var n,r=0,o=t.length;o>r&&(n=t[r]);r++)n.parentNode.removeChild(n)},registerRoot:function(e,t,n){var r=this.registry[t]={root:e,name:t,extendsName:n},o=this.findStyles(e);r.rootStyles=o,r.scopeStyles=r.rootStyles;var i=this.registry[r.extendsName];return i&&(r.scopeStyles=i.scopeStyles.concat(r.scopeStyles)),r},findStyles:function(e){if(!e)return[];var t=e.querySelectorAll("style");return Array.prototype.filter.call(t,function(e){return!e.hasAttribute(R)})},applyScopeToContent:function(e,t){e&&(Array.prototype.forEach.call(e.querySelectorAll("*"),function(e){e.setAttribute(t,"")}),Array.prototype.forEach.call(e.querySelectorAll("template"),function(e){this.applyScopeToContent(e.content,t)},this))},insertDirectives:function(e){return e=this.insertPolyfillDirectivesInCssText(e),this.insertPolyfillRulesInCssText(e)},insertPolyfillDirectivesInCssText:function(e){return e=e.replace(p,function(e,t){return t.slice(0,-2)+"{"}),e.replace(h,function(e,t){return t+" {"})},insertPolyfillRulesInCssText:function(e){return e=e.replace(f,function(e,t){return t.slice(0,-1)}),e.replace(m,function(e,t,n,r){var o=e.replace(t,"").replace(n,"");return r+o})},scopeCssText:function(e,t){var n=this.extractUnscopedRulesFromCssText(e);if(e=this.insertPolyfillHostInCssText(e),e=this.convertColonHost(e),e=this.convertColonHostContext(e),e=this.convertShadowDOMSelectors(e),t){var e,r=this;a(e,function(n){e=r.scopeRules(n,t)})}return e=e+"\n"+n,e.trim()},extractUnscopedRulesFromCssText:function(e){for(var t,n="";t=w.exec(e);)n+=t[1].slice(0,-1)+"\n\n";for(;t=v.exec(e);)n+=t[0].replace(t[2],"").replace(t[1],t[3])+"\n\n";return n},convertColonHost:function(e){return this.convertColonRule(e,E,this.colonHostPartReplacer)},convertColonHostContext:function(e){return this.convertColonRule(e,_,this.colonHostContextPartReplacer)},convertColonRule:function(e,t,n){return e.replace(t,function(e,t,r,o){if(t=O,r){for(var i,a=r.split(","),s=[],c=0,l=a.length;l>c&&(i=a[c]);c++)i=i.trim(),s.push(n(t,i,o));return s.join(",")}return t+o})},colonHostContextPartReplacer:function(e,t,n){return t.match(g)?this.colonHostPartReplacer(e,t,n):e+t+n+", "+t+" "+e+n},colonHostPartReplacer:function(e,t,n){return e+t.replace(g,"")+n},convertShadowDOMSelectors:function(e){for(var t=0;t<N.length;t++)e=e.replace(N[t]," ");return e},scopeRules:function(e,t){var n="";return e&&Array.prototype.forEach.call(e,function(e){if(e.selectorText&&e.style&&void 0!==e.style.cssText)n+=this.scopeSelector(e.selectorText,t,this.strictStyling)+" {\n ",n+=this.propertiesFromRule(e)+"\n}\n\n";else if(e.type===CSSRule.MEDIA_RULE)n+="@media "+e.media.mediaText+" {\n",n+=this.scopeRules(e.cssRules,t),n+="\n}\n\n";else try{e.cssText&&(n+=e.cssText+"\n\n")}catch(r){e.type===CSSRule.KEYFRAMES_RULE&&e.cssRules&&(n+=this.ieSafeCssTextFromKeyFrameRule(e))}},this),n},ieSafeCssTextFromKeyFrameRule:function(e){var t="@keyframes "+e.name+" {";return Array.prototype.forEach.call(e.cssRules,function(e){t+=" "+e.keyText+" {"+e.style.cssText+"}"}),t+=" }"},scopeSelector:function(e,t,n){var r=[],o=e.split(",");return o.forEach(function(e){e=e.trim(),this.selectorNeedsScoping(e,t)&&(e=n&&!e.match(O)?this.applyStrictSelectorScope(e,t):this.applySelectorScope(e,t)),r.push(e)},this),r.join(", ")},selectorNeedsScoping:function(e,t){if(Array.isArray(t))return!0;var n=this.makeScopeMatcher(t);return!e.match(n)},makeScopeMatcher:function(e){return e=e.replace(/\[/g,"\\[").replace(/\]/g,"\\]"),new RegExp("^("+e+")"+S,"m")},applySelectorScope:function(e,t){return Array.isArray(t)?this.applySelectorScopeList(e,t):this.applySimpleSelectorScope(e,t)},applySelectorScopeList:function(e,t){for(var n,r=[],o=0;n=t[o];o++)r.push(this.applySimpleSelectorScope(e,n));return r.join(", ")},applySimpleSelectorScope:function(e,t){return e.match(L)?(e=e.replace(O,t),e.replace(L,t+" ")):t+" "+e},applyStrictSelectorScope:function(e,t){t=t.replace(/\[is=([^\]]*)\]/g,"$1");var n=[" ",">","+","~"],r=e,o="["+t+"]";return n.forEach(function(e){var t=r.split(e);r=t.map(function(e){var t=e.trim().replace(L,"");return t&&n.indexOf(t)<0&&t.indexOf(o)<0&&(e=t.replace(/([^:]*)(:*)(.*)/,"$1"+o+"$2$3")),e}).join(e)}),r},insertPolyfillHostInCssText:function(e){return e.replace(M,b).replace(T,g)},propertiesFromRule:function(e){var t=e.style.cssText;e.style.content&&!e.style.content.match(/['"]+|attr/)&&(t=t.replace(/content:[^;]*;/g,"content: '"+e.style.content+"';"));var n=e.style;for(var r in n)"initial"===n[r]&&(t+=r+": initial; ");return t},replaceTextInStyles:function(e,t){e&&t&&(e instanceof Array||(e=[e]),Array.prototype.forEach.call(e,function(e){e.textContent=t.call(this,e.textContent)},this))},addCssToDocument:function(e,t){e.match("@import")?c(e,t):s(e)}},d=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//gim,p=/\/\*\s*@polyfill ([^*]*\*+([^/*][^*]*\*+)*\/)([^{]*?){/gim,h=/polyfill-next-selector[^}]*content\:[\s]*?['"](.*?)['"][;\s]*}([^{]*?){/gim,f=/\/\*\s@polyfill-rule([^*]*\*+([^/*][^*]*\*+)*)\//gim,m=/(polyfill-rule)[^}]*(content\:[\s]*['"](.*?)['"])[;\s]*[^}]*}/gim,w=/\/\*\s@polyfill-unscoped-rule([^*]*\*+([^/*][^*]*\*+)*)\//gim,v=/(polyfill-unscoped-rule)[^}]*(content\:[\s]*['"](.*?)['"])[;\s]*[^}]*}/gim,g="-shadowcsshost",b="-shadowcsscontext",y=")(?:\\(((?:\\([^)(]*\\)|[^)(]*)+?)\\))?([^,{]*)",E=new RegExp("("+g+y,"gim"),_=new RegExp("("+b+y,"gim"),S="([>\\s~+[.,{:][\\s\\S]*)?$",T=/\:host/gim,M=/\:host-context/gim,O=g+"-no-combinator",L=new RegExp(g,"gim"),N=(new RegExp(b,"gim"),[/>>>/g,/::shadow/g,/::content/g,/\/deep\//g,/\/shadow\//g,/\/shadow-deep\//g,/\^\^/g,/\^/g]),C=document.createElement("iframe");C.style.display="none";var j,D=navigator.userAgent.match("Chrome"),H="shim-shadowdom",x="shim-shadowdom-css",R="no-shim";if(window.ShadowDOMPolyfill){s("style { display: none !important; }\n");var I=ShadowDOMPolyfill.wrap(document),P=I.querySelector("head");P.insertBefore(l(),P.childNodes[0]),document.addEventListener("DOMContentLoaded",function(){e.urlResolver;if(window.HTMLImports&&!HTMLImports.useNative){var t="link[rel=stylesheet]["+H+"]",n="style["+H+"]";HTMLImports.importer.documentPreloadSelectors+=","+t,HTMLImports.importer.importsPreloadSelectors+=","+t,HTMLImports.parser.documentSelectors=[HTMLImports.parser.documentSelectors,t,n].join(",");var r=HTMLImports.parser.parseGeneric;HTMLImports.parser.parseGeneric=function(e){if(!e[x]){var t=e.__importElement||e;if(!t.hasAttribute(H))return void r.call(this,e);e.__resource&&(t=e.ownerDocument.createElement("style"),t.textContent=e.__resource),HTMLImports.path.resolveUrlsInStyle(t,e.href),t.textContent=u.shimStyle(t),t.removeAttribute(H,""),t.setAttribute(x,""),t[x]=!0,t.parentNode!==P&&(e.parentNode===P?P.replaceChild(t,e):this.addElementToDocument(t)),t.__importParsed=!0,this.markParsingComplete(e),this.parseNext()}};var o=HTMLImports.parser.hasResource;HTMLImports.parser.hasResource=function(e){return"link"===e.localName&&"stylesheet"===e.rel&&e.hasAttribute(H)?e.__resource:o.call(this,e)}}})}e.ShadowCSS=u}(window.WebComponents)),function(e){window.ShadowDOMPolyfill?(window.wrap=ShadowDOMPolyfill.wrapIfNeeded,window.unwrap=ShadowDOMPolyfill.unwrapIfNeeded):window.wrap=window.unwrap=function(e){return e}}(window.WebComponents),function(e){"use strict";function t(e){return void 0!==p[e]}function n(){s.call(this),this._isInvalid=!0}function r(e){return""==e&&n.call(this),e.toLowerCase()}function o(e){var t=e.charCodeAt(0);return t>32&&127>t&&-1==[34,35,60,62,63,96].indexOf(t)?e:encodeURIComponent(e)}function i(e){var t=e.charCodeAt(0);return t>32&&127>t&&-1==[34,35,60,62,96].indexOf(t)?e:encodeURIComponent(e)}function a(e,a,s){function c(e){b.push(e)}var l=a||"scheme start",u=0,d="",v=!1,g=!1,b=[];e:for(;(e[u-1]!=f||0==u)&&!this._isInvalid;){var y=e[u];switch(l){case"scheme start":if(!y||!m.test(y)){if(a){c("Invalid scheme.");break e}d="",l="no scheme";continue}d+=y.toLowerCase(),l="scheme";break;case"scheme":if(y&&w.test(y))d+=y.toLowerCase();else{if(":"!=y){if(a){if(f==y)break e;c("Code point not allowed in scheme: "+y);break e}d="",u=0,l="no scheme";continue}if(this._scheme=d,d="",a)break e;t(this._scheme)&&(this._isRelative=!0),l="file"==this._scheme?"relative":this._isRelative&&s&&s._scheme==this._scheme?"relative or authority":this._isRelative?"authority first slash":"scheme data"}break;case"scheme data":"?"==y?(this._query="?",l="query"):"#"==y?(this._fragment="#",l="fragment"):f!=y&&" "!=y&&"\n"!=y&&"\r"!=y&&(this._schemeData+=o(y));break;case"no scheme":if(s&&t(s._scheme)){l="relative";continue}c("Missing scheme."),n.call(this);break;case"relative or authority":if("/"!=y||"/"!=e[u+1]){c("Expected /, got: "+y),l="relative";continue}l="authority ignore slashes";break;case"relative":if(this._isRelative=!0,"file"!=this._scheme&&(this._scheme=s._scheme),f==y){this._host=s._host,this._port=s._port,this._path=s._path.slice(),this._query=s._query,this._username=s._username,this._password=s._password;break e}if("/"==y||"\\"==y)"\\"==y&&c("\\ is an invalid code point."),l="relative slash";else if("?"==y)this._host=s._host,this._port=s._port,this._path=s._path.slice(),this._query="?",this._username=s._username,this._password=s._password,l="query";else{if("#"!=y){var E=e[u+1],_=e[u+2];("file"!=this._scheme||!m.test(y)||":"!=E&&"|"!=E||f!=_&&"/"!=_&&"\\"!=_&&"?"!=_&&"#"!=_)&&(this._host=s._host,this._port=s._port,this._username=s._username,this._password=s._password,this._path=s._path.slice(),this._path.pop()),l="relative path";continue}this._host=s._host,this._port=s._port,this._path=s._path.slice(),this._query=s._query,this._fragment="#",this._username=s._username,this._password=s._password,l="fragment"}break;case"relative slash":if("/"!=y&&"\\"!=y){"file"!=this._scheme&&(this._host=s._host,this._port=s._port,this._username=s._username,this._password=s._password),l="relative path";continue}"\\"==y&&c("\\ is an invalid code point."),l="file"==this._scheme?"file host":"authority ignore slashes";break;case"authority first slash":if("/"!=y){c("Expected '/', got: "+y),l="authority ignore slashes";continue}l="authority second slash";break;case"authority second slash":if(l="authority ignore slashes","/"!=y){c("Expected '/', got: "+y);continue}break;case"authority ignore slashes":if("/"!=y&&"\\"!=y){l="authority";continue}c("Expected authority, got: "+y);break;case"authority":if("@"==y){v&&(c("@ already seen."),d+="%40"),v=!0;for(var S=0;S<d.length;S++){var T=d[S];if("   "!=T&&"\n"!=T&&"\r"!=T)if(":"!=T||null!==this._password){var M=o(T);null!==this._password?this._password+=M:this._username+=M}else this._password="";else c("Invalid whitespace in authority.")}d=""}else{if(f==y||"/"==y||"\\"==y||"?"==y||"#"==y){u-=d.length,d="",l="host";continue}d+=y}break;case"file host":if(f==y||"/"==y||"\\"==y||"?"==y||"#"==y){2!=d.length||!m.test(d[0])||":"!=d[1]&&"|"!=d[1]?0==d.length?l="relative path start":(this._host=r.call(this,d),d="",l="relative path start"):l="relative path";continue}"  "==y||"\n"==y||"\r"==y?c("Invalid whitespace in file host."):d+=y;break;case"host":case"hostname":if(":"!=y||g){if(f==y||"/"==y||"\\"==y||"?"==y||"#"==y){if(this._host=r.call(this,d),d="",l="relative path start",a)break e;continue}"    "!=y&&"\n"!=y&&"\r"!=y?("["==y?g=!0:"]"==y&&(g=!1),d+=y):c("Invalid code point in host/hostname: "+y)}else if(this._host=r.call(this,d),d="",l="port","hostname"==a)break e;break;case"port":if(/[0-9]/.test(y))d+=y;else{if(f==y||"/"==y||"\\"==y||"?"==y||"#"==y||a){if(""!=d){var O=parseInt(d,10);O!=p[this._scheme]&&(this._port=O+""),d=""}if(a)break e;l="relative path start";continue}"    "==y||"\n"==y||"\r"==y?c("Invalid code point in port: "+y):n.call(this)}break;case"relative path start":if("\\"==y&&c("'\\' not allowed in path."),l="relative path","/"!=y&&"\\"!=y)continue;break;case"relative path":if(f!=y&&"/"!=y&&"\\"!=y&&(a||"?"!=y&&"#"!=y))" "!=y&&"\n"!=y&&"\r"!=y&&(d+=o(y));else{"\\"==y&&c("\\ not allowed in relative path.");var L;(L=h[d.toLowerCase()])&&(d=L),".."==d?(this._path.pop(),"/"!=y&&"\\"!=y&&this._path.push("")):"."==d&&"/"!=y&&"\\"!=y?this._path.push(""):"."!=d&&("file"==this._scheme&&0==this._path.length&&2==d.length&&m.test(d[0])&&"|"==d[1]&&(d=d[0]+":"),this._path.push(d)),d="","?"==y?(this._query="?",l="query"):"#"==y&&(this._fragment="#",l="fragment")}break;case"query":a||"#"!=y?f!=y&&" "!=y&&"\n"!=y&&"\r"!=y&&(this._query+=i(y)):(this._fragment="#",l="fragment");break;case"fragment":f!=y&&"  "!=y&&"\n"!=y&&"\r"!=y&&(this._fragment+=y)}u++}}function s(){this._scheme="",this._schemeData="",this._username="",this._password=null,this._host="",this._port="",this._path=[],this._query="",this._fragment="",this._isInvalid=!1,this._isRelative=!1}function c(e,t){void 0===t||t instanceof c||(t=new c(String(t))),this._url=e,s.call(this);var n=e.replace(/^[ \t\r\n\f]+|[ \t\r\n\f]+$/g,"");a.call(this,n,null,t)}var l=!1;if(!e.forceJURL)try{var u=new URL("b","http://a");u.pathname="c%20d",l="http://a/c%20d"===u.href}catch(d){}if(!l){var p=Object.create(null);p.ftp=21,p.file=0,p.gopher=70,p.http=80,p.https=443,p.ws=80,p.wss=443;var h=Object.create(null);h["%2e"]=".",h[".%2e"]="..",h["%2e."]="..",h["%2e%2e"]="..";var f=void 0,m=/[a-zA-Z]/,w=/[a-zA-Z0-9\+\-\.]/;c.prototype={toString:function(){return this.href},get href(){if(this._isInvalid)return this._url;var e="";return(""!=this._username||null!=this._password)&&(e=this._username+(null!=this._password?":"+this._password:"")+"@"),this.protocol+(this._isRelative?"//"+e+this.host:"")+this.pathname+this._query+this._fragment},set href(e){s.call(this),a.call(this,e)},get protocol(){return this._scheme+":"},set protocol(e){this._isInvalid||a.call(this,e+":","scheme start")},get host(){return this._isInvalid?"":this._port?this._host+":"+this._port:this._host},set host(e){!this._isInvalid&&this._isRelative&&a.call(this,e,"host")},get hostname(){return this._host},set hostname(e){!this._isInvalid&&this._isRelative&&a.call(this,e,"hostname")},get port(){return this._port},set port(e){!this._isInvalid&&this._isRelative&&a.call(this,e,"port")},get pathname(){return this._isInvalid?"":this._isRelative?"/"+this._path.join("/"):this._schemeData},set pathname(e){!this._isInvalid&&this._isRelative&&(this._path=[],a.call(this,e,"relative path start"))},get search(){return this._isInvalid||!this._query||"?"==this._query?"":this._query},set search(e){!this._isInvalid&&this._isRelative&&(this._query="?","?"==e[0]&&(e=e.slice(1)),a.call(this,e,"query"))},get hash(){return this._isInvalid||!this._fragment||"#"==this._fragment?"":this._fragment},set hash(e){this._isInvalid||(this._fragment="#","#"==e[0]&&(e=e.slice(1)),a.call(this,e,"fragment"))},get origin(){var e;if(this._isInvalid||!this._scheme)return"";switch(this._scheme){case"data":case"file":case"javascript":case"mailto":return"null"}return e=this.host,e?this._scheme+"://"+e:""}};var v=e.URL;v&&(c.createObjectURL=function(e){return v.createObjectURL.apply(v,arguments)},c.revokeObjectURL=function(e){v.revokeObjectURL(e)}),e.URL=c}}(self),function(e){function t(e){y.push(e),b||(b=!0,m(r))}function n(e){return window.ShadowDOMPolyfill&&window.ShadowDOMPolyfill.wrapIfNeeded(e)||e}function r(){b=!1;var e=y;y=[],e.sort(function(e,t){return e.uid_-t.uid_});var t=!1;e.forEach(function(e){var n=e.takeRecords();o(e),n.length&&(e.callback_(n,e),t=!0)}),t&&r()}function o(e){e.nodes_.forEach(function(t){var n=w.get(t);n&&n.forEach(function(t){t.observer===e&&t.removeTransientObservers()})})}function i(e,t){for(var n=e;n;n=n.parentNode){var r=w.get(n);if(r)for(var o=0;o<r.length;o++){var i=r[o],a=i.options;if(n===e||a.subtree){var s=t(a);s&&i.enqueue(s)}}}}function a(e){this.callback_=e,this.nodes_=[],this.records_=[],this.uid_=++E}function s(e,t){this.type=e,this.target=t,this.addedNodes=[],this.removedNodes=[],this.previousSibling=null,this.nextSibling=null,this.attributeName=null,this.attributeNamespace=null,this.oldValue=null}function c(e){var t=new s(e.type,e.target);return t.addedNodes=e.addedNodes.slice(),t.removedNodes=e.removedNodes.slice(),t.previousSibling=e.previousSibling,t.nextSibling=e.nextSibling,t.attributeName=e.attributeName,t.attributeNamespace=e.attributeNamespace,t.oldValue=e.oldValue,t}function l(e,t){return _=new s(e,t)}function u(e){return S?S:(S=c(_),S.oldValue=e,S)}function d(){_=S=void 0}function p(e){return e===S||e===_}function h(e,t){return e===t?e:S&&p(e)?S:null}function f(e,t,n){this.observer=e,this.target=t,this.options=n,this.transientObservedNodes=[]}var m,w=new WeakMap;if(/Trident|Edge/.test(navigator.userAgent))m=setTimeout;else if(window.setImmediate)m=window.setImmediate;else{var v=[],g=String(Math.random());window.addEventListener("message",function(e){if(e.data===g){var t=v;v=[],t.forEach(function(e){e()})}}),m=function(e){v.push(e),window.postMessage(g,"*")}}var b=!1,y=[],E=0;a.prototype={observe:function(e,t){if(e=n(e),!t.childList&&!t.attributes&&!t.characterData||t.attributeOldValue&&!t.attributes||t.attributeFilter&&t.attributeFilter.length&&!t.attributes||t.characterDataOldValue&&!t.characterData)throw new SyntaxError;var r=w.get(e);r||w.set(e,r=[]);for(var o,i=0;i<r.length;i++)if(r[i].observer===this){o=r[i],o.removeListeners(),o.options=t;break}o||(o=new f(this,e,t),r.push(o),this.nodes_.push(e)),o.addListeners()},disconnect:function(){this.nodes_.forEach(function(e){for(var t=w.get(e),n=0;n<t.length;n++){var r=t[n];if(r.observer===this){r.removeListeners(),t.splice(n,1);break}}},this),this.records_=[]},takeRecords:function(){var e=this.records_;return this.records_=[],e}};var _,S;f.prototype={enqueue:function(e){var n=this.observer.records_,r=n.length;if(n.length>0){var o=n[r-1],i=h(o,e);if(i)return void(n[r-1]=i)}else t(this.observer);n[r]=e},addListeners:function(){this.addListeners_(this.target)},addListeners_:function(e){var t=this.options;t.attributes&&e.addEventListener("DOMAttrModified",this,!0),t.characterData&&e.addEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.addEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.addEventListener("DOMNodeRemoved",this,!0)},removeListeners:function(){this.removeListeners_(this.target)},removeListeners_:function(e){var t=this.options;t.attributes&&e.removeEventListener("DOMAttrModified",this,!0),t.characterData&&e.removeEventListener("DOMCharacterDataModified",this,!0),t.childList&&e.removeEventListener("DOMNodeInserted",this,!0),(t.childList||t.subtree)&&e.removeEventListener("DOMNodeRemoved",this,!0)},addTransientObserver:function(e){if(e!==this.target){this.addListeners_(e),this.transientObservedNodes.push(e);var t=w.get(e);t||w.set(e,t=[]),t.push(this)}},removeTransientObservers:function(){var e=this.transientObservedNodes;this.transientObservedNodes=[],e.forEach(function(e){this.removeListeners_(e);for(var t=w.get(e),n=0;n<t.length;n++)if(t[n]===this){t.splice(n,1);break}},this)},handleEvent:function(e){switch(e.stopImmediatePropagation(),e.type){case"DOMAttrModified":var t=e.attrName,n=e.relatedNode.namespaceURI,r=e.target,o=new l("attributes",r);o.attributeName=t,o.attributeNamespace=n;var a=e.attrChange===MutationEvent.ADDITION?null:e.prevValue;i(r,function(e){return!e.attributes||e.attributeFilter&&e.attributeFilter.length&&-1===e.attributeFilter.indexOf(t)&&-1===e.attributeFilter.indexOf(n)?void 0:e.attributeOldValue?u(a):o});break;case"DOMCharacterDataModified":var r=e.target,o=l("characterData",r),a=e.prevValue;i(r,function(e){return e.characterData?e.characterDataOldValue?u(a):o:void 0});break;case"DOMNodeRemoved":this.addTransientObserver(e.target);case"DOMNodeInserted":var s,c,p=e.target;"DOMNodeInserted"===e.type?(s=[p],c=[]):(s=[],c=[p]);var h=p.previousSibling,f=p.nextSibling,o=l("childList",e.target.parentNode);o.addedNodes=s,o.removedNodes=c,o.previousSibling=h,o.nextSibling=f,i(e.relatedNode,function(e){return e.childList?o:void 0})}d()}},e.JsMutationObserver=a,e.MutationObserver||(e.MutationObserver=a)}(self),window.HTMLImports=window.HTMLImports||{flags:{}},function(e){function t(e,t){t=t||f,r(function(){i(e,t)},t)}function n(e){return"complete"===e.readyState||e.readyState===v}function r(e,t){if(n(t))e&&e();else{var o=function(){("complete"===t.readyState||t.readyState===v)&&(t.removeEventListener(g,o),r(e,t))};t.addEventListener(g,o)}}function o(e){e.target.__loaded=!0}function i(e,t){function n(){c==l&&e&&e({allImports:s,loadedImports:u,errorImports:d})}function r(e){o(e),u.push(this),c++,n()}function i(e){d.push(this),c++,n()}var s=t.querySelectorAll("link[rel=import]"),c=0,l=s.length,u=[],d=[];if(l)for(var p,h=0;l>h&&(p=s[h]);h++)a(p)?(c++,n()):(p.addEventListener("load",r),p.addEventListener("error",i));else n()}function a(e){return d?e.__loaded||e["import"]&&"loading"!==e["import"].readyState:e.__importParsed}function s(e){for(var t,n=0,r=e.length;r>n&&(t=e[n]);n++)c(t)&&l(t)}function c(e){return"link"===e.localName&&"import"===e.rel}function l(e){var t=e["import"];t?o({target:e}):(e.addEventListener("load",o),e.addEventListener("error",o))}var u="import",d=Boolean(u in document.createElement("link")),p=Boolean(window.ShadowDOMPolyfill),h=function(e){return p?window.ShadowDOMPolyfill.wrapIfNeeded(e):e},f=h(document),m={get:function(){var e=window.HTMLImports.currentScript||document.currentScript||("complete"!==document.readyState?document.scripts[document.scripts.length-1]:null);return h(e)},configurable:!0};Object.defineProperty(document,"_currentScript",m),Object.defineProperty(f,"_currentScript",m);var w=/Trident/.test(navigator.userAgent),v=w?"complete":"interactive",g="readystatechange";d&&(new MutationObserver(function(e){for(var t,n=0,r=e.length;r>n&&(t=e[n]);n++)t.addedNodes&&s(t.addedNodes)}).observe(document.head,{childList:!0}),function(){if("loading"===document.readyState)for(var e,t=document.querySelectorAll("link[rel=import]"),n=0,r=t.length;r>n&&(e=t[n]);n++)l(e)}()),t(function(e){window.HTMLImports.ready=!0,window.HTMLImports.readyTime=(new Date).getTime();var t=f.createEvent("CustomEvent");t.initCustomEvent("HTMLImportsLoaded",!0,!0,e),f.dispatchEvent(t)}),e.IMPORT_LINK_TYPE=u,e.useNative=d,e.rootDocument=f,e.whenReady=t,e.isIE=w}(window.HTMLImports),function(e){var t=[],n=function(e){t.push(e)},r=function(){t.forEach(function(t){t(e)})};e.addModule=n,e.initializeModules=r}(window.HTMLImports),window.HTMLImports.addModule(function(e){var t=/(url\()([^)]*)(\))/g,n=/(@import[\s]+(?!url\())([^;]*)(;)/g,r={resolveUrlsInStyle:function(e,t){var n=e.ownerDocument,r=n.createElement("a");return e.textContent=this.resolveUrlsInCssText(e.textContent,t,r),e},resolveUrlsInCssText:function(e,r,o){var i=this.replaceUrls(e,o,r,t);return i=this.replaceUrls(i,o,r,n)},replaceUrls:function(e,t,n,r){return e.replace(r,function(e,r,o,i){var a=o.replace(/["']/g,"");return n&&(a=new URL(a,n).href),t.href=a,a=t.href,r+"'"+a+"'"+i})}};e.path=r}),window.HTMLImports.addModule(function(e){
var t={async:!0,ok:function(e){return e.status>=200&&e.status<300||304===e.status||0===e.status},load:function(n,r,o){var i=new XMLHttpRequest;return(e.flags.debug||e.flags.bust)&&(n+="?"+Math.random()),i.open("GET",n,t.async),i.addEventListener("readystatechange",function(e){if(4===i.readyState){var n=i.getResponseHeader("Location"),a=null;if(n)var a="/"===n.substr(0,1)?location.origin+n:n;r.call(o,!t.ok(i)&&i,i.response||i.responseText,a)}}),i.send(),i},loadDocument:function(e,t,n){this.load(e,t,n).responseType="document"}};e.xhr=t}),window.HTMLImports.addModule(function(e){var t=e.xhr,n=e.flags,r=function(e,t){this.cache={},this.onload=e,this.oncomplete=t,this.inflight=0,this.pending={}};r.prototype={addNodes:function(e){this.inflight+=e.length;for(var t,n=0,r=e.length;r>n&&(t=e[n]);n++)this.require(t);this.checkDone()},addNode:function(e){this.inflight++,this.require(e),this.checkDone()},require:function(e){var t=e.src||e.href;e.__nodeUrl=t,this.dedupe(t,e)||this.fetch(t,e)},dedupe:function(e,t){if(this.pending[e])return this.pending[e].push(t),!0;return this.cache[e]?(this.onload(e,t,this.cache[e]),this.tail(),!0):(this.pending[e]=[t],!1)},fetch:function(e,r){if(n.load&&console.log("fetch",e,r),e)if(e.match(/^data:/)){var o=e.split(","),i=o[0],a=o[1];a=i.indexOf(";base64")>-1?atob(a):decodeURIComponent(a),setTimeout(function(){this.receive(e,r,null,a)}.bind(this),0)}else{var s=function(t,n,o){this.receive(e,r,t,n,o)}.bind(this);t.load(e,s)}else setTimeout(function(){this.receive(e,r,{error:"href must be specified"},null)}.bind(this),0)},receive:function(e,t,n,r,o){this.cache[e]=r;for(var i,a=this.pending[e],s=0,c=a.length;c>s&&(i=a[s]);s++)this.onload(e,i,r,n,o),this.tail();this.pending[e]=null},tail:function(){--this.inflight,this.checkDone()},checkDone:function(){this.inflight||this.oncomplete()}},e.Loader=r}),window.HTMLImports.addModule(function(e){var t=function(e){this.addCallback=e,this.mo=new MutationObserver(this.handler.bind(this))};t.prototype={handler:function(e){for(var t,n=0,r=e.length;r>n&&(t=e[n]);n++)"childList"===t.type&&t.addedNodes.length&&this.addedNodes(t.addedNodes)},addedNodes:function(e){this.addCallback&&this.addCallback(e);for(var t,n=0,r=e.length;r>n&&(t=e[n]);n++)t.children&&t.children.length&&this.addedNodes(t.children)},observe:function(e){this.mo.observe(e,{childList:!0,subtree:!0})}},e.Observer=t}),window.HTMLImports.addModule(function(e){function t(e){return"link"===e.localName&&e.rel===u}function n(e){var t=r(e);return"data:text/javascript;charset=utf-8,"+encodeURIComponent(t)}function r(e){return e.textContent+o(e)}function o(e){var t=e.ownerDocument;t.__importedScripts=t.__importedScripts||0;var n=e.ownerDocument.baseURI,r=t.__importedScripts?"-"+t.__importedScripts:"";return t.__importedScripts++,"\n//# sourceURL="+n+r+".js\n"}function i(e){var t=e.ownerDocument.createElement("style");return t.textContent=e.textContent,a.resolveUrlsInStyle(t),t}var a=e.path,s=e.rootDocument,c=e.flags,l=e.isIE,u=e.IMPORT_LINK_TYPE,d="link[rel="+u+"]",p={documentSelectors:d,importsSelectors:[d,"link[rel=stylesheet]:not([type])","style:not([type])","script:not([type])",'script[type="application/javascript"]','script[type="text/javascript"]'].join(","),map:{link:"parseLink",script:"parseScript",style:"parseStyle"},dynamicElements:[],parseNext:function(){var e=this.nextToParse();e&&this.parse(e)},parse:function(e){if(this.isParsed(e))return void(c.parse&&console.log("[%s] is already parsed",e.localName));var t=this[this.map[e.localName]];t&&(this.markParsing(e),t.call(this,e))},parseDynamic:function(e,t){this.dynamicElements.push(e),t||this.parseNext()},markParsing:function(e){c.parse&&console.log("parsing",e),this.parsingElement=e},markParsingComplete:function(e){e.__importParsed=!0,this.markDynamicParsingComplete(e),e.__importElement&&(e.__importElement.__importParsed=!0,this.markDynamicParsingComplete(e.__importElement)),this.parsingElement=null,c.parse&&console.log("completed",e)},markDynamicParsingComplete:function(e){var t=this.dynamicElements.indexOf(e);t>=0&&this.dynamicElements.splice(t,1)},parseImport:function(e){if(e["import"]=e.__doc,window.HTMLImports.__importsParsingHook&&window.HTMLImports.__importsParsingHook(e),e["import"]&&(e["import"].__importParsed=!0),this.markParsingComplete(e),e.__resource&&!e.__error?e.dispatchEvent(new CustomEvent("load",{bubbles:!1})):e.dispatchEvent(new CustomEvent("error",{bubbles:!1})),e.__pending)for(var t;e.__pending.length;)t=e.__pending.shift(),t&&t({target:e});this.parseNext()},parseLink:function(e){t(e)?this.parseImport(e):(e.href=e.href,this.parseGeneric(e))},parseStyle:function(e){var t=e;e=i(e),t.__appliedElement=e,e.__importElement=t,this.parseGeneric(e)},parseGeneric:function(e){this.trackElement(e),this.addElementToDocument(e)},rootImportForElement:function(e){for(var t=e;t.ownerDocument.__importLink;)t=t.ownerDocument.__importLink;return t},addElementToDocument:function(e){var t=this.rootImportForElement(e.__importElement||e);t.parentNode.insertBefore(e,t)},trackElement:function(e,t){var n=this,r=function(o){e.removeEventListener("load",r),e.removeEventListener("error",r),t&&t(o),n.markParsingComplete(e),n.parseNext()};if(e.addEventListener("load",r),e.addEventListener("error",r),l&&"style"===e.localName){var o=!1;if(-1==e.textContent.indexOf("@import"))o=!0;else if(e.sheet){o=!0;for(var i,a=e.sheet.cssRules,s=a?a.length:0,c=0;s>c&&(i=a[c]);c++)i.type===CSSRule.IMPORT_RULE&&(o=o&&Boolean(i.styleSheet))}o&&setTimeout(function(){e.dispatchEvent(new CustomEvent("load",{bubbles:!1}))})}},parseScript:function(t){var r=document.createElement("script");r.__importElement=t,r.src=t.src?t.src:n(t),e.currentScript=t,this.trackElement(r,function(t){r.parentNode&&r.parentNode.removeChild(r),e.currentScript=null}),this.addElementToDocument(r)},nextToParse:function(){return this._mayParse=[],!this.parsingElement&&(this.nextToParseInDoc(s)||this.nextToParseDynamic())},nextToParseInDoc:function(e,n){if(e&&this._mayParse.indexOf(e)<0){this._mayParse.push(e);for(var r,o=e.querySelectorAll(this.parseSelectorsForNode(e)),i=0,a=o.length;a>i&&(r=o[i]);i++)if(!this.isParsed(r))return this.hasResource(r)?t(r)?this.nextToParseInDoc(r.__doc,r):r:void 0}return n},nextToParseDynamic:function(){return this.dynamicElements[0]},parseSelectorsForNode:function(e){var t=e.ownerDocument||e;return t===s?this.documentSelectors:this.importsSelectors},isParsed:function(e){return e.__importParsed},needsDynamicParsing:function(e){return this.dynamicElements.indexOf(e)>=0},hasResource:function(e){return t(e)&&void 0===e.__doc?!1:!0}};e.parser=p,e.IMPORT_SELECTOR=d}),window.HTMLImports.addModule(function(e){function t(e){return n(e,a)}function n(e,t){return"link"===e.localName&&e.getAttribute("rel")===t}function r(e){return!!Object.getOwnPropertyDescriptor(e,"baseURI")}function o(e,t){var n=document.implementation.createHTMLDocument(a);n._URL=t;var o=n.createElement("base");o.setAttribute("href",t),n.baseURI||r(n)||Object.defineProperty(n,"baseURI",{value:t});var i=n.createElement("meta");return i.setAttribute("charset","utf-8"),n.head.appendChild(i),n.head.appendChild(o),n.body.innerHTML=e,window.HTMLTemplateElement&&HTMLTemplateElement.bootstrap&&HTMLTemplateElement.bootstrap(n),n}var i=e.flags,a=e.IMPORT_LINK_TYPE,s=e.IMPORT_SELECTOR,c=e.rootDocument,l=e.Loader,u=e.Observer,d=e.parser,p={documents:{},documentPreloadSelectors:s,importsPreloadSelectors:[s].join(","),loadNode:function(e){h.addNode(e)},loadSubtree:function(e){var t=this.marshalNodes(e);h.addNodes(t)},marshalNodes:function(e){return e.querySelectorAll(this.loadSelectorsForNode(e))},loadSelectorsForNode:function(e){var t=e.ownerDocument||e;return t===c?this.documentPreloadSelectors:this.importsPreloadSelectors},loaded:function(e,n,r,a,s){if(i.load&&console.log("loaded",e,n),n.__resource=r,n.__error=a,t(n)){var c=this.documents[e];void 0===c&&(c=a?null:o(r,s||e),c&&(c.__importLink=n,this.bootDocument(c)),this.documents[e]=c),n.__doc=c}d.parseNext()},bootDocument:function(e){this.loadSubtree(e),this.observer.observe(e),d.parseNext()},loadedAll:function(){d.parseNext()}},h=new l(p.loaded.bind(p),p.loadedAll.bind(p));if(p.observer=new u,!document.baseURI){var f={get:function(){var e=document.querySelector("base");return e?e.href:window.location.href},configurable:!0};Object.defineProperty(document,"baseURI",f),Object.defineProperty(c,"baseURI",f)}e.importer=p,e.importLoader=h}),window.HTMLImports.addModule(function(e){var t=e.parser,n=e.importer,r={added:function(e){for(var r,o,i,a,s=0,c=e.length;c>s&&(a=e[s]);s++)r||(r=a.ownerDocument,o=t.isParsed(r)),i=this.shouldLoadNode(a),i&&n.loadNode(a),this.shouldParseNode(a)&&o&&t.parseDynamic(a,i)},shouldLoadNode:function(e){return 1===e.nodeType&&o.call(e,n.loadSelectorsForNode(e))},shouldParseNode:function(e){return 1===e.nodeType&&o.call(e,t.parseSelectorsForNode(e))}};n.observer.addCallback=r.added.bind(r);var o=HTMLElement.prototype.matches||HTMLElement.prototype.matchesSelector||HTMLElement.prototype.webkitMatchesSelector||HTMLElement.prototype.mozMatchesSelector||HTMLElement.prototype.msMatchesSelector}),function(e){function t(){window.HTMLImports.importer.bootDocument(o)}var n=e.initializeModules,r=e.isIE;if(!e.useNative){r&&"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(e,t){t=t||{};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,Boolean(t.bubbles),Boolean(t.cancelable),t.detail),n.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})},n},window.CustomEvent.prototype=window.Event.prototype),n();var o=e.rootDocument;"complete"===document.readyState||"interactive"===document.readyState&&!window.attachEvent?t():document.addEventListener("DOMContentLoaded",t)}}(window.HTMLImports),window.CustomElements=window.CustomElements||{flags:{}},function(e){var t=e.flags,n=[],r=function(e){n.push(e)},o=function(){n.forEach(function(t){t(e)})};e.addModule=r,e.initializeModules=o,e.hasNative=Boolean(document.registerElement),e.isIE=/Trident/.test(navigator.userAgent),e.useNative=!t.register&&e.hasNative&&!window.ShadowDOMPolyfill&&(!window.HTMLImports||window.HTMLImports.useNative)}(window.CustomElements),window.CustomElements.addModule(function(e){function t(e,t){n(e,function(e){return t(e)?!0:void r(e,t)}),r(e,t)}function n(e,t,r){var o=e.firstElementChild;if(!o)for(o=e.firstChild;o&&o.nodeType!==Node.ELEMENT_NODE;)o=o.nextSibling;for(;o;)t(o,r)!==!0&&n(o,t,r),o=o.nextElementSibling;return null}function r(e,n){for(var r=e.shadowRoot;r;)t(r,n),r=r.olderShadowRoot}function o(e,t){i(e,t,[])}function i(e,t,n){if(e=window.wrap(e),!(n.indexOf(e)>=0)){n.push(e);for(var r,o=e.querySelectorAll("link[rel="+a+"]"),s=0,c=o.length;c>s&&(r=o[s]);s++)r["import"]&&i(r["import"],t,n);t(e)}}var a=window.HTMLImports?window.HTMLImports.IMPORT_LINK_TYPE:"none";e.forDocumentTree=o,e.forSubtree=t}),window.CustomElements.addModule(function(e){function t(e,t){return n(e,t)||r(e,t)}function n(t,n){return e.upgrade(t,n)?!0:void(n&&a(t))}function r(e,t){b(e,function(e){return n(e,t)?!0:void 0})}function o(e){S.push(e),_||(_=!0,setTimeout(i))}function i(){_=!1;for(var e,t=S,n=0,r=t.length;r>n&&(e=t[n]);n++)e();S=[]}function a(e){E?o(function(){s(e)}):s(e)}function s(e){e.__upgraded__&&!e.__attached&&(e.__attached=!0,e.attachedCallback&&e.attachedCallback())}function c(e){l(e),b(e,function(e){l(e)})}function l(e){E?o(function(){u(e)}):u(e)}function u(e){e.__upgraded__&&e.__attached&&(e.__attached=!1,e.detachedCallback&&e.detachedCallback())}function d(e){for(var t=e,n=window.wrap(document);t;){if(t==n)return!0;t=t.parentNode||t.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&t.host}}function p(e){if(e.shadowRoot&&!e.shadowRoot.__watched){g.dom&&console.log("watching shadow-root for: ",e.localName);for(var t=e.shadowRoot;t;)m(t),t=t.olderShadowRoot}}function h(e,n){if(g.dom){var r=n[0];if(r&&"childList"===r.type&&r.addedNodes&&r.addedNodes){for(var o=r.addedNodes[0];o&&o!==document&&!o.host;)o=o.parentNode;var i=o&&(o.URL||o._URL||o.host&&o.host.localName)||"";i=i.split("/?").shift().split("/").pop()}console.group("mutations (%d) [%s]",n.length,i||"")}var a=d(e);n.forEach(function(e){"childList"===e.type&&(T(e.addedNodes,function(e){e.localName&&t(e,a)}),T(e.removedNodes,function(e){e.localName&&c(e)}))}),g.dom&&console.groupEnd()}function f(e){for(e=window.wrap(e),e||(e=window.wrap(document));e.parentNode;)e=e.parentNode;var t=e.__observer;t&&(h(e,t.takeRecords()),i())}function m(e){if(!e.__observer){var t=new MutationObserver(h.bind(this,e));t.observe(e,{childList:!0,subtree:!0}),e.__observer=t}}function w(e){e=window.wrap(e),g.dom&&console.group("upgradeDocument: ",e.baseURI.split("/").pop());var n=e===window.wrap(document);t(e,n),m(e),g.dom&&console.groupEnd()}function v(e){y(e,w)}var g=e.flags,b=e.forSubtree,y=e.forDocumentTree,E=!window.MutationObserver||window.MutationObserver===window.JsMutationObserver;e.hasPolyfillMutations=E;var _=!1,S=[],T=Array.prototype.forEach.call.bind(Array.prototype.forEach),M=Element.prototype.createShadowRoot;M&&(Element.prototype.createShadowRoot=function(){var e=M.call(this);return window.CustomElements.watchShadow(this),e}),e.watchShadow=p,e.upgradeDocumentTree=v,e.upgradeDocument=w,e.upgradeSubtree=r,e.upgradeAll=t,e.attached=a,e.takeRecords=f}),window.CustomElements.addModule(function(e){function t(t,r){if(!t.__upgraded__&&t.nodeType===Node.ELEMENT_NODE){var o=t.getAttribute("is"),i=e.getRegisteredDefinition(t.localName)||e.getRegisteredDefinition(o);if(i&&(o&&i.tag==t.localName||!o&&!i["extends"]))return n(t,i,r)}}function n(t,n,o){return a.upgrade&&console.group("upgrade:",t.localName),n.is&&t.setAttribute("is",n.is),r(t,n),t.__upgraded__=!0,i(t),o&&e.attached(t),e.upgradeSubtree(t,o),a.upgrade&&console.groupEnd(),t}function r(e,t){Object.__proto__?e.__proto__=t.prototype:(o(e,t.prototype,t["native"]),e.__proto__=t.prototype)}function o(e,t,n){for(var r={},o=t;o!==n&&o!==HTMLElement.prototype;){for(var i,a=Object.getOwnPropertyNames(o),s=0;i=a[s];s++)r[i]||(Object.defineProperty(e,i,Object.getOwnPropertyDescriptor(o,i)),r[i]=1);o=Object.getPrototypeOf(o)}}function i(e){e.createdCallback&&e.createdCallback()}var a=e.flags;e.upgrade=t,e.upgradeWithDefinition=n,e.implementPrototype=r}),window.CustomElements.addModule(function(e){function t(t,r){var c=r||{};if(!t)throw new Error("document.registerElement: first argument `name` must not be empty");if(t.indexOf("-")<0)throw new Error("document.registerElement: first argument ('name') must contain a dash ('-'). Argument provided was '"+String(t)+"'.");if(o(t))throw new Error("Failed to execute 'registerElement' on 'Document': Registration failed for type '"+String(t)+"'. The type name is invalid.");if(l(t))throw new Error("DuplicateDefinitionError: a type with name '"+String(t)+"' is already registered");return c.prototype||(c.prototype=Object.create(HTMLElement.prototype)),c.__name=t.toLowerCase(),c.lifecycle=c.lifecycle||{},c.ancestry=i(c["extends"]),a(c),s(c),n(c.prototype),u(c.__name,c),c.ctor=d(c),c.ctor.prototype=c.prototype,c.prototype.constructor=c.ctor,e.ready&&v(document),c.ctor}function n(e){if(!e.setAttribute._polyfilled){var t=e.setAttribute;e.setAttribute=function(e,n){r.call(this,e,n,t)};var n=e.removeAttribute;e.removeAttribute=function(e){r.call(this,e,null,n)},e.setAttribute._polyfilled=!0}}function r(e,t,n){e=e.toLowerCase();var r=this.getAttribute(e);n.apply(this,arguments);var o=this.getAttribute(e);this.attributeChangedCallback&&o!==r&&this.attributeChangedCallback(e,r,o)}function o(e){for(var t=0;t<_.length;t++)if(e===_[t])return!0}function i(e){var t=l(e);return t?i(t["extends"]).concat([t]):[]}function a(e){for(var t,n=e["extends"],r=0;t=e.ancestry[r];r++)n=t.is&&t.tag;e.tag=n||e.__name,n&&(e.is=e.__name)}function s(e){if(!Object.__proto__){var t=HTMLElement.prototype;if(e.is){var n=document.createElement(e.tag);t=Object.getPrototypeOf(n)}for(var r,o=e.prototype,i=!1;o;)o==t&&(i=!0),r=Object.getPrototypeOf(o),r&&(o.__proto__=r),o=r;i||console.warn(e.tag+" prototype not found in prototype chain for "+e.is),e["native"]=t}}function c(e){return b(M(e.tag),e)}function l(e){return e?S[e.toLowerCase()]:void 0}function u(e,t){S[e]=t}function d(e){return function(){return c(e)}}function p(e,t,n){return e===T?h(t,n):O(e,t)}function h(e,t){e&&(e=e.toLowerCase()),t&&(t=t.toLowerCase());var n=l(t||e);if(n){if(e==n.tag&&t==n.is)return new n.ctor;if(!t&&!n.is)return new n.ctor}var r;return t?(r=h(e),r.setAttribute("is",t),r):(r=M(e),e.indexOf("-")>=0&&y(r,HTMLElement),r)}function f(e,t){var n=e[t];e[t]=function(){var e=n.apply(this,arguments);return g(e),e}}var m,w=e.isIE,v=e.upgradeDocumentTree,g=e.upgradeAll,b=e.upgradeWithDefinition,y=e.implementPrototype,E=e.useNative,_=["annotation-xml","color-profile","font-face","font-face-src","font-face-uri","font-face-format","font-face-name","missing-glyph"],S={},T="http://www.w3.org/1999/xhtml",M=document.createElement.bind(document),O=document.createElementNS.bind(document);m=Object.__proto__||E?function(e,t){return e instanceof t}:function(e,t){if(e instanceof t)return!0;for(var n=e;n;){if(n===t.prototype)return!0;n=n.__proto__}return!1},f(Node.prototype,"cloneNode"),f(document,"importNode"),w&&!function(){var e=document.importNode;document.importNode=function(){var t=e.apply(document,arguments);if(t.nodeType==t.DOCUMENT_FRAGMENT_NODE){var n=document.createDocumentFragment();return n.appendChild(t),n}return t}}(),document.registerElement=t,document.createElement=h,document.createElementNS=p,e.registry=S,e["instanceof"]=m,e.reservedTagList=_,e.getRegisteredDefinition=l,document.register=document.registerElement}),function(e){function t(){a(window.wrap(document)),window.CustomElements.ready=!0;var e=window.requestAnimationFrame||function(e){setTimeout(e,16)};e(function(){setTimeout(function(){window.CustomElements.readyTime=Date.now(),window.HTMLImports&&(window.CustomElements.elapsed=window.CustomElements.readyTime-window.HTMLImports.readyTime),document.dispatchEvent(new CustomEvent("WebComponentsReady",{bubbles:!0}))})})}var n=e.useNative,r=e.initializeModules,o=e.isIE;if(n){var i=function(){};e.watchShadow=i,e.upgrade=i,e.upgradeAll=i,e.upgradeDocumentTree=i,e.upgradeSubtree=i,e.takeRecords=i,e["instanceof"]=function(e,t){return e instanceof t}}else r();var a=e.upgradeDocumentTree,s=e.upgradeDocument;if(window.wrap||(window.ShadowDOMPolyfill?(window.wrap=window.ShadowDOMPolyfill.wrapIfNeeded,window.unwrap=window.ShadowDOMPolyfill.unwrapIfNeeded):window.wrap=window.unwrap=function(e){return e}),window.HTMLImports&&(window.HTMLImports.__importsParsingHook=function(e){e["import"]&&s(wrap(e["import"]))}),o&&"function"!=typeof window.CustomEvent&&(window.CustomEvent=function(e,t){t=t||{};var n=document.createEvent("CustomEvent");return n.initCustomEvent(e,Boolean(t.bubbles),Boolean(t.cancelable),t.detail),n.preventDefault=function(){Object.defineProperty(this,"defaultPrevented",{get:function(){return!0}})},n},window.CustomEvent.prototype=window.Event.prototype),"complete"===document.readyState||e.flags.eager)t();else if("interactive"!==document.readyState||window.attachEvent||window.HTMLImports&&!window.HTMLImports.ready){var c=window.HTMLImports&&!window.HTMLImports.ready?"HTMLImportsLoaded":"DOMContentLoaded";window.addEventListener(c,t)}else t()}(window.CustomElements),function(e){Function.prototype.bind||(Function.prototype.bind=function(e){var t=this,n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(e,r)}})}(window.WebComponents),function(e){"use strict";if(!window.performance){var t=Date.now();window.performance={now:function(){return Date.now()-t}}}window.requestAnimationFrame||(window.requestAnimationFrame=function(){var e=window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame;return e?function(t){return e(function(){t(performance.now())})}:function(e){return window.setTimeout(e,1e3/60)}}()),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(){return window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(e){clearTimeout(e)}}())}(window.WebComponents),function(e){var t=document.createElement("style");t.textContent="body {transition: opacity ease-in 0.2s; } \nbody[unresolved] {opacity: 0; display: block; overflow: hidden; position: relative; } \n";var n=document.querySelector("head");n.insertBefore(t,n.firstChild)}(window.WebComponents),function(e){window.Platform=e}(window.WebComponents);
var PENDING   = {},
    RESOLVED  = {},
    REJECTED  = {},
    FULFILLED = {};

var Vow = function() {
    var vow = {};
    var _promise = PromiseObj();

    vow.resolve = _promise.resolve;
    vow.reject  = _promise.reject;
    vow.promise = {
        then: _promise.then,
        catch: _promise.catch,
        done: _promise.done
    };

    return vow;

    function PromiseObj() {
        var state = PENDING;
        var value, onResolved, onRejected, onFullfilled, returnPromise;

        var ret = {

            resolve: function (val) {
                value = val;
                state = RESOLVED;

                if (onResolved) {
                    handleResolve(onResolved);
                } else if (onFullfilled) {
                    handleDone(onFullfilled);
                }
            },

            reject: function (err) {
                value = err;
                state = REJECTED;

                if (onRejected) {
                    handleReject(onRejected);
                } else if (onFullfilled) {
                    handleDone(onFullfilled);
                }
            },

            then: function (successCallback) {
                returnPromise = PromiseObj();
                handleResolve(successCallback);

                return {
                    then: returnPromise.then,
                    catch: returnPromise.catch,
                    done: returnPromise.done
                };
            },

            catch: function (failCallback) {
                returnPromise = PromiseObj();
                handleReject(failCallback);

                return {
                    then: returnPromise.then,
                    catch: returnPromise.catch,
                    done: returnPromise.done
                };
            },

            done: function (finallyCallback) {
                handleDone(finallyCallback);
            }
        };

        return ret;

        function handleDone(fn) {
            if (state === PENDING) {
                onFullfilled = fn || 'done';
                return;
            }

            if (state === RESOLVED && typeof fn === 'function') {
                state = FULFILLED;
                return fn.call(this, value);
            }

            if (state === REJECTED) {
                state = FULFILLED;
                throw value;
            }
        }

        function handleResolve(fn) {
            var error;
            if (state === PENDING) {
                onResolved = fn;
            }

            if (state === RESOLVED) {
                if (value && typeof value.then === 'function') {
                    value.then(ret.resolve);
                    return;
                }

                try {
                    value = fn.call(this, value);
                } catch (err) {
                    value = err;
                    error = true;
                }

                if (returnPromise) {
                    if (!error) {
                        returnPromise.resolve(value);
                        return;
                    }
                    returnPromise.reject(value);
                }
            }
        }

        function handleReject(fn) {
            var error;
            if (state === PENDING) {
                onRejected = fn;
            }

            if (state === REJECTED) {
                try {
                    value = fn.call(this, value);
                } catch (err) {
                    value = err;
                    error = true;
                }

                if (returnPromise) {
                    if (!error) {
                        returnPromise.resolve(value);
                        return;
                    }
                    returnPromise.reject(value);
                }
            }

            if (state === RESOLVED) {
                if (returnPromise) {
                    returnPromise.resolve(value);
                }
            }
        }
    }
};

// Global Object to cache all instances of Signals
var SIGNALS_STORAGE = {};

var Signal = function(uuid, origin) {
    this.storage          = {};
    this.handleAll        = null;
    this.connectors       = {};
    this.origin           = origin;
    this.uuid             = uuid;
    SIGNALS_STORAGE[uuid] = this;
    origin.on             = this.on.bind(this);
    origin.off            = this.off.bind(this);
    origin.emit           = this.emit.bind(this);
    origin.broadcast      = this.broadcast.bind(this);
    origin.reset          = this.reset.bind(this);
    origin.connect        = this.connect.bind(this);
    origin.disconnect     = this.disconnect.bind(this);
};

Signal.prototype.on = function(pulseType, func) {
    if (typeof pulseType === 'function') {
        this.handleAll = pulseType;
        return;
    }

    if (!this.storage[pulseType]) {
        this.storage[pulseType] = [];
    }

    if (typeof func !== 'function') {
        throw new Error('Missing callback function on ' + pulseType + '.');
    }
    
    this.storage[pulseType].push(func);
};

Signal.prototype.off = function(pulseType, func) {
    var bucket = this.storage[pulseType] || [];

    bucket.forEach(function(fn, i) {
        if(fn === func) {
            bucket.splice(i, 1);
            return;
        }
    });
};

Signal.prototype.emit = function(pulseType, detail) {
    var pulse, connector;

    if (typeof pulseType === 'object' && pulseType.type) {
        pulse = pulseType;
    } else if (typeof pulseType === 'string') {
        pulse = MakePulse(pulseType, detail, this.origin);
    }

    for (var id in this.connectors) {
        connector = this.connectors[id];
        connector.trigger(pulse);
    }
};

Signal.prototype.broadcast = function(pulseType, detail) {
    var pulse = MakePulse(pulseType, detail, this.origin),
        signal;

    for (var id in SIGNALS_STORAGE) {
        signal = SIGNALS_STORAGE[id];
        signal.trigger(pulse);
    }
};

Signal.prototype.trigger = function(pulse) {
    if (!pulse.type) {
        throw new Error('Expect parameter to be a pulse');
    }

    var bucket = this.storage[pulse.type] || [];
    for (var i = 0; i < bucket.length; i++) {
        bucket[i](pulse);
    }
    if (this.handleAll) {
        this.handleAll(pulse);
    }
};

Signal.prototype.reset = function(name) {
    if (name) {
        this.storage[name] = [];
    } else {
        this.storage = {};
        for (var connectorId in this.connectors) {
            this.disconnect(connectorId);
        }
    }
};

Signal.prototype.addConnector = function(connectorId) {
    var connector = SIGNALS_STORAGE[connectorId];
    if (connector) {
        this.connectors[connectorId] = connector;
    } else {
        throw new Error('Cannot find connector ' + connectorId + '.');
    }
};

Signal.prototype.removeConnector = function(connectorId) {
    if (this.connectors[connectorId]) {
        delete this.connectors[connectorId];
    } else {
        throw new Error('Cannot find connector ' + connectorId + '.');
    }
};

Signal.prototype.connect = function(connectorId) {
    var connector = SIGNALS_STORAGE[connectorId];
    this.addConnector(connectorId);
    connector.addConnector(this.uuid);
};

Signal.prototype.disconnect = function(connectorId) {
    var connector = SIGNALS_STORAGE[connectorId];
    this.removeConnector(connectorId);
    connector.removeConnector(this.uuid);
};

function MakePulse(type, detail, origin) {
    var pulse = {
        type: type,
        detail: detail,
        origin: origin
    };

    return pulse;
}

var Factory = {};
var factoryIdGenerator = idGenerator('factory');

Factory._constructor = function(opts) {
    this.attributes = {};
    this.uuid       = factoryIdGenerator();
    this.resources  = {};
    new Signal(this.uuid, this);

    this.initialize(opts);
};

Factory._constructor.prototype.initialize = function() {};

/**
 * Sync factory with resourceName, and connect with resource's signal.
 * Map callback will be invoked with the resource object passed in on first sync, 
 * and every time resource is updated.
 */
Factory._constructor.prototype.sync = function(resourceName, map) {
    var resource = RESOURCE_STORE[resourceName];

    if (!resource) throw new Error('Resource ' + resourceName + ' does not exist.');

    this.resources[resourceName] = resource;
    this.connect(resource.uuid);
    map.call(this, resource);
    this.on('update:' + resource.uuid, map.bind(this, resource));

};

Factory.extend = extend;

var serviceIdGenerator = idGenerator('service');

var Service = {};

Service._constructor = function(opts) {
    this.uuid = serviceIdGenerator();
    new Signal(this.uuid, this);
    this.onReady(opts);
};

Service._constructor.prototype.onReady = function() {
    // To be implemented by instance
};

Service._constructor.prototype.onStart = function() {
    // To be implemented by instance
};

Service._constructor.prototype.onStop = function() {
    // To be implemented by instance
};

Service._constructor.prototype.start = function(opts) {
    this.onStart(opts);
    this.on(this.emit.bind(this));
};

Service._constructor.prototype.stop = function(opts) {
    this.onStop(opts);
    this.reset();
};

Service._constructor.prototype.implement = function(inst) {
    if (inst && inst.uuid) {
        this.connect(inst.uuid);
    } else {
        throw new Error('Expect parameter to contains property uuid.');
    }
};

Service.extend = extend;

var componentIdGenerator = idGenerator('component');
var COMPONENT_STORE = {};
var COMPONENT_DATASTORE = {};

//////////////////////////////////////////////////////
///////////////// COMPONENT MANAGER //////////////////
//////////////////////////////////////////////////////

var ComponentManager = {};

ComponentManager.register = function(opts) {
    if (COMPONENT_STORE[opts.tagName]) {
        return COMPONENT_STORE[opts.tagName];
    }

    var component = new Component(opts);
    COMPONENT_STORE[opts.tagName] = component;
    return component;
};

ComponentManager.get = function(tagName) {
    return COMPONENT_STORE[tagName];
};

//////////////////////////////////////////////////////
///////////////////// COMPONENT //////////////////////
//////////////////////////////////////////////////////

var Component = function(opts) {
    this.tagName = opts.tagName;
    this.registerElement(opts);
    this.dataKeygen = idGenerator(this.tagName);
};

Component.prototype.setData = function(data) {
    var dataKey = this.dataKeygen();
    COMPONENT_DATASTORE[dataKey] = data;
    return dataKey;
};

Component.prototype.getData = function(dataKey) {
    return COMPONENT_DATASTORE[dataKey];
};

/**
 * Render Helper Method
 * 1. If there is data, save it in COMPONENT_DATASTORE, get dataKey
 * 2. Render <custom-element data-key='dataKey'></custom-element>
 */
Component.prototype.render = function(data) {
    var dataKey, html;
    var temp = document.createElement('div');

    if (data) {
        dataKey = this.setData(data);
        html = '<' + this.tagName + ' data-key="' + dataKey + '"></' + this.tagName + '>';
    } else {
        html = '<' + this.tagName + '></' + this.tagName + '>';
    }

    temp.innerHTML = html;
    return temp.querySelector(this.tagName);
};

/**
 * Register Custom Element using HTML5 API
 */
Component.prototype.registerElement = function(opts) {
    // Set Prototype of custom element
    var proto = Object.create(HTMLElement.prototype);
    var tmpl   = opts.template || {};

    proto.createdCallback = function() {
        var shadow, dataKey, data;
        
        if (!tmpl.render || !tmpl.patch) {
            throw new Error('Trio.Template instance not found.');
        }

        // Create shadow root
        shadow = this.createShadowRoot();

        // Grab data from COMPONENT
        dataKey = this.getAttribute('data-key');
        data = COMPONENT_DATASTORE[dataKey];

        // Append rendered fragments into shadowRoot
        shadow.appendChild(opts.template.render(data));

        delete COMPONENT_DATASTORE[dataKey];

        // Set Trio uuid and signal
        this.uuid = componentIdGenerator();
        new Signal(this.uuid, this);

        // Create patch method
        this.patch = function(data) {
            tmpl.patch(shadow, data);
        };

        // Extend opts into element context
        _extend(this, opts);

        if (opts.onCreate) {
            opts.onCreate.apply(this, arguments);
        }

        function _extend(obj, extendedObject) {
            var blacklist = {
                onChange: true,
                onAttach: true,
                onDetach: true,
                onCreate: true,
                createdCallback: true,
                attachedCallback: true,
                detachedCallback: true,
                attributeChangedCallback: true,
                tagName: true
            };

            for (var key in extendedObject) {
                if (!blacklist[key]) {
                    obj[key] = extendedObject[key];
                }
            }
        }
    };

    proto.attachedCallback = function() {
        if (opts.onAttach) {
            opts.onAttach.apply(this, arguments);
        }
    };

    proto.detachedCallback = function() {
        if (opts.onDetach) {
            opts.onDetach.apply(this, arguments);
        }
    };

    proto.attributeChangedCallback = function() {
        if (opts.onChange) {
            opts.onChange.apply(this, arguments);
        }
    };

    document.registerElement(opts.tagName, {
        prototype: proto
    });
};

var mixins = {};
var variables = {};

// All vendors prefixes needed
var _ALLVENDORS = ['-webkit-', '-moz-', '-ms-', '-o-'];
// CSS Properties/Attributes that needs prefixes. This list will grow.
var ATTRIBUTES_TO_PREFIX = ['flex', 'transition', 'transform', 'calc', 'align-self', 'flex-flow', 'linear-gradient'];
// Regex to match any string that contains words need prefixes
var IS_PREFIXABLE = new RegExp(ATTRIBUTES_TO_PREFIX.join('|'));
// Key-pair for color to hex
var COLOR_MAP = {
    'black': '#000000',
    'white': '#ffffff',
    'blue': '#0000ff',
    'yellow': '#ffff00',
    'light-gray': '#cccccc',
    'dark-gray': '#333333',
    'gray': '#666666',
    'orange': '#ffa500',
    'purple': '#8a2be2'
};

var Stylizer = function() {};

Stylizer.prototype.create = function() {
    return new CSSTemplate();
};

Stylizer.prototype.registerMixin = function(key, func) {
    mixins[key] = func;
};

Stylizer.prototype.registerVariable = function(key, val) {
    variables[key] = val;
};

Stylizer.prototype.getVariable = function(key) {
    if (!variables[key]) {
        console.error('Variable ' + key + ' does not exist.');
        return;
    }
    return variables[key];
};

Stylizer.prototype.getMixin = function(key) {
    if (!mixins[key]) {
        console.error('Mixin ' + key + ' does not exist.');
        return;
    }
    return mixins[key];
};

var CSSTemplate = function() {
    this.style = {};
    this._context = null;
};

CSSTemplate.prototype.select = function(selector) {
    if (!this.style[selector]) {
        this.style[selector] = {};
    }
    this._context = this.style[selector];
    return this;
};

CSSTemplate.prototype.css = function(key, attr) {
    if (!this._context) {
        throw new Error('CSS Selector not present.');
    }

    if (typeof key === 'string') {
        addOneStyle(key, attr, this._context);
    } else if (typeof key === 'object') {
        for (var k in key) {
            addOneStyle(k, key[k], this._context);
        }
    }

    return this;

    function addOneStyle(key, attr, obj) {
        obj[key] = attr;
    }
};

CSSTemplate.prototype.toCSS = function() {
    var ret = '';

    for (var selector in this.style) {
        // Error for when style is not a two-layers object
        // Example:
        // cssSelector : {
        //     cssProperties: cssAttributes
        // }
        if (typeof selector !== 'string') {
            throw new Error('Invalid Style Object');
        }
        ret += selector + '{';
        var properties = this.style[selector];
        for (var prop in properties) {
            var setting = properties[prop];
                setting = replaceVariable.call(this, setting);
            ret += autoPrefix(prop, setting);
        }
        ret = ret.substring(0, ret.length - 1);
        ret += '}';
    }

    return ret;

    // Helper method that return css string with prefixes if necessary
    function autoPrefix(prop, setting) {
        var prefixedString = '' + prop + ':' + setting + ';';

        if (prop.match(IS_PREFIXABLE)) {
            for (var i = 0; i < _ALLVENDORS.length; i++) {
                prefixedString += _ALLVENDORS[i] + prop + ':' + setting + ';';
            }
        }

        if (setting.match(IS_PREFIXABLE)) {
            for (var j = 0; j < _ALLVENDORS.length; j++) {
                prefixedString += prop + ':' + _ALLVENDORS[j] + setting + ';';
            }
        }

        return prefixedString;
    }

    function replaceVariable(setting) {
        var rgbs = setting.match(/((rgb|rgba)\([^)]*\))/gi);
        var rgb, newRgb;
        var key, val;

        if (rgbs) {
            for (var j = 0; j < rgbs.length; j++) {
                rgb = rgbs[j];
                newRgb = replaceColor.call(this, rgb);
                setting = setting.replace(rgb, newRgb);
            }
        }

        var variables = setting.match(/\$([^\$][^\s\d\,\(\)]+)/gi);

        if (variables) {
            for (var i = 0; i < variables.length; i++) {
                key = variables[i].slice(1);
                val = Stylizer.prototype.getVariable.call(this, key);
                setting = setting.replace(variables[i], val);
            }
        }

        return setting;
    }

    function replaceColor(rgb) {
        var colors = rgb.match(/\$([^\$][^\s\d\,\(\)]+)/gi);
        var key, val;

        if (colors) {
            key = colors[0].slice(1);
            val = Stylizer.prototype.getVariable.call(this, key);
            val = toRGB(val);
            rgb = rgb.replace(colors[0], val);
        }
        return rgb;
    }

    function toRGB(color) {
        if (COLOR_MAP[color]) {
            color = COLOR_MAP[color];
        }

        var isHex = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(color);
        var isRGB = /((rgb|rgba)\([^)]*\))/i.exec(color);

        if (isHex) {
            return [
                parseInt(isHex[1], 16),
                parseInt(isHex[2], 16),
                parseInt(isHex[3], 16)
            ].join(',');
        } 

        if (isRGB) {
            return color.replace(/[a-z]|\(|\)/gi, '')
                .split(',')
                .slice(0, 3)
                .join(',');
        }

        throw new Error('Invalid color string.');
    }
};

CSSTemplate.prototype.toHex = function(rgb) {
    rgb = rgb.replace(' ', '').split(',');
    return "#" + componentToHex(rgb[0]) + componentToHex(rgb[1]) + componentToHex(rgb[2]);

    function componentToHex(c) {
        var hex = (+c).toString(16);
        return hex.length == 1 ? "0" + hex : hex;
    }
};

var moduleStore = {};

var Module = function() {};

Module.prototype.export = function(key, func) {
    if (typeof key !== 'string') {
        throw new Error('Module name is not a string.');
    }

    if (typeof func !== 'function') {
        throw new Error('Module is not a function.');
    }
    moduleStore[key] = function(done) {
        done(func());
    };
};

Module.prototype.import = function(modules) {
    var loaded = 0;
    var count  = Object.keys(modules);
    var vow = Vow();
    var ret = {};
    var url;

    _import(count.pop(), vow);

    vow.promise.and = {};
    vow.promise.and.export = function(key, func) {
        moduleStore[key] = function(done) {
            vow.promise
                .then(function(ret) {
                    moduleStore[key] = func.bind(this, ret);
                    return func.call(this, ret);
                }.bind(this))
                .done(done);
        };
    }.bind(this);

    vow.promise.and.import = function(modules) {
        return vow.promise.then(this.import.bind(this, modules));
    }.bind(this);

    return vow.promise;

    function _import(key, promise) {
        var url = modules[key];

        if (typeof key !== 'string') {
            throw new Error('Module name is not a string.');
        }

        if (typeof url !== 'string') {
            throw new Error('URL is not a string.');
        }

        var module = moduleStore[key];
        
        if (!module) {
            var script = document.createElement('script');

            script.type = "text/javascript";
            script.src = url;
            script.onload = function() {
                var defer = Vow();

                console.log('Loading ' + key + '...');

                defer.promise.then(function(data) {
                    ret[key] = data;
                    loaded++;
                    if (count.length === 0) {
                        promise.resolve(ret);
                    } else {
                        _import(count.pop(), promise);
                    }
                });

                script.remove();
                moduleStore[key](defer.resolve);
            }.bind(this, key);

            document.body.appendChild(script);
        } else {
            promise.resolve(module());
        }
    }
};

var resourceIdGenerator = idGenerator('resource');

// Gloabl Resources Storage
var RESOURCE_STORE = {};

//////////////////////////////////////////////
/////////// Resource Manager Class ///////////
//////////////////////////////////////////////
var ResourceManager = function() {};

ResourceManager.prototype.register = function(opts) {
    if (!opts.name) throw new Error('Expect parameter to have property: name.');
    var Res = Resource.extend(opts);
    RESOURCE_STORE[opts.name] = new Res(opts);
};

ResourceManager.prototype.get = function(name) {
    var resource = RESOURCE_STORE[name];
    if (!resource) throw new Error('Resource ' + name + ' not found.');
    return resource;
};

//////////////////////////////////////////////
/////////////// Resource Class ///////////////
//////////////////////////////////////////////
var Resource = {};

Resource._constructor = function(opts) {
    var cache = new LruCache(opts.cacheSize);
    this.uuid = resourceIdGenerator();
    new Signal(this.uuid, this);

    this.set = cache.set.bind(this);
    this.get = cache.get.bind(this);
};

// Decorated ajax function
Resource._constructor.prototype.sendRequest = function (opts, callback) {
    var request = new Ajax({
        type: opts.type,
        url: opts.url,
        onload: function(response) {
            callback(this.interceptResponse(response));
        }.bind(this)
    });

    this.interceptRequest(request);
    request.send(opts.payload);
};

Resource._constructor.prototype.interceptResponse = function(res) { return res; };
Resource._constructor.prototype.interceptRequest = function(req) { return req; };

Resource._constructor.prototype.encodeUrlParam = function(param) {
    var encodedString = '';
    for (var prop in param) {
        if (param.hasOwnProperty(prop)) {
            if (encodedString.length > 0) {
                encodedString += '&';
            }
            encodedString += encodeURI(prop + '=' + param[prop]);
        }
    }
    return encodedString;
};

Resource._constructor.prototype.hasBeenUpdated = function(key) {
    this.emit('update:' + this.uuid, null);
};

Resource.extend = extend;

//////////////////////////////////////////////
////////////////// LRU Cache /////////////////
//////////////////////////////////////////////

var LruCache = function(size) {
    var map = {};
    var list = new DblyLinkedList();
    var maxLength = size || 0;
    
    this.set = function(key, data) {
        var node = map[key];
        var oldTail;

        if (node) {
            list.pushToHead(node);
            node.data = data;
        } else {
            list.addToHead(key, data);
            map[key] = list.head;
        }

        if (maxLength !== 0 && list.length > maxLength) {
            oldTail = list.tail;
            list.removeTail();
            delete map[oldTail.key];
        }

    };

    this.get = function(key) {
        var node = map[key];

        if (node) {
            list.pushToHead(node);
        }

        return node ? node.data : null;

    };

};

var DblyLinkedList = function() {
    this.head = null;
    this.tail = null;
    this.length = 0;
};

DblyLinkedList.prototype.addToHead = function(key, data) {
    var node = new DblyLinkedListNode(key, data);
    var oldHead;

    if (!this.head && !this.tail) {
        this.head = node;
        this.tail = node;
    } else {
        oldHead = this.head;
        oldHead.prev = node;
        node.next = oldHead;
        this.head = node;
    }

    this.length++;

};

DblyLinkedList.prototype.pushToHead = function(node) {
    var oldHead = this.head;
    var prevNode = node.prev;
    var nextNode = node.next;

    if (this.head === node) {
        return;
    }

    if (prevNode && nextNode) {
        // Connect prev and next nodes
        prevNode.next = nextNode;
        nextNode.prev = prevNode;
    } else if (!nextNode) {
        // Set new tail
        this.tail = prevNode;
        this.tail.next = null;
    }

    // Push node to head
    this.head = node;
    node.next = oldHead;
    oldHead.prev = node;

};

DblyLinkedList.prototype.removeTail = function() {
    this.tail = this.tail.prev;
    this.tail.next = null;
    this.length--;
};

var DblyLinkedListNode = function(key, data) {
    this.prev = null;
    this.next = null;
    this.key  = key;
    this.data = data;
};



var Renderer = function(){};

Renderer.prototype.createTemplate = function() {
    return new Template();
};

var Template = function(){
    this._queue = [];
};

//////////////////////////////////////////////////////
/////////////// DOM Templating methods ///////////////
//////////////////////////////////////////////////////

// Each of the methods below push a command object to a command queue.
// The command queue will be executed by .render to create DOM fragments.
Template.prototype.open         = queueCommand('openTag');
Template.prototype.addClass     = queueCommand('addClass');
Template.prototype.text         = queueCommand('text');
Template.prototype.attr         = queueCommand('attribute');
Template.prototype.style        = queueCommand('style');
Template.prototype.data         = queueCommand('data');
Template.prototype.close        = queueCommand('closeTag');
Template.prototype.if           = queueCommand('if');
Template.prototype.else         = queueCommand('else');
Template.prototype.each         = queueCommand('loop');
Template.prototype.done         = queueCommand('done');
Template.prototype.xif          = Template.prototype.done; 
Template.prototype.xeach        = Template.prototype.done;

function queueCommand(commandName) {
    return function() {
        this._queue.push({
            action: commandName,
            detail: Array.prototype.slice.call(arguments)
        });
        return this;
    };
}

//////////////////////////////////////////////////////
/////////////////////// Render ///////////////////////
//////////////////////////////////////////////////////

Template.prototype.render = function(data) {
    // Root element to store DOMs
    var root            = document.createDocumentFragment(),
    // Stacks to reference current context
        elements        = [],
        conditionals    = [],
        loops           = [],
        states          = [],
    // Reference index for current execution
        execIndex       = 0,
        el, condition, loop;

    handleCommand.call(this, this._queue[execIndex], data);

    return root;

    function handleCommand(command, execData) {
        // Grab current state: LOOP, CONDITIONAL, or undefined
        var state = getLastFrom(states);

        // Base case: exit if no command
        if (!command) {
            return;
        }

        // Change data in current execuation if in a loop
        // From [{a: 'a'}, {b: 'b'}, {c: 'c'}] to {a: 'a'}
        if (state === 'LOOP') {
            setDataContext();
        }

        // Handle IF, ELSE, EACH, or DONE
        // These methods change state of rendering
        handleStateActions();

        // Exit if condition is not met
        if ((state === 'CONDITIONAL' && !getLastFrom(conditionals)) || (state === 'LOOP' && !execData)) {
            handleCommand.call(this, this._queue[++execIndex], execData);
            return;
        }

        // Handle CREATE, APPEND, STYLE, ATTR, TEXT
        // These methods are purely rendering and do not change rendering state
        handleCommonActions();

        // Increment index for next execution
        execIndex++;

        // Execute next command
        handleCommand.call(this, this._queue[execIndex], execData);
        
        function setDataContext() {
            loop = getLastFrom(loops);
            execData = loop.data[loop.index];
        }

        function handleStateActions() {
            if (command.action === 'loop') {
                handleLoop();
            }

            if (command.action === 'done') {
                handleDone();
            }
            
            if (command.action === 'if') {
                handleIf();
            }

            if (command.action === 'else') {
                handleElse();
            }
        }

        function handleLoop() {
            states.push('LOOP');
            loops.push({
                data: evaluate(execData, command.detail[0]),
                index: 0,
                start: execIndex
            });
        }

        function handleDone() {
            states.pop();
            if (state === 'CONDITIONAL') {
                conditionals.pop();
            } else if (state === 'LOOP') {
                loop = getLastFrom(loops);
                loop.index = loop.index + 1;
                // If current loop is not done, set state back to loop
                // and set next execution at start of loop
                if (loop.index < loop.data.length) {
                    execIndex = loop.start;
                    states.push('LOOP');
                } else {
                    loops.pop();
                }
            }
        }

        function handleIf() {
            states.push('CONDITIONAL');
            condition = evaluate(execData, command.detail[0]);
            conditionals.push(condition);
        }

        function handleElse() {
            condition = !conditionals.pop();
            conditionals.push(condition);
        }

        function handleCommonActions() {
            switch (command.action) {
                case 'openTag':
                    elements.push(createTag.apply(null, command.detail));
                    break;
                case 'addClass':
                    el = getLastFrom(elements);
                    addClass.apply(el, [evaluate(execData, command.detail[0])]);
                    break;
                case 'style':
                    el = getLastFrom(elements);
                    addStyle.apply(el, [evaluate(execData, command.detail[0]), evaluate(execData, command.detail[1])]);
                    break;
                case 'attribute':
                    el = getLastFrom(elements);
                    addAttribute.apply(el, [evaluate(execData, command.detail[0]), evaluate(execData, command.detail[1])]);
                    break;
                case 'data':
                    el = getLastFrom(elements);
                    patchElement.apply(el, [evaluate(execData, command.detail[0])]);
                    break;
                case 'text':
                    el = getLastFrom(elements);
                    addText.apply(el, [evaluate(execData, command.detail[0])]);
                    break;
                case 'closeTag':
                    el = elements.pop();
                    if (elements.length === 0) {
                        root.appendChild(el);
                    } else {
                        getLastFrom(elements).appendChild(el);
                    }
                    break;
            }
        }
    }
};

//////////////////////////////////////////////////////
/////////////////////// Patch ////////////////////////
//////////////////////////////////////////////////////

Template.prototype.patch = function(root, data) {
    var frag = this.render(data);

    _patch(root, frag);

    function _patch(from, to) {
        var fromNode, toNode;
        var length = Math.max(from.childNodes.length, to.childNodes.length);

        for (var i = 0; i < length; i++) {
            fromNode = from.childNodes[i];
            toNode   = to.childNodes[i];

            if (!toNode && fromNode) {
                removeAllAfter(from, i);
                return;
            } else if (!fromNode && toNode) {
                from.appendChild(toNode.cloneNode(true));
            } else if (fromNode.tagName !== toNode.tagName) {
                from.replaceChild(toNode.cloneNode(true), fromNode);
            } else {
                patchNode(fromNode, toNode);
                _patch(fromNode, toNode);
            }
        }
    }

    function removeAllAfter(node, index) {
        for (var i = node.childNodes.length - 1; i >= index; i--) {
            node.childNodes[i].remove();
        }
    }

    function patchNode(from, to) {
        patchClass(from, to);
        patchStyle(from, to);
        patchAttributes(from, to);
        patchText(from, to);
        patchShadowRoot(from, to);
    }

    function patchClass(from, to) {
        var map;
        var toClasses   = to && to.className ? to.className.split(' ') : [];
        var fromClasses = from && from.className ? from.className.split(' ') : [];
        
        map = toClasses.reduce(function(accumulator, cls) {
            if (cls === '') {
                return accumulator;
            }
            addClass.call(from, cls);
            accumulator[cls] = cls;
            return accumulator;
        }, {});

        fromClasses.forEach(function(cls) {
            if (!map[cls]) {
                removeClass.call(from, cls);
            }
        });
    }

    function patchText(from, to) {
        if (from.textContent !== to.textContent) {
            from.textContent = to.textContent;
        }
    }

    function patchStyle(from, to) {
        var map = {};
        var styleKey, styleVal, fromKeys;

        if (to.style) {
            for (var i = 0; i < to.style.length; i++) {
                styleKey = to.style[i];
                styleVal = to.style[to.style[i]];
                addStyle.call(from, styleKey, styleVal);
                map[styleKey] = styleVal;
            }
        }

        if (from.style) {
            fromKeys = Array.prototype.slice.call(from.style);
            for (var j = 0; j < fromKeys.length; j++) {
                styleKey = fromKeys[j];
                if (!map[styleKey]) {
                    addStyle.call(from, styleKey, '');
                }
            }
        }
    }

    function patchAttributes(from, to) {
        var map = {};
        var attr, attrKey, attrVal, fromKeys;

        if (to.attributes) {
            for (var i = 0; i < to.attributes.length; i++) {
                attr = to.attributes[i];
                attrKey = attr.name;
                if (attrKey !== 'style' && attrKey !== 'class') {
                    from.setAttribute(attrKey, attr.value);
                    map[attrKey] = attr.value;                 
                }
            }
        }

        if (from.attributes) {
            fromKeys = Array.prototype.slice.call(from.attributes);
            for (var j = 0; j < fromKeys.length; j++) {
                attr = fromKeys[j];
                attrKey = attr.name;
                if (attrKey !== 'style' && attrKey !== 'class') {
                    if (!map[attrKey]) {
                        from.setAttribute(attrKey, '');
                    }
                }
            }
        }
    }

    function patchShadowRoot(from, to) {
        if(from.shadowRoot && to.shadowRoot) {
            _patch(from.shadowRoot, to.shadowRoot);
        }
    }

};

//////////////////////////////////////////////////////
/////////////////// Helper Methods ///////////////////
//////////////////////////////////////////////////////

function createTag(tag) {
    var tagName = parseTag(tag);
    var el      = document.createElement(tagName[0]);

    if (tagName[1] === '.') {
        el.className = tagName[2];
    } else if (tagName[1] === '#') {
        el.id = tagName[2];
    }

    return el;
}

function addClass(className) {
    var separator = this.className.length > 0 ? ' ' : '';
    className = typeof className === 'string' ? className : '';

    if (!hasClass(this, className)) {
        this.className += separator + className;
    }
}

function removeClass(className) {
    if (hasClass(this, className)) {
        var old = this.className;
        var out = old.replace(new RegExp('(\\s|^)' + className + '(\\s|$)'), ' ');
        this.className = out;
    }
}

function addStyle(attr, val) {
    if (this.style[attr] !== val) {
        this.style[attr] = val;
    }
}

function addAttribute(attr, val) {
    this.setAttribute(attr, typeof val === 'undefined' ? '' : val);
}

function addText(content) {
    this.textContent = content;
}

function patchElement(data) {
    this.patch(data);
}

function getLastFrom(array) {
    return array[array.length - 1];
}

function hasClass(el, className) {
  return !!el.className.match(new RegExp('(\\s|^)'+className+'(\\s|$)'));
}

function parseTag(tag) {
    tag = tag.replace(/[.#]/, function(d) { return ',' + d + ',';})
             .split(',');
    return tag;
}

function isCustomElement(tag) {
    return !!tag.match('-');
}

function evaluate(data, funcOrVal) {
    switch (typeof funcOrVal) {
        case 'function':
            try {
                return funcOrVal.call(this, data);
            } catch (e) {
                return '';
            }
            break;
        default:
            return funcOrVal;

    }
}

var Trio = {
    Factory: Factory,
    Service: Service,
    Component: ComponentManager,
    Vow: Vow,
    AJAX: {
        interceptAllRequest: function(cb) {
            GLOBAL_AJAX_REQUEST_INTERCEPT = cb;
        },
        interceptAllResponse: function(cb) {
            GLOBAL_AJAX_RESPONSE_INTERCEPT = cb;
        }
    },
    Stylizer: new Stylizer(),
    Renderer: new Renderer(),
    Module: new Module(),
    Resource: new ResourceManager(),
    VERSION: '0.1.2'
};

if (module && module.exports) {
    module.exports = Trio;
} else {
    window.Trio = Trio;
}

})();


},{}],2:[function(require,module,exports){
window.Trio = require('trio');
},{"trio":1}]},{},[2])
//# sourceMappingURL=data:application/json;charset:utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyaWZ5L25vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCIvc291cmNlL2FqYXguanMiLCIvc291cmNlL2RlZmF1bHRzLmpzIiwiL3NvdXJjZS9leHRlbmQuanMiLCIvc291cmNlL2lkR2VuZXJhdG9yLmpzIiwiL3NvdXJjZS93ZWJjb21wb25lbnRzLmpzIiwiL3NvdXJjZS92b3cuanMiLCIvc291cmNlL3NpZ25hbC5qcyIsIi9zb3VyY2UvZmFjdG9yeS5qcyIsIi9zb3VyY2Uvc2VydmljZS5qcyIsIi9zb3VyY2UvY29tcG9uZW50LmpzIiwiL3NvdXJjZS9zdHlsaXplci5qcyIsIi9zb3VyY2UvbW9kdWxlLmpzIiwiL3NvdXJjZS9yZXNvdXJjZS5qcyIsIi9zb3VyY2UvcmVuZGVyZXIuanMiLCIvc291cmNlL2luZGV4LmpzIiwiY2xpZW50L3NyYy9saWIuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ25EQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDVkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdENBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDVEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2JBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDekpBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDdklBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2hDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN6Q0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0SkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUM1TUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN2RkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ2xMQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQzNaQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7O0FDekJBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsInZhciBHTE9CQUxfQUpBWF9SRVFVRVNUX0lOVEVSQ0VQVCA9IGZ1bmN0aW9uKHJlcSkgeyBcbiAgICByZXR1cm4gcmVxO1xufTtcbnZhciBHTE9CQUxfQUpBWF9SRVNQT05TRV9JTlRFUkNFUFQgPSBmdW5jdGlvbihyZXMpIHtcbiAgICByZXR1cm4gcmVzO1xufTtcblxudmFyIEFqYXggPSBmdW5jdGlvbihvcHRzKSB7XG4gICAgdmFyIHhociAgICAgICAgPSBuZXcgWE1MSHR0cFJlcXVlc3QoKTtcbiAgICB4aHIub25sb2FkICA9IGZ1bmN0aW9uKCkge1xuICAgICAgICB2YXIgcmVzcG9uc2UgPSBHTE9CQUxfQUpBWF9SRVNQT05TRV9JTlRFUkNFUFQoeGhyKTtcbiAgICAgICAgb3B0cy5vbmxvYWQocmVzcG9uc2UpO1xuICAgIH07XG5cbiAgICB0aGlzLnVybCAgICAgPSBvcHRzLnVybDtcbiAgICB0aGlzLnR5cGUgICAgPSBvcHRzLnR5cGUudG9VcHBlckNhc2UoKTtcbiAgICB0aGlzLmhlYWRlcnMgPSB7fTtcbiAgICB0aGlzLnhociAgICAgPSB4aHI7XG4gICAgR0xPQkFMX0FKQVhfUkVRVUVTVF9JTlRFUkNFUFQodGhpcyk7XG59O1xuXG5BamF4LnByb3RvdHlwZS5zZXRVcmwgPSBmdW5jdGlvbih1cmwpIHtcbiAgICBpZiAoIXVybCkgdGhyb3cgbmV3IEVycm9yKCdFeHBlY3QgcGFyYW1ldGVyOiB1cmwuJyk7XG4gICAgdGhpcy51cmwgPSB1cmw7XG59O1xuXG5BamF4LnByb3RvdHlwZS5zZXRUeXBlID0gZnVuY3Rpb24odHlwZSkge1xuICAgIGlmICghdHlwZSkgdGhyb3cgbmV3IEVycm9yKCdFeHBlY3QgcGFyYW1ldGVyOiB0eXBlLicpO1xuICAgIHRoaXMudHlwZSA9IHR5cGUudG9VcHBlckNhc2UoKTtcbn07XG5cbkFqYXgucHJvdG90eXBlLnNldEhlYWRlciA9IGZ1bmN0aW9uKGtleSwgdmFsdWUpIHtcbiAgICB0aGlzLmhlYWRlcnNba2V5XSA9IHZhbHVlO1xufTtcblxuQWpheC5wcm90b3R5cGUuc2VuZCA9IGZ1bmN0aW9uKHBheWxvYWQpIHtcbiAgICBpZiAoIXRoaXMudXJsKSB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdCByZXF1ZXN0IHRvIGNvbnRhaW4gcHJvcGVydHk6IHVybC4nKTtcbiAgICBpZiAoIXRoaXMudHlwZSkgdGhyb3cgbmV3IEVycm9yKCdFeHBlY3QgcmVxdWVzdCB0byBjb250YWluIHByb3BlcnR5OiB0eXBlLicpO1xuXG4gICAgdGhpcy54aHIub3Blbih0aGlzLnR5cGUsIHRoaXMudXJsKTtcblxuICAgIGZvciAodmFyIGhlYWRlciBpbiB0aGlzLmhlYWRlcnMpIHtcbiAgICAgICAgdGhpcy54aHIuc2V0UmVxdWVzdEhlYWRlcihoZWFkZXIsIHRoaXMuaGVhZGVyc1toZWFkZXJdKTtcbiAgICB9XG5cbiAgICBpZiAocGF5bG9hZCkge1xuICAgICAgICB0aGlzLnhoci5zZW5kKHBheWxvYWQpO1xuICAgIH0gZWxzZSB7XG4gICAgICAgIHRoaXMueGhyLnNlbmQoKTtcbiAgICB9XG59O1xuIiwiZnVuY3Rpb24gZGVmYXVsdHMob2JqLCBkZWYpIHtcbiAgICBkZWYgPSBkZWYgfHwge307XG4gICAgXG4gICAgZm9yICh2YXIga2V5IGluIGRlZikge1xuICAgICAgICBpZiAoIW9ialtrZXldKSB7XG4gICAgICAgICAgICBvYmpba2V5XSA9IGRlZltrZXldO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcmV0dXJuIG9iajtcbn0iLCJmdW5jdGlvbiBleHRlbmQobWV0aG9kcykge1xuICAgIHZhciBwYXJlbnQgPSB0aGlzLl9jb25zdHJ1Y3RvcjtcblxuICAgIGlmICghcGFyZW50KSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICB2YXIgc3RhdGljQXR0ciA9IHt9O1xuICAgIHZhciBjaGlsZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBmb3IgKHZhciBrZXkgaW4gc3RhdGljQXR0cikge1xuICAgICAgICAgICAgdGhpc1trZXldID0gc3RhdGljQXR0cltrZXldO1xuICAgICAgICB9XG4gICAgICAgIHBhcmVudC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgIH07XG4gICAgXG4gICAgdmFyIGV4dGVuZGVkID0ge307XG5cbiAgICBmb3IgKHZhciBwcm9wIGluIHBhcmVudC5wcm90b3R5cGUpIHtcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChwYXJlbnQucHJvdG90eXBlLCBwcm9wKSkge1xuICAgICAgICAgICAgZXh0ZW5kZWRbcHJvcF0gPSBwYXJlbnQucHJvdG90eXBlW3Byb3BdO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZm9yICh2YXIgbWV0IGluIG1ldGhvZHMpIHtcbiAgICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChtZXRob2RzLCBtZXQpKSB7XG4gICAgICAgICAgICB2YXIgbWV0aG9kID0gbWV0aG9kc1ttZXRdO1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBtZXRob2QgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBleHRlbmRlZFttZXRdID0gbWV0aG9kc1ttZXRdO1xuICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICBzdGF0aWNBdHRyW21ldF0gPSBtZXRob2RzW21ldF07XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBjaGlsZC5wcm90b3R5cGUgPSBPYmplY3QuY3JlYXRlKGV4dGVuZGVkKTtcblxuICAgIHJldHVybiBjaGlsZDtcbn1cbiIsImZ1bmN0aW9uIGlkR2VuZXJhdG9yKHN0cikge1xuICAgIHZhciBjb3VudCA9IDE7XG5cbiAgICByZXR1cm4gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBpZCA9IHN0ciArIGNvdW50O1xuICAgICAgICBjb3VudCsrO1xuICAgICAgICByZXR1cm4gaWQ7XG4gICAgfTtcbn1cbiIsIi8qKlxuICogQGxpY2Vuc2VcbiAqIENvcHlyaWdodCAoYykgMjAxNCBUaGUgUG9seW1lciBQcm9qZWN0IEF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBUaGlzIGNvZGUgbWF5IG9ubHkgYmUgdXNlZCB1bmRlciB0aGUgQlNEIHN0eWxlIGxpY2Vuc2UgZm91bmQgYXQgaHR0cDovL3BvbHltZXIuZ2l0aHViLmlvL0xJQ0VOU0UudHh0XG4gKiBUaGUgY29tcGxldGUgc2V0IG9mIGF1dGhvcnMgbWF5IGJlIGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9BVVRIT1JTLnR4dFxuICogVGhlIGNvbXBsZXRlIHNldCBvZiBjb250cmlidXRvcnMgbWF5IGJlIGZvdW5kIGF0IGh0dHA6Ly9wb2x5bWVyLmdpdGh1Yi5pby9DT05UUklCVVRPUlMudHh0XG4gKiBDb2RlIGRpc3RyaWJ1dGVkIGJ5IEdvb2dsZSBhcyBwYXJ0IG9mIHRoZSBwb2x5bWVyIHByb2plY3QgaXMgYWxzb1xuICogc3ViamVjdCB0byBhbiBhZGRpdGlvbmFsIElQIHJpZ2h0cyBncmFudCBmb3VuZCBhdCBodHRwOi8vcG9seW1lci5naXRodWIuaW8vUEFURU5UUy50eHRcbiAqL1xuLy8gQHZlcnNpb24gMC43LjEyLTg2YTA0MWJcbndpbmRvdy5XZWJDb21wb25lbnRzPXdpbmRvdy5XZWJDb21wb25lbnRzfHx7fSxmdW5jdGlvbihlKXt2YXIgdD1lLmZsYWdzfHx7fSxuPVwid2ViY29tcG9uZW50cy5qc1wiLHI9ZG9jdW1lbnQucXVlcnlTZWxlY3Rvcignc2NyaXB0W3NyYyo9XCInK24rJ1wiXScpO2lmKCF0Lm5vT3B0cyl7aWYobG9jYXRpb24uc2VhcmNoLnNsaWNlKDEpLnNwbGl0KFwiJlwiKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3ZhciBuLHI9ZS5zcGxpdChcIj1cIik7clswXSYmKG49clswXS5tYXRjaCgvd2MtKC4rKS8pKSYmKHRbblsxXV09clsxXXx8ITApfSkscilmb3IodmFyIG8saT0wO289ci5hdHRyaWJ1dGVzW2ldO2krKylcInNyY1wiIT09by5uYW1lJiYodFtvLm5hbWVdPW8udmFsdWV8fCEwKTtpZih0LmxvZyYmdC5sb2cuc3BsaXQpe3ZhciBhPXQubG9nLnNwbGl0KFwiLFwiKTt0LmxvZz17fSxhLmZvckVhY2goZnVuY3Rpb24oZSl7dC5sb2dbZV09ITB9KX1lbHNlIHQubG9nPXt9fXQuc2hhZG93PXQuc2hhZG93fHx0LnNoYWRvd2RvbXx8dC5wb2x5ZmlsbCxcIm5hdGl2ZVwiPT09dC5zaGFkb3c/dC5zaGFkb3c9ITE6dC5zaGFkb3c9dC5zaGFkb3d8fCFIVE1MRWxlbWVudC5wcm90b3R5cGUuY3JlYXRlU2hhZG93Um9vdCx0LnJlZ2lzdGVyJiYod2luZG93LkN1c3RvbUVsZW1lbnRzPXdpbmRvdy5DdXN0b21FbGVtZW50c3x8e2ZsYWdzOnt9fSx3aW5kb3cuQ3VzdG9tRWxlbWVudHMuZmxhZ3MucmVnaXN0ZXI9dC5yZWdpc3RlciksZS5mbGFncz10fShXZWJDb21wb25lbnRzKSxXZWJDb21wb25lbnRzLmZsYWdzLnNoYWRvdyYmKFwidW5kZWZpbmVkXCI9PXR5cGVvZiBXZWFrTWFwJiYhZnVuY3Rpb24oKXt2YXIgZT1PYmplY3QuZGVmaW5lUHJvcGVydHksdD1EYXRlLm5vdygpJTFlOSxuPWZ1bmN0aW9uKCl7dGhpcy5uYW1lPVwiX19zdFwiKygxZTkqTWF0aC5yYW5kb20oKT4+PjApKyh0KysgK1wiX19cIil9O24ucHJvdG90eXBlPXtzZXQ6ZnVuY3Rpb24odCxuKXt2YXIgcj10W3RoaXMubmFtZV07cmV0dXJuIHImJnJbMF09PT10P3JbMV09bjplKHQsdGhpcy5uYW1lLHt2YWx1ZTpbdCxuXSx3cml0YWJsZTohMH0pLHRoaXN9LGdldDpmdW5jdGlvbihlKXt2YXIgdDtyZXR1cm4odD1lW3RoaXMubmFtZV0pJiZ0WzBdPT09ZT90WzFdOnZvaWQgMH0sXCJkZWxldGVcIjpmdW5jdGlvbihlKXt2YXIgdD1lW3RoaXMubmFtZV07cmV0dXJuIHQmJnRbMF09PT1lPyh0WzBdPXRbMV09dm9pZCAwLCEwKTohMX0saGFzOmZ1bmN0aW9uKGUpe3ZhciB0PWVbdGhpcy5uYW1lXTtyZXR1cm4gdD90WzBdPT09ZTohMX19LHdpbmRvdy5XZWFrTWFwPW59KCksd2luZG93LlNoYWRvd0RPTVBvbHlmaWxsPXt9LGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHQoKXtpZihcInVuZGVmaW5lZFwiIT10eXBlb2YgY2hyb21lJiZjaHJvbWUuYXBwJiZjaHJvbWUuYXBwLnJ1bnRpbWUpcmV0dXJuITE7aWYobmF2aWdhdG9yLmdldERldmljZVN0b3JhZ2UpcmV0dXJuITE7dHJ5e3ZhciBlPW5ldyBGdW5jdGlvbihcInJldHVybiB0cnVlO1wiKTtyZXR1cm4gZSgpfWNhdGNoKHQpe3JldHVybiExfX1mdW5jdGlvbiBuKGUpe2lmKCFlKXRocm93IG5ldyBFcnJvcihcIkFzc2VydGlvbiBmYWlsZWRcIil9ZnVuY3Rpb24gcihlLHQpe2Zvcih2YXIgbj1XKHQpLHI9MDtyPG4ubGVuZ3RoO3IrKyl7dmFyIG89bltyXTtBKGUsbyxGKHQsbykpfXJldHVybiBlfWZ1bmN0aW9uIG8oZSx0KXtmb3IodmFyIG49Vyh0KSxyPTA7cjxuLmxlbmd0aDtyKyspe3ZhciBvPW5bcl07c3dpdGNoKG8pe2Nhc2VcImFyZ3VtZW50c1wiOmNhc2VcImNhbGxlclwiOmNhc2VcImxlbmd0aFwiOmNhc2VcIm5hbWVcIjpjYXNlXCJwcm90b3R5cGVcIjpjYXNlXCJ0b1N0cmluZ1wiOmNvbnRpbnVlfUEoZSxvLEYodCxvKSl9cmV0dXJuIGV9ZnVuY3Rpb24gaShlLHQpe2Zvcih2YXIgbj0wO248dC5sZW5ndGg7bisrKWlmKHRbbl1pbiBlKXJldHVybiB0W25dfWZ1bmN0aW9uIGEoZSx0LG4pe1UudmFsdWU9bixBKGUsdCxVKX1mdW5jdGlvbiBzKGUsdCl7dmFyIG49ZS5fX3Byb3RvX198fE9iamVjdC5nZXRQcm90b3R5cGVPZihlKTtpZihxKXRyeXtXKG4pfWNhdGNoKHIpe249bi5fX3Byb3RvX199dmFyIG89Ui5nZXQobik7aWYobylyZXR1cm4gbzt2YXIgaT1zKG4pLGE9RShpKTtyZXR1cm4gZyhuLGEsdCksYX1mdW5jdGlvbiBjKGUsdCl7dyhlLHQsITApfWZ1bmN0aW9uIGwoZSx0KXt3KHQsZSwhMSl9ZnVuY3Rpb24gdShlKXtyZXR1cm4vXm9uW2Etel0rJC8udGVzdChlKX1mdW5jdGlvbiBkKGUpe3JldHVybi9eW2EtekEtWl8kXVthLXpBLVpfJDAtOV0qJC8udGVzdChlKX1mdW5jdGlvbiBwKGUpe3JldHVybiBrJiZkKGUpP25ldyBGdW5jdGlvbihcInJldHVybiB0aGlzLl9faW1wbDRjZjFlNzgyaGdfXy5cIitlKTpmdW5jdGlvbigpe3JldHVybiB0aGlzLl9faW1wbDRjZjFlNzgyaGdfX1tlXX19ZnVuY3Rpb24gaChlKXtyZXR1cm4gayYmZChlKT9uZXcgRnVuY3Rpb24oXCJ2XCIsXCJ0aGlzLl9faW1wbDRjZjFlNzgyaGdfXy5cIitlK1wiID0gdlwiKTpmdW5jdGlvbih0KXt0aGlzLl9faW1wbDRjZjFlNzgyaGdfX1tlXT10fX1mdW5jdGlvbiBmKGUpe3JldHVybiBrJiZkKGUpP25ldyBGdW5jdGlvbihcInJldHVybiB0aGlzLl9faW1wbDRjZjFlNzgyaGdfXy5cIitlK1wiLmFwcGx5KHRoaXMuX19pbXBsNGNmMWU3ODJoZ19fLCBhcmd1bWVudHMpXCIpOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuX19pbXBsNGNmMWU3ODJoZ19fW2VdLmFwcGx5KHRoaXMuX19pbXBsNGNmMWU3ODJoZ19fLGFyZ3VtZW50cyl9fWZ1bmN0aW9uIG0oZSx0KXt0cnl7cmV0dXJuIE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoZSx0KX1jYXRjaChuKXtyZXR1cm4gQn19ZnVuY3Rpb24gdyh0LG4scixvKXtmb3IodmFyIGk9Vyh0KSxhPTA7YTxpLmxlbmd0aDthKyspe3ZhciBzPWlbYV07aWYoXCJwb2x5bWVyQmxhY2tMaXN0X1wiIT09cyYmIShzIGluIG58fHQucG9seW1lckJsYWNrTGlzdF8mJnQucG9seW1lckJsYWNrTGlzdF9bc10pKXtxJiZ0Ll9fbG9va3VwR2V0dGVyX18ocyk7dmFyIGMsbCxkPW0odCxzKTtpZihcImZ1bmN0aW9uXCIhPXR5cGVvZiBkLnZhbHVlKXt2YXIgdz11KHMpO2M9dz9lLmdldEV2ZW50SGFuZGxlckdldHRlcihzKTpwKHMpLChkLndyaXRhYmxlfHxkLnNldHx8VikmJihsPXc/ZS5nZXRFdmVudEhhbmRsZXJTZXR0ZXIocyk6aChzKSk7dmFyIHY9Vnx8ZC5jb25maWd1cmFibGU7QShuLHMse2dldDpjLHNldDpsLGNvbmZpZ3VyYWJsZTp2LGVudW1lcmFibGU6ZC5lbnVtZXJhYmxlfSl9ZWxzZSByJiYobltzXT1mKHMpKX19fWZ1bmN0aW9uIHYoZSx0LG4pe2lmKG51bGwhPWUpe3ZhciByPWUucHJvdG90eXBlO2cocix0LG4pLG8odCxlKX19ZnVuY3Rpb24gZyhlLHQscil7dmFyIG89dC5wcm90b3R5cGU7bih2b2lkIDA9PT1SLmdldChlKSksUi5zZXQoZSx0KSxJLnNldChvLGUpLGMoZSxvKSxyJiZsKG8sciksYShvLFwiY29uc3RydWN0b3JcIix0KSx0LnByb3RvdHlwZT1vfWZ1bmN0aW9uIGIoZSx0KXtyZXR1cm4gUi5nZXQodC5wcm90b3R5cGUpPT09ZX1mdW5jdGlvbiB5KGUpe3ZhciB0PU9iamVjdC5nZXRQcm90b3R5cGVPZihlKSxuPXModCkscj1FKG4pO3JldHVybiBnKHQscixlKSxyfWZ1bmN0aW9uIEUoZSl7ZnVuY3Rpb24gdCh0KXtlLmNhbGwodGhpcyx0KX12YXIgbj1PYmplY3QuY3JlYXRlKGUucHJvdG90eXBlKTtyZXR1cm4gbi5jb25zdHJ1Y3Rvcj10LHQucHJvdG90eXBlPW4sdH1mdW5jdGlvbiBfKGUpe3JldHVybiBlJiZlLl9faW1wbDRjZjFlNzgyaGdfX31mdW5jdGlvbiBTKGUpe3JldHVybiFfKGUpfWZ1bmN0aW9uIFQoZSl7aWYobnVsbD09PWUpcmV0dXJuIG51bGw7bihTKGUpKTt2YXIgdD1lLl9fd3JhcHBlcjhlM2RkOTNhNjBfXztyZXR1cm4gbnVsbCE9dD90OmUuX193cmFwcGVyOGUzZGQ5M2E2MF9fPW5ldyhzKGUsZSkpKGUpfWZ1bmN0aW9uIE0oZSl7cmV0dXJuIG51bGw9PT1lP251bGw6KG4oXyhlKSksZS5fX2ltcGw0Y2YxZTc4MmhnX18pfWZ1bmN0aW9uIE8oZSl7cmV0dXJuIGUuX19pbXBsNGNmMWU3ODJoZ19ffWZ1bmN0aW9uIEwoZSx0KXt0Ll9faW1wbDRjZjFlNzgyaGdfXz1lLGUuX193cmFwcGVyOGUzZGQ5M2E2MF9fPXR9ZnVuY3Rpb24gTihlKXtyZXR1cm4gZSYmXyhlKT9NKGUpOmV9ZnVuY3Rpb24gQyhlKXtyZXR1cm4gZSYmIV8oZSk/VChlKTplfWZ1bmN0aW9uIGooZSx0KXtudWxsIT09dCYmKG4oUyhlKSksbih2b2lkIDA9PT10fHxfKHQpKSxlLl9fd3JhcHBlcjhlM2RkOTNhNjBfXz10KX1mdW5jdGlvbiBEKGUsdCxuKXtHLmdldD1uLEEoZS5wcm90b3R5cGUsdCxHKX1mdW5jdGlvbiBIKGUsdCl7RChlLHQsZnVuY3Rpb24oKXtyZXR1cm4gVCh0aGlzLl9faW1wbDRjZjFlNzgyaGdfX1t0XSl9KX1mdW5jdGlvbiB4KGUsdCl7ZS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3QuZm9yRWFjaChmdW5jdGlvbih0KXtlLnByb3RvdHlwZVt0XT1mdW5jdGlvbigpe3ZhciBlPUModGhpcyk7cmV0dXJuIGVbdF0uYXBwbHkoZSxhcmd1bWVudHMpfX0pfSl9dmFyIFI9bmV3IFdlYWtNYXAsST1uZXcgV2Vha01hcCxQPU9iamVjdC5jcmVhdGUobnVsbCksaz10KCksQT1PYmplY3QuZGVmaW5lUHJvcGVydHksVz1PYmplY3QuZ2V0T3duUHJvcGVydHlOYW1lcyxGPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IsVT17dmFsdWU6dm9pZCAwLGNvbmZpZ3VyYWJsZTohMCxlbnVtZXJhYmxlOiExLHdyaXRhYmxlOiEwfTtXKHdpbmRvdyk7dmFyIHE9L0ZpcmVmb3gvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksQj17Z2V0OmZ1bmN0aW9uKCl7fSxzZXQ6ZnVuY3Rpb24oZSl7fSxjb25maWd1cmFibGU6ITAsZW51bWVyYWJsZTohMH0sVj1mdW5jdGlvbigpe3ZhciBlPU9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IoTm9kZS5wcm90b3R5cGUsXCJub2RlVHlwZVwiKTtyZXR1cm4gZSYmIWUuZ2V0JiYhZS5zZXR9KCksRz17Z2V0OnZvaWQgMCxjb25maWd1cmFibGU6ITAsZW51bWVyYWJsZTohMH07ZS5hc3NlcnQ9bixlLmNvbnN0cnVjdG9yVGFibGU9UixlLmRlZmluZUdldHRlcj1ELGUuZGVmaW5lV3JhcEdldHRlcj1ILGUuZm9yd2FyZE1ldGhvZHNUb1dyYXBwZXI9eCxlLmlzSWRlbnRpZmllck5hbWU9ZCxlLmlzV3JhcHBlcj1fLGUuaXNXcmFwcGVyRm9yPWIsZS5taXhpbj1yLGUubmF0aXZlUHJvdG90eXBlVGFibGU9SSxlLm9uZU9mPWksZS5yZWdpc3Rlck9iamVjdD15LGUucmVnaXN0ZXJXcmFwcGVyPXYsZS5yZXdyYXA9aixlLnNldFdyYXBwZXI9TCxlLnVuc2FmZVVud3JhcD1PLGUudW53cmFwPU0sZS51bndyYXBJZk5lZWRlZD1OLGUud3JhcD1ULGUud3JhcElmTmVlZGVkPUMsZS53cmFwcGVycz1QfSh3aW5kb3cuU2hhZG93RE9NUG9seWZpbGwpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHQoZSx0LG4pe3JldHVybntpbmRleDplLHJlbW92ZWQ6dCxhZGRlZENvdW50Om59fWZ1bmN0aW9uIG4oKXt9dmFyIHI9MCxvPTEsaT0yLGE9MztuLnByb3RvdHlwZT17Y2FsY0VkaXREaXN0YW5jZXM6ZnVuY3Rpb24oZSx0LG4scixvLGkpe2Zvcih2YXIgYT1pLW8rMSxzPW4tdCsxLGM9bmV3IEFycmF5KGEpLGw9MDthPmw7bCsrKWNbbF09bmV3IEFycmF5KHMpLGNbbF1bMF09bDtmb3IodmFyIHU9MDtzPnU7dSsrKWNbMF1bdV09dTtmb3IodmFyIGw9MTthPmw7bCsrKWZvcih2YXIgdT0xO3M+dTt1KyspaWYodGhpcy5lcXVhbHMoZVt0K3UtMV0scltvK2wtMV0pKWNbbF1bdV09Y1tsLTFdW3UtMV07ZWxzZXt2YXIgZD1jW2wtMV1bdV0rMSxwPWNbbF1bdS0xXSsxO2NbbF1bdV09cD5kP2Q6cH1yZXR1cm4gY30sc3BsaWNlT3BlcmF0aW9uc0Zyb21FZGl0RGlzdGFuY2VzOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1lLmxlbmd0aC0xLG49ZVswXS5sZW5ndGgtMSxzPWVbdF1bbl0sYz1bXTt0PjB8fG4+MDspaWYoMCE9dClpZigwIT1uKXt2YXIgbCx1PWVbdC0xXVtuLTFdLGQ9ZVt0LTFdW25dLHA9ZVt0XVtuLTFdO2w9cD5kP3U+ZD9kOnU6dT5wP3A6dSxsPT11Pyh1PT1zP2MucHVzaChyKTooYy5wdXNoKG8pLHM9dSksdC0tLG4tLSk6bD09ZD8oYy5wdXNoKGEpLHQtLSxzPWQpOihjLnB1c2goaSksbi0tLHM9cCl9ZWxzZSBjLnB1c2goYSksdC0tO2Vsc2UgYy5wdXNoKGkpLG4tLTtyZXR1cm4gYy5yZXZlcnNlKCksY30sY2FsY1NwbGljZXM6ZnVuY3Rpb24oZSxuLHMsYyxsLHUpe3ZhciBkPTAscD0wLGg9TWF0aC5taW4ocy1uLHUtbCk7aWYoMD09biYmMD09bCYmKGQ9dGhpcy5zaGFyZWRQcmVmaXgoZSxjLGgpKSxzPT1lLmxlbmd0aCYmdT09Yy5sZW5ndGgmJihwPXRoaXMuc2hhcmVkU3VmZml4KGUsYyxoLWQpKSxuKz1kLGwrPWQscy09cCx1LT1wLHMtbj09MCYmdS1sPT0wKXJldHVybltdO2lmKG49PXMpe2Zvcih2YXIgZj10KG4sW10sMCk7dT5sOylmLnJlbW92ZWQucHVzaChjW2wrK10pO3JldHVybltmXX1pZihsPT11KXJldHVyblt0KG4sW10scy1uKV07Zm9yKHZhciBtPXRoaXMuc3BsaWNlT3BlcmF0aW9uc0Zyb21FZGl0RGlzdGFuY2VzKHRoaXMuY2FsY0VkaXREaXN0YW5jZXMoZSxuLHMsYyxsLHUpKSxmPXZvaWQgMCx3PVtdLHY9bixnPWwsYj0wO2I8bS5sZW5ndGg7YisrKXN3aXRjaChtW2JdKXtjYXNlIHI6ZiYmKHcucHVzaChmKSxmPXZvaWQgMCksdisrLGcrKzticmVhaztjYXNlIG86Znx8KGY9dCh2LFtdLDApKSxmLmFkZGVkQ291bnQrKyx2KyssZi5yZW1vdmVkLnB1c2goY1tnXSksZysrO2JyZWFrO2Nhc2UgaTpmfHwoZj10KHYsW10sMCkpLGYuYWRkZWRDb3VudCsrLHYrKzticmVhaztjYXNlIGE6Znx8KGY9dCh2LFtdLDApKSxmLnJlbW92ZWQucHVzaChjW2ddKSxnKyt9cmV0dXJuIGYmJncucHVzaChmKSx3fSxzaGFyZWRQcmVmaXg6ZnVuY3Rpb24oZSx0LG4pe2Zvcih2YXIgcj0wO24+cjtyKyspaWYoIXRoaXMuZXF1YWxzKGVbcl0sdFtyXSkpcmV0dXJuIHI7cmV0dXJuIG59LHNoYXJlZFN1ZmZpeDpmdW5jdGlvbihlLHQsbil7Zm9yKHZhciByPWUubGVuZ3RoLG89dC5sZW5ndGgsaT0wO24+aSYmdGhpcy5lcXVhbHMoZVstLXJdLHRbLS1vXSk7KWkrKztyZXR1cm4gaX0sY2FsY3VsYXRlU3BsaWNlczpmdW5jdGlvbihlLHQpe3JldHVybiB0aGlzLmNhbGNTcGxpY2VzKGUsMCxlLmxlbmd0aCx0LDAsdC5sZW5ndGgpfSxlcXVhbHM6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZT09PXR9fSxlLkFycmF5U3BsaWNlPW59KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdCgpe2E9ITE7dmFyIGU9aS5zbGljZSgwKTtpPVtdO2Zvcih2YXIgdD0wO3Q8ZS5sZW5ndGg7dCsrKWVbdF0oKX1mdW5jdGlvbiBuKGUpe2kucHVzaChlKSxhfHwoYT0hMCxyKHQsMCkpfXZhciByLG89d2luZG93Lk11dGF0aW9uT2JzZXJ2ZXIsaT1bXSxhPSExO2lmKG8pe3ZhciBzPTEsYz1uZXcgbyh0KSxsPWRvY3VtZW50LmNyZWF0ZVRleHROb2RlKHMpO2Mub2JzZXJ2ZShsLHtjaGFyYWN0ZXJEYXRhOiEwfSkscj1mdW5jdGlvbigpe3M9KHMrMSklMixsLmRhdGE9c319ZWxzZSByPXdpbmRvdy5zZXRUaW1lb3V0O2Uuc2V0RW5kT2ZNaWNyb3Rhc2s9bn0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUpe2Uuc2NoZWR1bGVkX3x8KGUuc2NoZWR1bGVkXz0hMCxmLnB1c2goZSksbXx8KHUobiksbT0hMCkpfWZ1bmN0aW9uIG4oKXtmb3IobT0hMTtmLmxlbmd0aDspe3ZhciBlPWY7Zj1bXSxlLnNvcnQoZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS51aWRfLXQudWlkX30pO2Zvcih2YXIgdD0wO3Q8ZS5sZW5ndGg7dCsrKXt2YXIgbj1lW3RdO24uc2NoZWR1bGVkXz0hMTt2YXIgcj1uLnRha2VSZWNvcmRzKCk7aShuKSxyLmxlbmd0aCYmbi5jYWxsYmFja18ocixuKX19fWZ1bmN0aW9uIHIoZSx0KXt0aGlzLnR5cGU9ZSx0aGlzLnRhcmdldD10LHRoaXMuYWRkZWROb2Rlcz1uZXcgcC5Ob2RlTGlzdCx0aGlzLnJlbW92ZWROb2Rlcz1uZXcgcC5Ob2RlTGlzdCx0aGlzLnByZXZpb3VzU2libGluZz1udWxsLHRoaXMubmV4dFNpYmxpbmc9bnVsbCx0aGlzLmF0dHJpYnV0ZU5hbWU9bnVsbCx0aGlzLmF0dHJpYnV0ZU5hbWVzcGFjZT1udWxsLHRoaXMub2xkVmFsdWU9bnVsbH1mdW5jdGlvbiBvKGUsdCl7Zm9yKDtlO2U9ZS5wYXJlbnROb2RlKXt2YXIgbj1oLmdldChlKTtpZihuKWZvcih2YXIgcj0wO3I8bi5sZW5ndGg7cisrKXt2YXIgbz1uW3JdO28ub3B0aW9ucy5zdWJ0cmVlJiZvLmFkZFRyYW5zaWVudE9ic2VydmVyKHQpfX19ZnVuY3Rpb24gaShlKXtmb3IodmFyIHQ9MDt0PGUubm9kZXNfLmxlbmd0aDt0Kyspe3ZhciBuPWUubm9kZXNfW3RdLHI9aC5nZXQobik7aWYoIXIpcmV0dXJuO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXt2YXIgaT1yW29dO2kub2JzZXJ2ZXI9PT1lJiZpLnJlbW92ZVRyYW5zaWVudE9ic2VydmVycygpfX19ZnVuY3Rpb24gYShlLG4sbyl7Zm9yKHZhciBpPU9iamVjdC5jcmVhdGUobnVsbCksYT1PYmplY3QuY3JlYXRlKG51bGwpLHM9ZTtzO3M9cy5wYXJlbnROb2RlKXt2YXIgYz1oLmdldChzKTtpZihjKWZvcih2YXIgbD0wO2w8Yy5sZW5ndGg7bCsrKXt2YXIgdT1jW2xdLGQ9dS5vcHRpb25zO2lmKChzPT09ZXx8ZC5zdWJ0cmVlKSYmKFwiYXR0cmlidXRlc1wiIT09bnx8ZC5hdHRyaWJ1dGVzKSYmKFwiYXR0cmlidXRlc1wiIT09bnx8IWQuYXR0cmlidXRlRmlsdGVyfHxudWxsPT09by5uYW1lc3BhY2UmJi0xIT09ZC5hdHRyaWJ1dGVGaWx0ZXIuaW5kZXhPZihvLm5hbWUpKSYmKFwiY2hhcmFjdGVyRGF0YVwiIT09bnx8ZC5jaGFyYWN0ZXJEYXRhKSYmKFwiY2hpbGRMaXN0XCIhPT1ufHxkLmNoaWxkTGlzdCkpe3ZhciBwPXUub2JzZXJ2ZXI7aVtwLnVpZF9dPXAsKFwiYXR0cmlidXRlc1wiPT09biYmZC5hdHRyaWJ1dGVPbGRWYWx1ZXx8XCJjaGFyYWN0ZXJEYXRhXCI9PT1uJiZkLmNoYXJhY3RlckRhdGFPbGRWYWx1ZSkmJihhW3AudWlkX109by5vbGRWYWx1ZSl9fX1mb3IodmFyIGYgaW4gaSl7dmFyIHA9aVtmXSxtPW5ldyByKG4sZSk7XCJuYW1lXCJpbiBvJiZcIm5hbWVzcGFjZVwiaW4gbyYmKG0uYXR0cmlidXRlTmFtZT1vLm5hbWUsbS5hdHRyaWJ1dGVOYW1lc3BhY2U9by5uYW1lc3BhY2UpLG8uYWRkZWROb2RlcyYmKG0uYWRkZWROb2Rlcz1vLmFkZGVkTm9kZXMpLG8ucmVtb3ZlZE5vZGVzJiYobS5yZW1vdmVkTm9kZXM9by5yZW1vdmVkTm9kZXMpLG8ucHJldmlvdXNTaWJsaW5nJiYobS5wcmV2aW91c1NpYmxpbmc9by5wcmV2aW91c1NpYmxpbmcpLG8ubmV4dFNpYmxpbmcmJihtLm5leHRTaWJsaW5nPW8ubmV4dFNpYmxpbmcpLHZvaWQgMCE9PWFbZl0mJihtLm9sZFZhbHVlPWFbZl0pLHQocCkscC5yZWNvcmRzXy5wdXNoKG0pfX1mdW5jdGlvbiBzKGUpe2lmKHRoaXMuY2hpbGRMaXN0PSEhZS5jaGlsZExpc3QsdGhpcy5zdWJ0cmVlPSEhZS5zdWJ0cmVlLFwiYXR0cmlidXRlc1wiaW4gZXx8IShcImF0dHJpYnV0ZU9sZFZhbHVlXCJpbiBlfHxcImF0dHJpYnV0ZUZpbHRlclwiaW4gZSk/dGhpcy5hdHRyaWJ1dGVzPSEhZS5hdHRyaWJ1dGVzOnRoaXMuYXR0cmlidXRlcz0hMCxcImNoYXJhY3RlckRhdGFPbGRWYWx1ZVwiaW4gZSYmIShcImNoYXJhY3RlckRhdGFcImluIGUpP3RoaXMuY2hhcmFjdGVyRGF0YT0hMDp0aGlzLmNoYXJhY3RlckRhdGE9ISFlLmNoYXJhY3RlckRhdGEsIXRoaXMuYXR0cmlidXRlcyYmKGUuYXR0cmlidXRlT2xkVmFsdWV8fFwiYXR0cmlidXRlRmlsdGVyXCJpbiBlKXx8IXRoaXMuY2hhcmFjdGVyRGF0YSYmZS5jaGFyYWN0ZXJEYXRhT2xkVmFsdWUpdGhyb3cgbmV3IFR5cGVFcnJvcjtpZih0aGlzLmNoYXJhY3RlckRhdGE9ISFlLmNoYXJhY3RlckRhdGEsdGhpcy5hdHRyaWJ1dGVPbGRWYWx1ZT0hIWUuYXR0cmlidXRlT2xkVmFsdWUsdGhpcy5jaGFyYWN0ZXJEYXRhT2xkVmFsdWU9ISFlLmNoYXJhY3RlckRhdGFPbGRWYWx1ZSxcImF0dHJpYnV0ZUZpbHRlclwiaW4gZSl7aWYobnVsbD09ZS5hdHRyaWJ1dGVGaWx0ZXJ8fFwib2JqZWN0XCIhPXR5cGVvZiBlLmF0dHJpYnV0ZUZpbHRlcil0aHJvdyBuZXcgVHlwZUVycm9yO3RoaXMuYXR0cmlidXRlRmlsdGVyPXcuY2FsbChlLmF0dHJpYnV0ZUZpbHRlcil9ZWxzZSB0aGlzLmF0dHJpYnV0ZUZpbHRlcj1udWxsfWZ1bmN0aW9uIGMoZSl7dGhpcy5jYWxsYmFja189ZSx0aGlzLm5vZGVzXz1bXSx0aGlzLnJlY29yZHNfPVtdLHRoaXMudWlkXz0rK3YsdGhpcy5zY2hlZHVsZWRfPSExfWZ1bmN0aW9uIGwoZSx0LG4pe3RoaXMub2JzZXJ2ZXI9ZSx0aGlzLnRhcmdldD10LHRoaXMub3B0aW9ucz1uLHRoaXMudHJhbnNpZW50T2JzZXJ2ZWROb2Rlcz1bXX12YXIgdT1lLnNldEVuZE9mTWljcm90YXNrLGQ9ZS53cmFwSWZOZWVkZWQscD1lLndyYXBwZXJzLGg9bmV3IFdlYWtNYXAsZj1bXSxtPSExLHc9QXJyYXkucHJvdG90eXBlLnNsaWNlLHY9MDtjLnByb3RvdHlwZT17Y29uc3RydWN0b3I6YyxvYnNlcnZlOmZ1bmN0aW9uKGUsdCl7ZT1kKGUpO3ZhciBuLHI9bmV3IHModCksbz1oLmdldChlKTtvfHxoLnNldChlLG89W10pO2Zvcih2YXIgaT0wO2k8by5sZW5ndGg7aSsrKW9baV0ub2JzZXJ2ZXI9PT10aGlzJiYobj1vW2ldLG4ucmVtb3ZlVHJhbnNpZW50T2JzZXJ2ZXJzKCksbi5vcHRpb25zPXIpO258fChuPW5ldyBsKHRoaXMsZSxyKSxvLnB1c2gobiksdGhpcy5ub2Rlc18ucHVzaChlKSl9LGRpc2Nvbm5lY3Q6ZnVuY3Rpb24oKXt0aGlzLm5vZGVzXy5mb3JFYWNoKGZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1oLmdldChlKSxuPTA7bjx0Lmxlbmd0aDtuKyspe3ZhciByPXRbbl07aWYoci5vYnNlcnZlcj09PXRoaXMpe3Quc3BsaWNlKG4sMSk7YnJlYWt9fX0sdGhpcyksdGhpcy5yZWNvcmRzXz1bXX0sdGFrZVJlY29yZHM6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnJlY29yZHNfO3JldHVybiB0aGlzLnJlY29yZHNfPVtdLGV9fSxsLnByb3RvdHlwZT17YWRkVHJhbnNpZW50T2JzZXJ2ZXI6ZnVuY3Rpb24oZSl7aWYoZSE9PXRoaXMudGFyZ2V0KXt0KHRoaXMub2JzZXJ2ZXIpLHRoaXMudHJhbnNpZW50T2JzZXJ2ZWROb2Rlcy5wdXNoKGUpO3ZhciBuPWguZ2V0KGUpO258fGguc2V0KGUsbj1bXSksbi5wdXNoKHRoaXMpfX0scmVtb3ZlVHJhbnNpZW50T2JzZXJ2ZXJzOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy50cmFuc2llbnRPYnNlcnZlZE5vZGVzO3RoaXMudHJhbnNpZW50T2JzZXJ2ZWROb2Rlcz1bXTtmb3IodmFyIHQ9MDt0PGUubGVuZ3RoO3QrKylmb3IodmFyIG49ZVt0XSxyPWguZ2V0KG4pLG89MDtvPHIubGVuZ3RoO28rKylpZihyW29dPT09dGhpcyl7ci5zcGxpY2UobywxKTticmVha319fSxlLmVucXVldWVNdXRhdGlvbj1hLGUucmVnaXN0ZXJUcmFuc2llbnRPYnNlcnZlcnM9byxlLndyYXBwZXJzLk11dGF0aW9uT2JzZXJ2ZXI9YyxlLndyYXBwZXJzLk11dGF0aW9uUmVjb3JkPXJ9KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlLHQpe3RoaXMucm9vdD1lLHRoaXMucGFyZW50PXR9ZnVuY3Rpb24gbihlLHQpe2lmKGUudHJlZVNjb3BlXyE9PXQpe2UudHJlZVNjb3BlXz10O2Zvcih2YXIgcj1lLnNoYWRvd1Jvb3Q7cjtyPXIub2xkZXJTaGFkb3dSb290KXIudHJlZVNjb3BlXy5wYXJlbnQ9dDtmb3IodmFyIG89ZS5maXJzdENoaWxkO287bz1vLm5leHRTaWJsaW5nKW4obyx0KX19ZnVuY3Rpb24gcihuKXtpZihuIGluc3RhbmNlb2YgZS53cmFwcGVycy5XaW5kb3csbi50cmVlU2NvcGVfKXJldHVybiBuLnRyZWVTY29wZV87dmFyIG8saT1uLnBhcmVudE5vZGU7cmV0dXJuIG89aT9yKGkpOm5ldyB0KG4sbnVsbCksbi50cmVlU2NvcGVfPW99dC5wcm90b3R5cGU9e2dldCByZW5kZXJlcigpe3JldHVybiB0aGlzLnJvb3QgaW5zdGFuY2VvZiBlLndyYXBwZXJzLlNoYWRvd1Jvb3Q/ZS5nZXRSZW5kZXJlckZvckhvc3QodGhpcy5yb290Lmhvc3QpOm51bGx9LGNvbnRhaW5zOmZ1bmN0aW9uKGUpe2Zvcig7ZTtlPWUucGFyZW50KWlmKGU9PT10aGlzKXJldHVybiEwO3JldHVybiExfX0sZS5UcmVlU2NvcGU9dCxlLmdldFRyZWVTY29wZT1yLGUuc2V0VHJlZVNjb3BlPW59KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXtyZXR1cm4gZSBpbnN0YW5jZW9mIEcuU2hhZG93Um9vdH1mdW5jdGlvbiBuKGUpe3JldHVybiBBKGUpLnJvb3R9ZnVuY3Rpb24gcihlLHIpe3ZhciBzPVtdLGM9ZTtmb3Iocy5wdXNoKGMpO2M7KXt2YXIgbD1hKGMpO2lmKGwmJmwubGVuZ3RoPjApe2Zvcih2YXIgdT0wO3U8bC5sZW5ndGg7dSsrKXt2YXIgcD1sW3VdO2lmKGkocCkpe3ZhciBoPW4ocCksZj1oLm9sZGVyU2hhZG93Um9vdDtmJiZzLnB1c2goZil9cy5wdXNoKHApfWM9bFtsLmxlbmd0aC0xXX1lbHNlIGlmKHQoYykpe2lmKGQoZSxjKSYmbyhyKSlicmVhaztjPWMuaG9zdCxzLnB1c2goYyl9ZWxzZSBjPWMucGFyZW50Tm9kZSxjJiZzLnB1c2goYyl9cmV0dXJuIHN9ZnVuY3Rpb24gbyhlKXtpZighZSlyZXR1cm4hMTtzd2l0Y2goZS50eXBlKXtjYXNlXCJhYm9ydFwiOmNhc2VcImVycm9yXCI6Y2FzZVwic2VsZWN0XCI6Y2FzZVwiY2hhbmdlXCI6Y2FzZVwibG9hZFwiOmNhc2VcInJlc2V0XCI6Y2FzZVwicmVzaXplXCI6Y2FzZVwic2Nyb2xsXCI6Y2FzZVwic2VsZWN0c3RhcnRcIjpyZXR1cm4hMH1yZXR1cm4hMX1mdW5jdGlvbiBpKGUpe3JldHVybiBlIGluc3RhbmNlb2YgSFRNTFNoYWRvd0VsZW1lbnR9ZnVuY3Rpb24gYSh0KXtyZXR1cm4gZS5nZXREZXN0aW5hdGlvbkluc2VydGlvblBvaW50cyh0KX1mdW5jdGlvbiBzKGUsdCl7aWYoMD09PWUubGVuZ3RoKXJldHVybiB0O3QgaW5zdGFuY2VvZiBHLldpbmRvdyYmKHQ9dC5kb2N1bWVudCk7Zm9yKHZhciBuPUEodCkscj1lWzBdLG89QShyKSxpPWwobixvKSxhPTA7YTxlLmxlbmd0aDthKyspe3ZhciBzPWVbYV07aWYoQShzKT09PWkpcmV0dXJuIHN9cmV0dXJuIGVbZS5sZW5ndGgtMV19ZnVuY3Rpb24gYyhlKXtmb3IodmFyIHQ9W107ZTtlPWUucGFyZW50KXQucHVzaChlKTtyZXR1cm4gdH1mdW5jdGlvbiBsKGUsdCl7Zm9yKHZhciBuPWMoZSkscj1jKHQpLG89bnVsbDtuLmxlbmd0aD4wJiZyLmxlbmd0aD4wOyl7dmFyIGk9bi5wb3AoKSxhPXIucG9wKCk7aWYoaSE9PWEpYnJlYWs7bz1pfXJldHVybiBvfWZ1bmN0aW9uIHUoZSx0LG4pe3QgaW5zdGFuY2VvZiBHLldpbmRvdyYmKHQ9dC5kb2N1bWVudCk7dmFyIG8saT1BKHQpLGE9QShuKSxzPXIobixlKSxvPWwoaSxhKTtvfHwobz1hLnJvb3QpO2Zvcih2YXIgYz1vO2M7Yz1jLnBhcmVudClmb3IodmFyIHU9MDt1PHMubGVuZ3RoO3UrKyl7dmFyIGQ9c1t1XTtpZihBKGQpPT09YylyZXR1cm4gZH1yZXR1cm4gbnVsbH1mdW5jdGlvbiBkKGUsdCl7cmV0dXJuIEEoZSk9PT1BKHQpfWZ1bmN0aW9uIHAoZSl7aWYoIUsuZ2V0KGUpJiYoSy5zZXQoZSwhMCksZihWKGUpLFYoZS50YXJnZXQpKSxQKSl7dmFyIHQ9UDt0aHJvdyBQPW51bGwsdH19ZnVuY3Rpb24gaChlKXtzd2l0Y2goZS50eXBlKXtjYXNlXCJsb2FkXCI6Y2FzZVwiYmVmb3JldW5sb2FkXCI6Y2FzZVwidW5sb2FkXCI6cmV0dXJuITB9cmV0dXJuITF9ZnVuY3Rpb24gZih0LG4pe2lmKCQuZ2V0KHQpKXRocm93IG5ldyBFcnJvcihcIkludmFsaWRTdGF0ZUVycm9yXCIpOyQuc2V0KHQsITApLGUucmVuZGVyQWxsUGVuZGluZygpO3ZhciBvLGksYTtpZihoKHQpJiYhdC5idWJibGVzKXt2YXIgcz1uO3MgaW5zdGFuY2VvZiBHLkRvY3VtZW50JiYoYT1zLmRlZmF1bHRWaWV3KSYmKGk9cyxvPVtdKX1pZighbylpZihuIGluc3RhbmNlb2YgRy5XaW5kb3cpYT1uLG89W107ZWxzZSBpZihvPXIobix0KSwhaCh0KSl7dmFyIHM9b1tvLmxlbmd0aC0xXTtzIGluc3RhbmNlb2YgRy5Eb2N1bWVudCYmKGE9cy5kZWZhdWx0Vmlldyl9cmV0dXJuIG5lLnNldCh0LG8pLG0odCxvLGEsaSkmJncodCxvLGEsaSkmJnYodCxvLGEsaSksSi5zZXQodCxyZSksWVtcImRlbGV0ZVwiXSh0LG51bGwpLCRbXCJkZWxldGVcIl0odCksdC5kZWZhdWx0UHJldmVudGVkfWZ1bmN0aW9uIG0oZSx0LG4scil7dmFyIG89b2U7aWYobiYmIWcobixlLG8sdCxyKSlyZXR1cm4hMTtmb3IodmFyIGk9dC5sZW5ndGgtMTtpPjA7aS0tKWlmKCFnKHRbaV0sZSxvLHQscikpcmV0dXJuITE7cmV0dXJuITB9ZnVuY3Rpb24gdyhlLHQsbixyKXt2YXIgbz1pZSxpPXRbMF18fG47cmV0dXJuIGcoaSxlLG8sdCxyKX1mdW5jdGlvbiB2KGUsdCxuLHIpe2Zvcih2YXIgbz1hZSxpPTE7aTx0Lmxlbmd0aDtpKyspaWYoIWcodFtpXSxlLG8sdCxyKSlyZXR1cm47biYmdC5sZW5ndGg+MCYmZyhuLGUsbyx0LHIpfWZ1bmN0aW9uIGcoZSx0LG4scixvKXt2YXIgaT16LmdldChlKTtpZighaSlyZXR1cm4hMDt2YXIgYT1vfHxzKHIsZSk7aWYoYT09PWUpe2lmKG49PT1vZSlyZXR1cm4hMDtuPT09YWUmJihuPWllKX1lbHNlIGlmKG49PT1hZSYmIXQuYnViYmxlcylyZXR1cm4hMDtpZihcInJlbGF0ZWRUYXJnZXRcImluIHQpe3ZhciBjPUIodCksbD1jLnJlbGF0ZWRUYXJnZXQ7aWYobCl7aWYobCBpbnN0YW5jZW9mIE9iamVjdCYmbC5hZGRFdmVudExpc3RlbmVyKXt2YXIgZD1WKGwpLHA9dSh0LGUsZCk7aWYocD09PWEpcmV0dXJuITB9ZWxzZSBwPW51bGw7Wi5zZXQodCxwKX19Si5zZXQodCxuKTt2YXIgaD10LnR5cGUsZj0hMTtYLnNldCh0LGEpLFkuc2V0KHQsZSksaS5kZXB0aCsrO2Zvcih2YXIgbT0wLHc9aS5sZW5ndGg7dz5tO20rKyl7dmFyIHY9aVttXTtpZih2LnJlbW92ZWQpZj0hMDtlbHNlIGlmKCEodi50eXBlIT09aHx8IXYuY2FwdHVyZSYmbj09PW9lfHx2LmNhcHR1cmUmJm49PT1hZSkpdHJ5e2lmKFwiZnVuY3Rpb25cIj09dHlwZW9mIHYuaGFuZGxlcj92LmhhbmRsZXIuY2FsbChlLHQpOnYuaGFuZGxlci5oYW5kbGVFdmVudCh0KSxlZS5nZXQodCkpcmV0dXJuITF9Y2F0Y2goZyl7UHx8KFA9Zyl9fWlmKGkuZGVwdGgtLSxmJiYwPT09aS5kZXB0aCl7dmFyIGI9aS5zbGljZSgpO2kubGVuZ3RoPTA7Zm9yKHZhciBtPTA7bTxiLmxlbmd0aDttKyspYlttXS5yZW1vdmVkfHxpLnB1c2goYlttXSl9cmV0dXJuIVEuZ2V0KHQpfWZ1bmN0aW9uIGIoZSx0LG4pe3RoaXMudHlwZT1lLHRoaXMuaGFuZGxlcj10LHRoaXMuY2FwdHVyZT1Cb29sZWFuKG4pfWZ1bmN0aW9uIHkoZSx0KXtpZighKGUgaW5zdGFuY2VvZiBzZSkpcmV0dXJuIFYoVChzZSxcIkV2ZW50XCIsZSx0KSk7dmFyIG49ZTtyZXR1cm4gZ2V8fFwiYmVmb3JldW5sb2FkXCIhPT1uLnR5cGV8fHRoaXMgaW5zdGFuY2VvZiBNP3ZvaWQgVShuLHRoaXMpOm5ldyBNKG4pfWZ1bmN0aW9uIEUoZSl7cmV0dXJuIGUmJmUucmVsYXRlZFRhcmdldD9PYmplY3QuY3JlYXRlKGUse3JlbGF0ZWRUYXJnZXQ6e3ZhbHVlOkIoZS5yZWxhdGVkVGFyZ2V0KX19KTplfWZ1bmN0aW9uIF8oZSx0LG4pe3ZhciByPXdpbmRvd1tlXSxvPWZ1bmN0aW9uKHQsbil7cmV0dXJuIHQgaW5zdGFuY2VvZiByP3ZvaWQgVSh0LHRoaXMpOlYoVChyLGUsdCxuKSl9O2lmKG8ucHJvdG90eXBlPU9iamVjdC5jcmVhdGUodC5wcm90b3R5cGUpLG4mJlcoby5wcm90b3R5cGUsbikscil0cnl7RihyLG8sbmV3IHIoXCJ0ZW1wXCIpKX1jYXRjaChpKXtGKHIsbyxkb2N1bWVudC5jcmVhdGVFdmVudChlKSl9cmV0dXJuIG99ZnVuY3Rpb24gUyhlLHQpe3JldHVybiBmdW5jdGlvbigpe2FyZ3VtZW50c1t0XT1CKGFyZ3VtZW50c1t0XSk7dmFyIG49Qih0aGlzKTtuW2VdLmFwcGx5KG4sYXJndW1lbnRzKX19ZnVuY3Rpb24gVChlLHQsbixyKXtpZih3ZSlyZXR1cm4gbmV3IGUobixFKHIpKTt2YXIgbz1CKGRvY3VtZW50LmNyZWF0ZUV2ZW50KHQpKSxpPW1lW3RdLGE9W25dO3JldHVybiBPYmplY3Qua2V5cyhpKS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3ZhciB0PW51bGwhPXImJmUgaW4gcj9yW2VdOmlbZV07XCJyZWxhdGVkVGFyZ2V0XCI9PT1lJiYodD1CKHQpKSxhLnB1c2godCl9KSxvW1wiaW5pdFwiK3RdLmFwcGx5KG8sYSksb31mdW5jdGlvbiBNKGUpe3kuY2FsbCh0aGlzLGUpfWZ1bmN0aW9uIE8oZSl7cmV0dXJuXCJmdW5jdGlvblwiPT10eXBlb2YgZT8hMDplJiZlLmhhbmRsZUV2ZW50fWZ1bmN0aW9uIEwoZSl7c3dpdGNoKGUpe2Nhc2VcIkRPTUF0dHJNb2RpZmllZFwiOmNhc2VcIkRPTUF0dHJpYnV0ZU5hbWVDaGFuZ2VkXCI6Y2FzZVwiRE9NQ2hhcmFjdGVyRGF0YU1vZGlmaWVkXCI6Y2FzZVwiRE9NRWxlbWVudE5hbWVDaGFuZ2VkXCI6Y2FzZVwiRE9NTm9kZUluc2VydGVkXCI6Y2FzZVwiRE9NTm9kZUluc2VydGVkSW50b0RvY3VtZW50XCI6Y2FzZVwiRE9NTm9kZVJlbW92ZWRcIjpjYXNlXCJET01Ob2RlUmVtb3ZlZEZyb21Eb2N1bWVudFwiOmNhc2VcIkRPTVN1YnRyZWVNb2RpZmllZFwiOnJldHVybiEwfXJldHVybiExfWZ1bmN0aW9uIE4oZSl7VShlLHRoaXMpfWZ1bmN0aW9uIEMoZSl7cmV0dXJuIGUgaW5zdGFuY2VvZiBHLlNoYWRvd1Jvb3QmJihlPWUuaG9zdCksQihlKX1mdW5jdGlvbiBqKGUsdCl7dmFyIG49ei5nZXQoZSk7aWYobilmb3IodmFyIHI9MDtyPG4ubGVuZ3RoO3IrKylpZighbltyXS5yZW1vdmVkJiZuW3JdLnR5cGU9PT10KXJldHVybiEwO3JldHVybiExfWZ1bmN0aW9uIEQoZSx0KXtmb3IodmFyIG49QihlKTtuO249bi5wYXJlbnROb2RlKWlmKGooVihuKSx0KSlyZXR1cm4hMDtyZXR1cm4hMX1mdW5jdGlvbiBIKGUpe2soZSx5ZSl9ZnVuY3Rpb24geCh0LG4sbyxpKXtlLnJlbmRlckFsbFBlbmRpbmcoKTt2YXIgYT1WKEVlLmNhbGwocShuKSxvLGkpKTtpZighYSlyZXR1cm4gbnVsbDt2YXIgYz1yKGEsbnVsbCksbD1jLmxhc3RJbmRleE9mKHQpO3JldHVybi0xPT1sP251bGw6KGM9Yy5zbGljZSgwLGwpLHMoYyx0KSl9ZnVuY3Rpb24gUihlKXtyZXR1cm4gZnVuY3Rpb24oKXt2YXIgdD10ZS5nZXQodGhpcyk7cmV0dXJuIHQmJnRbZV0mJnRbZV0udmFsdWV8fG51bGx9fWZ1bmN0aW9uIEkoZSl7dmFyIHQ9ZS5zbGljZSgyKTtyZXR1cm4gZnVuY3Rpb24obil7dmFyIHI9dGUuZ2V0KHRoaXMpO3J8fChyPU9iamVjdC5jcmVhdGUobnVsbCksdGUuc2V0KHRoaXMscikpO3ZhciBvPXJbZV07aWYobyYmdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKHQsby53cmFwcGVkLCExKSxcImZ1bmN0aW9uXCI9PXR5cGVvZiBuKXt2YXIgaT1mdW5jdGlvbih0KXt2YXIgcj1uLmNhbGwodGhpcyx0KTtyPT09ITE/dC5wcmV2ZW50RGVmYXVsdCgpOlwib25iZWZvcmV1bmxvYWRcIj09PWUmJlwic3RyaW5nXCI9PXR5cGVvZiByJiYodC5yZXR1cm5WYWx1ZT1yKX07dGhpcy5hZGRFdmVudExpc3RlbmVyKHQsaSwhMSkscltlXT17dmFsdWU6bix3cmFwcGVkOml9fX19dmFyIFAsaz1lLmZvcndhcmRNZXRob2RzVG9XcmFwcGVyLEE9ZS5nZXRUcmVlU2NvcGUsVz1lLm1peGluLEY9ZS5yZWdpc3RlcldyYXBwZXIsVT1lLnNldFdyYXBwZXIscT1lLnVuc2FmZVVud3JhcCxCPWUudW53cmFwLFY9ZS53cmFwLEc9ZS53cmFwcGVycyx6PShuZXcgV2Vha01hcCxuZXcgV2Vha01hcCksSz1uZXcgV2Vha01hcCwkPW5ldyBXZWFrTWFwLFg9bmV3IFdlYWtNYXAsWT1uZXcgV2Vha01hcCxaPW5ldyBXZWFrTWFwLEo9bmV3IFdlYWtNYXAsUT1uZXcgV2Vha01hcCxlZT1uZXcgV2Vha01hcCx0ZT1uZXcgV2Vha01hcCxuZT1uZXcgV2Vha01hcCxyZT0wLG9lPTEsaWU9MixhZT0zO2IucHJvdG90eXBlPXtlcXVhbHM6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuaGFuZGxlcj09PWUuaGFuZGxlciYmdGhpcy50eXBlPT09ZS50eXBlJiZ0aGlzLmNhcHR1cmU9PT1lLmNhcHR1cmV9LGdldCByZW1vdmVkKCl7cmV0dXJuIG51bGw9PT10aGlzLmhhbmRsZXJ9LHJlbW92ZTpmdW5jdGlvbigpe3RoaXMuaGFuZGxlcj1udWxsfX07dmFyIHNlPXdpbmRvdy5FdmVudDtzZS5wcm90b3R5cGUucG9seW1lckJsYWNrTGlzdF89e3JldHVyblZhbHVlOiEwLGtleUxvY2F0aW9uOiEwfSx5LnByb3RvdHlwZT17Z2V0IHRhcmdldCgpe3JldHVybiBYLmdldCh0aGlzKX0sZ2V0IGN1cnJlbnRUYXJnZXQoKXtyZXR1cm4gWS5nZXQodGhpcyl9LGdldCBldmVudFBoYXNlKCl7cmV0dXJuIEouZ2V0KHRoaXMpfSxnZXQgcGF0aCgpe3ZhciBlPW5lLmdldCh0aGlzKTtyZXR1cm4gZT9lLnNsaWNlKCk6W119LHN0b3BQcm9wYWdhdGlvbjpmdW5jdGlvbigpe1Euc2V0KHRoaXMsITApfSxzdG9wSW1tZWRpYXRlUHJvcGFnYXRpb246ZnVuY3Rpb24oKXtRLnNldCh0aGlzLCEwKSxlZS5zZXQodGhpcywhMCl9fSxGKHNlLHksZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJFdmVudFwiKSk7dmFyIGNlPV8oXCJVSUV2ZW50XCIseSksbGU9XyhcIkN1c3RvbUV2ZW50XCIseSksdWU9e2dldCByZWxhdGVkVGFyZ2V0KCl7dmFyIGU9Wi5nZXQodGhpcyk7cmV0dXJuIHZvaWQgMCE9PWU/ZTpWKEIodGhpcykucmVsYXRlZFRhcmdldCl9fSxkZT1XKHtpbml0TW91c2VFdmVudDpTKFwiaW5pdE1vdXNlRXZlbnRcIiwxNCl9LHVlKSxwZT1XKHtpbml0Rm9jdXNFdmVudDpTKFwiaW5pdEZvY3VzRXZlbnRcIiw1KX0sdWUpLGhlPV8oXCJNb3VzZUV2ZW50XCIsY2UsZGUpLGZlPV8oXCJGb2N1c0V2ZW50XCIsY2UscGUpLG1lPU9iamVjdC5jcmVhdGUobnVsbCksd2U9ZnVuY3Rpb24oKXt0cnl7bmV3IHdpbmRvdy5Gb2N1c0V2ZW50KFwiZm9jdXNcIil9Y2F0Y2goZSl7cmV0dXJuITF9cmV0dXJuITB9KCk7aWYoIXdlKXt2YXIgdmU9ZnVuY3Rpb24oZSx0LG4pe2lmKG4pe3ZhciByPW1lW25dO3Q9VyhXKHt9LHIpLHQpfW1lW2VdPXR9O3ZlKFwiRXZlbnRcIix7YnViYmxlczohMSxjYW5jZWxhYmxlOiExfSksdmUoXCJDdXN0b21FdmVudFwiLHtkZXRhaWw6bnVsbH0sXCJFdmVudFwiKSx2ZShcIlVJRXZlbnRcIix7dmlldzpudWxsLGRldGFpbDowfSxcIkV2ZW50XCIpLHZlKFwiTW91c2VFdmVudFwiLHtzY3JlZW5YOjAsc2NyZWVuWTowLGNsaWVudFg6MCxjbGllbnRZOjAsY3RybEtleTohMSxhbHRLZXk6ITEsc2hpZnRLZXk6ITEsbWV0YUtleTohMSxidXR0b246MCxyZWxhdGVkVGFyZ2V0Om51bGx9LFwiVUlFdmVudFwiKSx2ZShcIkZvY3VzRXZlbnRcIix7cmVsYXRlZFRhcmdldDpudWxsfSxcIlVJRXZlbnRcIil9dmFyIGdlPXdpbmRvdy5CZWZvcmVVbmxvYWRFdmVudDtNLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHkucHJvdG90eXBlKSxXKE0ucHJvdG90eXBlLHtnZXQgcmV0dXJuVmFsdWUoKXtyZXR1cm4gcSh0aGlzKS5yZXR1cm5WYWx1ZX0sc2V0IHJldHVyblZhbHVlKGUpe3EodGhpcykucmV0dXJuVmFsdWU9ZX19KSxnZSYmRihnZSxNKTt2YXIgYmU9d2luZG93LkV2ZW50VGFyZ2V0LHllPVtcImFkZEV2ZW50TGlzdGVuZXJcIixcInJlbW92ZUV2ZW50TGlzdGVuZXJcIixcImRpc3BhdGNoRXZlbnRcIl07W05vZGUsV2luZG93XS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3ZhciB0PWUucHJvdG90eXBlO3llLmZvckVhY2goZnVuY3Rpb24oZSl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHQsZStcIl9cIix7dmFsdWU6dFtlXX0pfSl9KSxOLnByb3RvdHlwZT17YWRkRXZlbnRMaXN0ZW5lcjpmdW5jdGlvbihlLHQsbil7aWYoTyh0KSYmIUwoZSkpe3ZhciByPW5ldyBiKGUsdCxuKSxvPXouZ2V0KHRoaXMpO2lmKG8pe2Zvcih2YXIgaT0wO2k8by5sZW5ndGg7aSsrKWlmKHIuZXF1YWxzKG9baV0pKXJldHVybn1lbHNlIG89W10sby5kZXB0aD0wLHouc2V0KHRoaXMsbyk7by5wdXNoKHIpO3ZhciBhPUModGhpcyk7YS5hZGRFdmVudExpc3RlbmVyXyhlLHAsITApfX0scmVtb3ZlRXZlbnRMaXN0ZW5lcjpmdW5jdGlvbihlLHQsbil7bj1Cb29sZWFuKG4pO3ZhciByPXouZ2V0KHRoaXMpO2lmKHIpe2Zvcih2YXIgbz0wLGk9ITEsYT0wO2E8ci5sZW5ndGg7YSsrKXJbYV0udHlwZT09PWUmJnJbYV0uY2FwdHVyZT09PW4mJihvKyssclthXS5oYW5kbGVyPT09dCYmKGk9ITAsclthXS5yZW1vdmUoKSkpO2lmKGkmJjE9PT1vKXt2YXIgcz1DKHRoaXMpO3MucmVtb3ZlRXZlbnRMaXN0ZW5lcl8oZSxwLCEwKX19fSxkaXNwYXRjaEV2ZW50OmZ1bmN0aW9uKHQpe3ZhciBuPUIodCkscj1uLnR5cGU7Sy5zZXQobiwhMSksZS5yZW5kZXJBbGxQZW5kaW5nKCk7dmFyIG87RCh0aGlzLHIpfHwobz1mdW5jdGlvbigpe30sdGhpcy5hZGRFdmVudExpc3RlbmVyKHIsbywhMCkpO3RyeXtyZXR1cm4gQih0aGlzKS5kaXNwYXRjaEV2ZW50XyhuKX1maW5hbGx5e28mJnRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcihyLG8sITApfX19LGJlJiZGKGJlLE4pO3ZhciBFZT1kb2N1bWVudC5lbGVtZW50RnJvbVBvaW50O2UuZWxlbWVudEZyb21Qb2ludD14LGUuZ2V0RXZlbnRIYW5kbGVyR2V0dGVyPVIsZS5nZXRFdmVudEhhbmRsZXJTZXR0ZXI9SSxlLndyYXBFdmVudFRhcmdldE1ldGhvZHM9SCxlLndyYXBwZXJzLkJlZm9yZVVubG9hZEV2ZW50PU0sZS53cmFwcGVycy5DdXN0b21FdmVudD1sZSxlLndyYXBwZXJzLkV2ZW50PXksZS53cmFwcGVycy5FdmVudFRhcmdldD1OLGUud3JhcHBlcnMuRm9jdXNFdmVudD1mZSxlLndyYXBwZXJzLk1vdXNlRXZlbnQ9aGUsZS53cmFwcGVycy5VSUV2ZW50PWNlfSh3aW5kb3cuU2hhZG93RE9NUG9seWZpbGwpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHQoZSx0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkoZSx0LG0pfWZ1bmN0aW9uIG4oZSl7bChlLHRoaXMpfWZ1bmN0aW9uIHIoKXt0aGlzLmxlbmd0aD0wLHQodGhpcyxcImxlbmd0aFwiKX1mdW5jdGlvbiBvKGUpe2Zvcih2YXIgdD1uZXcgcixvPTA7bzxlLmxlbmd0aDtvKyspdFtvXT1uZXcgbihlW29dKTtyZXR1cm4gdC5sZW5ndGg9byx0fWZ1bmN0aW9uIGkoZSl7YS5jYWxsKHRoaXMsZSl9dmFyIGE9ZS53cmFwcGVycy5VSUV2ZW50LHM9ZS5taXhpbixjPWUucmVnaXN0ZXJXcmFwcGVyLGw9ZS5zZXRXcmFwcGVyLHU9ZS51bnNhZmVVbndyYXAsZD1lLndyYXAscD13aW5kb3cuVG91Y2hFdmVudDtpZihwKXt2YXIgaDt0cnl7aD1kb2N1bWVudC5jcmVhdGVFdmVudChcIlRvdWNoRXZlbnRcIil9Y2F0Y2goZil7cmV0dXJufXZhciBtPXtlbnVtZXJhYmxlOiExfTtuLnByb3RvdHlwZT17Z2V0IHRhcmdldCgpe3JldHVybiBkKHUodGhpcykudGFyZ2V0KX19O3ZhciB3PXtjb25maWd1cmFibGU6ITAsZW51bWVyYWJsZTohMCxnZXQ6bnVsbH07W1wiY2xpZW50WFwiLFwiY2xpZW50WVwiLFwic2NyZWVuWFwiLFwic2NyZWVuWVwiLFwicGFnZVhcIixcInBhZ2VZXCIsXCJpZGVudGlmaWVyXCIsXCJ3ZWJraXRSYWRpdXNYXCIsXCJ3ZWJraXRSYWRpdXNZXCIsXCJ3ZWJraXRSb3RhdGlvbkFuZ2xlXCIsXCJ3ZWJraXRGb3JjZVwiXS5mb3JFYWNoKGZ1bmN0aW9uKGUpe3cuZ2V0PWZ1bmN0aW9uKCl7cmV0dXJuIHUodGhpcylbZV19LE9iamVjdC5kZWZpbmVQcm9wZXJ0eShuLnByb3RvdHlwZSxlLHcpfSksci5wcm90b3R5cGU9e2l0ZW06ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXNbZV19fSxpLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGEucHJvdG90eXBlKSxzKGkucHJvdG90eXBlLHtnZXQgdG91Y2hlcygpe3JldHVybiBvKHUodGhpcykudG91Y2hlcyl9LGdldCB0YXJnZXRUb3VjaGVzKCl7cmV0dXJuIG8odSh0aGlzKS50YXJnZXRUb3VjaGVzKX0sZ2V0IGNoYW5nZWRUb3VjaGVzKCl7cmV0dXJuIG8odSh0aGlzKS5jaGFuZ2VkVG91Y2hlcyl9LGluaXRUb3VjaEV2ZW50OmZ1bmN0aW9uKCl7dGhyb3cgbmV3IEVycm9yKFwiTm90IGltcGxlbWVudGVkXCIpfX0pLGMocCxpLGgpLGUud3JhcHBlcnMuVG91Y2g9bixlLndyYXBwZXJzLlRvdWNoRXZlbnQ9aSxlLndyYXBwZXJzLlRvdWNoTGlzdD1yfX0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUsdCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGUsdCxzKX1mdW5jdGlvbiBuKCl7dGhpcy5sZW5ndGg9MCx0KHRoaXMsXCJsZW5ndGhcIil9ZnVuY3Rpb24gcihlKXtpZihudWxsPT1lKXJldHVybiBlO2Zvcih2YXIgdD1uZXcgbixyPTAsbz1lLmxlbmd0aDtvPnI7cisrKXRbcl09YShlW3JdKTtyZXR1cm4gdC5sZW5ndGg9byx0fWZ1bmN0aW9uIG8oZSx0KXtlLnByb3RvdHlwZVt0XT1mdW5jdGlvbigpe3JldHVybiByKGkodGhpcylbdF0uYXBwbHkoaSh0aGlzKSxhcmd1bWVudHMpKX19dmFyIGk9ZS51bnNhZmVVbndyYXAsYT1lLndyYXAscz17ZW51bWVyYWJsZTohMX07bi5wcm90b3R5cGU9e2l0ZW06ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXNbZV19fSx0KG4ucHJvdG90eXBlLFwiaXRlbVwiKSxlLndyYXBwZXJzLk5vZGVMaXN0PW4sZS5hZGRXcmFwTm9kZUxpc3RNZXRob2Q9byxlLndyYXBOb2RlTGlzdD1yfSh3aW5kb3cuU2hhZG93RE9NUG9seWZpbGwpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Uud3JhcEhUTUxDb2xsZWN0aW9uPWUud3JhcE5vZGVMaXN0LGUud3JhcHBlcnMuSFRNTENvbGxlY3Rpb249ZS53cmFwcGVycy5Ob2RlTGlzdH0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUpe08oZSBpbnN0YW5jZW9mIF8pfWZ1bmN0aW9uIG4oZSl7dmFyIHQ9bmV3IFQ7cmV0dXJuIHRbMF09ZSx0Lmxlbmd0aD0xLHR9ZnVuY3Rpb24gcihlLHQsbil7Tih0LFwiY2hpbGRMaXN0XCIse3JlbW92ZWROb2RlczpuLHByZXZpb3VzU2libGluZzplLnByZXZpb3VzU2libGluZyxuZXh0U2libGluZzplLm5leHRTaWJsaW5nfSl9ZnVuY3Rpb24gbyhlLHQpe04oZSxcImNoaWxkTGlzdFwiLHtyZW1vdmVkTm9kZXM6dH0pfWZ1bmN0aW9uIGkoZSx0LHIsbyl7aWYoZSBpbnN0YW5jZW9mIERvY3VtZW50RnJhZ21lbnQpe3ZhciBpPXMoZSk7VT0hMDtmb3IodmFyIGE9aS5sZW5ndGgtMTthPj0wO2EtLSllLnJlbW92ZUNoaWxkKGlbYV0pLGlbYV0ucGFyZW50Tm9kZV89dDtVPSExO2Zvcih2YXIgYT0wO2E8aS5sZW5ndGg7YSsrKWlbYV0ucHJldmlvdXNTaWJsaW5nXz1pW2EtMV18fHIsaVthXS5uZXh0U2libGluZ189aVthKzFdfHxvO3JldHVybiByJiYoci5uZXh0U2libGluZ189aVswXSksbyYmKG8ucHJldmlvdXNTaWJsaW5nXz1pW2kubGVuZ3RoLTFdKSxpfXZhciBpPW4oZSksYz1lLnBhcmVudE5vZGU7cmV0dXJuIGMmJmMucmVtb3ZlQ2hpbGQoZSksZS5wYXJlbnROb2RlXz10LGUucHJldmlvdXNTaWJsaW5nXz1yLGUubmV4dFNpYmxpbmdfPW8sciYmKHIubmV4dFNpYmxpbmdfPWUpLG8mJihvLnByZXZpb3VzU2libGluZ189ZSksaX1mdW5jdGlvbiBhKGUpe2lmKGUgaW5zdGFuY2VvZiBEb2N1bWVudEZyYWdtZW50KXJldHVybiBzKGUpO3ZhciB0PW4oZSksbz1lLnBhcmVudE5vZGU7cmV0dXJuIG8mJnIoZSxvLHQpLHR9ZnVuY3Rpb24gcyhlKXtmb3IodmFyIHQ9bmV3IFQsbj0wLHI9ZS5maXJzdENoaWxkO3I7cj1yLm5leHRTaWJsaW5nKXRbbisrXT1yO3JldHVybiB0Lmxlbmd0aD1uLG8oZSx0KSx0fWZ1bmN0aW9uIGMoZSl7cmV0dXJuIGV9ZnVuY3Rpb24gbChlLHQpe1IoZSx0KSxlLm5vZGVJc0luc2VydGVkXygpfWZ1bmN0aW9uIHUoZSx0KXtmb3IodmFyIG49Qyh0KSxyPTA7cjxlLmxlbmd0aDtyKyspbChlW3JdLG4pfWZ1bmN0aW9uIGQoZSl7UihlLG5ldyBNKGUsbnVsbCkpfWZ1bmN0aW9uIHAoZSl7Zm9yKHZhciB0PTA7dDxlLmxlbmd0aDt0KyspZChlW3RdKX1mdW5jdGlvbiBoKGUsdCl7dmFyIG49ZS5ub2RlVHlwZT09PV8uRE9DVU1FTlRfTk9ERT9lOmUub3duZXJEb2N1bWVudDtuIT09dC5vd25lckRvY3VtZW50JiZuLmFkb3B0Tm9kZSh0KX1mdW5jdGlvbiBmKHQsbil7aWYobi5sZW5ndGgpe3ZhciByPXQub3duZXJEb2N1bWVudDtpZihyIT09blswXS5vd25lckRvY3VtZW50KWZvcih2YXIgbz0wO288bi5sZW5ndGg7bysrKWUuYWRvcHROb2RlTm9SZW1vdmUobltvXSxyKX19ZnVuY3Rpb24gbShlLHQpe2YoZSx0KTt2YXIgbj10Lmxlbmd0aDtpZigxPT09bilyZXR1cm4gUCh0WzBdKTtmb3IodmFyIHI9UChlLm93bmVyRG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpKSxvPTA7bj5vO28rKylyLmFwcGVuZENoaWxkKFAodFtvXSkpO3JldHVybiByfWZ1bmN0aW9uIHcoZSl7aWYodm9pZCAwIT09ZS5maXJzdENoaWxkXylmb3IodmFyIHQ9ZS5maXJzdENoaWxkXzt0Oyl7dmFyIG49dDt0PXQubmV4dFNpYmxpbmdfLG4ucGFyZW50Tm9kZV89bi5wcmV2aW91c1NpYmxpbmdfPW4ubmV4dFNpYmxpbmdfPXZvaWQgMH1lLmZpcnN0Q2hpbGRfPWUubGFzdENoaWxkXz12b2lkIDB9ZnVuY3Rpb24gdihlKXtpZihlLmludmFsaWRhdGVTaGFkb3dSZW5kZXJlcigpKXtmb3IodmFyIHQ9ZS5maXJzdENoaWxkO3Q7KXtPKHQucGFyZW50Tm9kZT09PWUpO3ZhciBuPXQubmV4dFNpYmxpbmcscj1QKHQpLG89ci5wYXJlbnROb2RlO28mJlguY2FsbChvLHIpLHQucHJldmlvdXNTaWJsaW5nXz10Lm5leHRTaWJsaW5nXz10LnBhcmVudE5vZGVfPW51bGwsdD1ufWUuZmlyc3RDaGlsZF89ZS5sYXN0Q2hpbGRfPW51bGx9ZWxzZSBmb3IodmFyIG4saT1QKGUpLGE9aS5maXJzdENoaWxkO2E7KW49YS5uZXh0U2libGluZyxYLmNhbGwoaSxhKSxhPW59ZnVuY3Rpb24gZyhlKXt2YXIgdD1lLnBhcmVudE5vZGU7cmV0dXJuIHQmJnQuaW52YWxpZGF0ZVNoYWRvd1JlbmRlcmVyKCl9ZnVuY3Rpb24gYihlKXtmb3IodmFyIHQsbj0wO248ZS5sZW5ndGg7bisrKXQ9ZVtuXSx0LnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQodCl9ZnVuY3Rpb24geShlLHQsbil7dmFyIHI7aWYocj1BKG4/cS5jYWxsKG4sSShlKSwhMSk6Qi5jYWxsKEkoZSksITEpKSx0KXtmb3IodmFyIG89ZS5maXJzdENoaWxkO287bz1vLm5leHRTaWJsaW5nKXIuYXBwZW5kQ2hpbGQoeShvLCEwLG4pKTtpZihlIGluc3RhbmNlb2YgRi5IVE1MVGVtcGxhdGVFbGVtZW50KWZvcih2YXIgaT1yLmNvbnRlbnQsbz1lLmNvbnRlbnQuZmlyc3RDaGlsZDtvO289by5uZXh0U2libGluZylpLmFwcGVuZENoaWxkKHkobywhMCxuKSl9cmV0dXJuIHJ9ZnVuY3Rpb24gRShlLHQpe2lmKCF0fHxDKGUpIT09Qyh0KSlyZXR1cm4hMTtmb3IodmFyIG49dDtuO249bi5wYXJlbnROb2RlKWlmKG49PT1lKXJldHVybiEwO3JldHVybiExfWZ1bmN0aW9uIF8oZSl7TyhlIGluc3RhbmNlb2YgViksUy5jYWxsKHRoaXMsZSksdGhpcy5wYXJlbnROb2RlXz12b2lkIDAsdGhpcy5maXJzdENoaWxkXz12b2lkIDAsdGhpcy5sYXN0Q2hpbGRfPXZvaWQgMCx0aGlzLm5leHRTaWJsaW5nXz12b2lkIDAsdGhpcy5wcmV2aW91c1NpYmxpbmdfPXZvaWQgMCx0aGlzLnRyZWVTY29wZV89dm9pZCAwfXZhciBTPWUud3JhcHBlcnMuRXZlbnRUYXJnZXQsVD1lLndyYXBwZXJzLk5vZGVMaXN0LE09ZS5UcmVlU2NvcGUsTz1lLmFzc2VydCxMPWUuZGVmaW5lV3JhcEdldHRlcixOPWUuZW5xdWV1ZU11dGF0aW9uLEM9ZS5nZXRUcmVlU2NvcGUsaj1lLmlzV3JhcHBlcixEPWUubWl4aW4sSD1lLnJlZ2lzdGVyVHJhbnNpZW50T2JzZXJ2ZXJzLHg9ZS5yZWdpc3RlcldyYXBwZXIsUj1lLnNldFRyZWVTY29wZSxJPWUudW5zYWZlVW53cmFwLFA9ZS51bndyYXAsaz1lLnVud3JhcElmTmVlZGVkLEE9ZS53cmFwLFc9ZS53cmFwSWZOZWVkZWQsRj1lLndyYXBwZXJzLFU9ITEscT1kb2N1bWVudC5pbXBvcnROb2RlLEI9d2luZG93Lk5vZGUucHJvdG90eXBlLmNsb25lTm9kZSxWPXdpbmRvdy5Ob2RlLEc9d2luZG93LkRvY3VtZW50RnJhZ21lbnQsej0oVi5wcm90b3R5cGUuYXBwZW5kQ2hpbGQsVi5wcm90b3R5cGUuY29tcGFyZURvY3VtZW50UG9zaXRpb24pLEs9Vi5wcm90b3R5cGUuaXNFcXVhbE5vZGUsJD1WLnByb3RvdHlwZS5pbnNlcnRCZWZvcmUsWD1WLnByb3RvdHlwZS5yZW1vdmVDaGlsZCxZPVYucHJvdG90eXBlLnJlcGxhY2VDaGlsZCxaPS9UcmlkZW50fEVkZ2UvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCksSj1aP2Z1bmN0aW9uKGUsdCl7dHJ5e1guY2FsbChlLHQpfWNhdGNoKG4pe2lmKCEoZSBpbnN0YW5jZW9mIEcpKXRocm93IG59fTpmdW5jdGlvbihlLHQpe1guY2FsbChlLHQpfTtfLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKFMucHJvdG90eXBlKSxEKF8ucHJvdG90eXBlLHthcHBlbmRDaGlsZDpmdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5pbnNlcnRCZWZvcmUoZSxudWxsKX0saW5zZXJ0QmVmb3JlOmZ1bmN0aW9uKGUsbil7dChlKTt2YXIgcjtuP2oobik/cj1QKG4pOihyPW4sbj1BKHIpKToobj1udWxsLHI9bnVsbCksbiYmTyhuLnBhcmVudE5vZGU9PT10aGlzKTt2YXIgbyxzPW4/bi5wcmV2aW91c1NpYmxpbmc6dGhpcy5sYXN0Q2hpbGQsYz0hdGhpcy5pbnZhbGlkYXRlU2hhZG93UmVuZGVyZXIoKSYmIWcoZSk7aWYobz1jP2EoZSk6aShlLHRoaXMscyxuKSxjKWgodGhpcyxlKSx3KHRoaXMpLCQuY2FsbChJKHRoaXMpLFAoZSkscik7ZWxzZXtzfHwodGhpcy5maXJzdENoaWxkXz1vWzBdKSxufHwodGhpcy5sYXN0Q2hpbGRfPW9bby5sZW5ndGgtMV0sdm9pZCAwPT09dGhpcy5maXJzdENoaWxkXyYmKHRoaXMuZmlyc3RDaGlsZF89dGhpcy5maXJzdENoaWxkKSk7dmFyIGw9cj9yLnBhcmVudE5vZGU6SSh0aGlzKTtsPyQuY2FsbChsLG0odGhpcyxvKSxyKTpmKHRoaXMsbyl9cmV0dXJuIE4odGhpcyxcImNoaWxkTGlzdFwiLHthZGRlZE5vZGVzOm8sbmV4dFNpYmxpbmc6bixwcmV2aW91c1NpYmxpbmc6c30pLHUobyx0aGlzKSxlfSxyZW1vdmVDaGlsZDpmdW5jdGlvbihlKXtpZih0KGUpLGUucGFyZW50Tm9kZSE9PXRoaXMpe2Zvcih2YXIgcj0hMSxvPSh0aGlzLmNoaWxkTm9kZXMsdGhpcy5maXJzdENoaWxkKTtvO289by5uZXh0U2libGluZylpZihvPT09ZSl7cj0hMDticmVha31pZighcil0aHJvdyBuZXcgRXJyb3IoXCJOb3RGb3VuZEVycm9yXCIpfXZhciBpPVAoZSksYT1lLm5leHRTaWJsaW5nLHM9ZS5wcmV2aW91c1NpYmxpbmc7aWYodGhpcy5pbnZhbGlkYXRlU2hhZG93UmVuZGVyZXIoKSl7dmFyIGM9dGhpcy5maXJzdENoaWxkLGw9dGhpcy5sYXN0Q2hpbGQsdT1pLnBhcmVudE5vZGU7dSYmSih1LGkpLGM9PT1lJiYodGhpcy5maXJzdENoaWxkXz1hKSxsPT09ZSYmKHRoaXMubGFzdENoaWxkXz1zKSxzJiYocy5uZXh0U2libGluZ189YSksYSYmKGEucHJldmlvdXNTaWJsaW5nXz1zKSxlLnByZXZpb3VzU2libGluZ189ZS5uZXh0U2libGluZ189ZS5wYXJlbnROb2RlXz12b2lkIDB9ZWxzZSB3KHRoaXMpLEooSSh0aGlzKSxpKTtyZXR1cm4gVXx8Tih0aGlzLFwiY2hpbGRMaXN0XCIse3JlbW92ZWROb2RlczpuKGUpLG5leHRTaWJsaW5nOmEscHJldmlvdXNTaWJsaW5nOnN9KSxIKHRoaXMsZSksZX0scmVwbGFjZUNoaWxkOmZ1bmN0aW9uKGUscil7dChlKTt2YXIgbztpZihqKHIpP289UChyKToobz1yLHI9QShvKSksci5wYXJlbnROb2RlIT09dGhpcyl0aHJvdyBuZXcgRXJyb3IoXCJOb3RGb3VuZEVycm9yXCIpO3ZhciBzLGM9ci5uZXh0U2libGluZyxsPXIucHJldmlvdXNTaWJsaW5nLHA9IXRoaXMuaW52YWxpZGF0ZVNoYWRvd1JlbmRlcmVyKCkmJiFnKGUpO3JldHVybiBwP3M9YShlKTooYz09PWUmJihjPWUubmV4dFNpYmxpbmcpLHM9aShlLHRoaXMsbCxjKSkscD8oaCh0aGlzLGUpLHcodGhpcyksWS5jYWxsKEkodGhpcyksUChlKSxvKSk6KHRoaXMuZmlyc3RDaGlsZD09PXImJih0aGlzLmZpcnN0Q2hpbGRfPXNbMF0pLHRoaXMubGFzdENoaWxkPT09ciYmKHRoaXMubGFzdENoaWxkXz1zW3MubGVuZ3RoLTFdKSxyLnByZXZpb3VzU2libGluZ189ci5uZXh0U2libGluZ189ci5wYXJlbnROb2RlXz12b2lkIDAsby5wYXJlbnROb2RlJiZZLmNhbGwoby5wYXJlbnROb2RlLG0odGhpcyxzKSxvKSksTih0aGlzLFwiY2hpbGRMaXN0XCIse2FkZGVkTm9kZXM6cyxyZW1vdmVkTm9kZXM6bihyKSxuZXh0U2libGluZzpjLHByZXZpb3VzU2libGluZzpsfSksZChyKSx1KHMsdGhpcykscn0sbm9kZUlzSW5zZXJ0ZWRfOmZ1bmN0aW9uKCl7Zm9yKHZhciBlPXRoaXMuZmlyc3RDaGlsZDtlO2U9ZS5uZXh0U2libGluZyllLm5vZGVJc0luc2VydGVkXygpfSxoYXNDaGlsZE5vZGVzOmZ1bmN0aW9uKCl7cmV0dXJuIG51bGwhPT10aGlzLmZpcnN0Q2hpbGR9LGdldCBwYXJlbnROb2RlKCl7cmV0dXJuIHZvaWQgMCE9PXRoaXMucGFyZW50Tm9kZV8/dGhpcy5wYXJlbnROb2RlXzpBKEkodGhpcykucGFyZW50Tm9kZSl9LGdldCBmaXJzdENoaWxkKCl7cmV0dXJuIHZvaWQgMCE9PXRoaXMuZmlyc3RDaGlsZF8/dGhpcy5maXJzdENoaWxkXzpBKEkodGhpcykuZmlyc3RDaGlsZCl9LGdldCBsYXN0Q2hpbGQoKXtyZXR1cm4gdm9pZCAwIT09dGhpcy5sYXN0Q2hpbGRfP3RoaXMubGFzdENoaWxkXzpBKEkodGhpcykubGFzdENoaWxkKX0sZ2V0IG5leHRTaWJsaW5nKCl7cmV0dXJuIHZvaWQgMCE9PXRoaXMubmV4dFNpYmxpbmdfP3RoaXMubmV4dFNpYmxpbmdfOkEoSSh0aGlzKS5uZXh0U2libGluZyl9LGdldCBwcmV2aW91c1NpYmxpbmcoKXtyZXR1cm4gdm9pZCAwIT09dGhpcy5wcmV2aW91c1NpYmxpbmdfP3RoaXMucHJldmlvdXNTaWJsaW5nXzpBKEkodGhpcykucHJldmlvdXNTaWJsaW5nKX0sZ2V0IHBhcmVudEVsZW1lbnQoKXtmb3IodmFyIGU9dGhpcy5wYXJlbnROb2RlO2UmJmUubm9kZVR5cGUhPT1fLkVMRU1FTlRfTk9ERTspZT1lLnBhcmVudE5vZGU7cmV0dXJuIGV9LGdldCB0ZXh0Q29udGVudCgpe2Zvcih2YXIgZT1cIlwiLHQ9dGhpcy5maXJzdENoaWxkO3Q7dD10Lm5leHRTaWJsaW5nKXQubm9kZVR5cGUhPV8uQ09NTUVOVF9OT0RFJiYoZSs9dC50ZXh0Q29udGVudCk7cmV0dXJuIGV9LHNldCB0ZXh0Q29udGVudChlKXtudWxsPT1lJiYoZT1cIlwiKTt2YXIgdD1jKHRoaXMuY2hpbGROb2Rlcyk7aWYodGhpcy5pbnZhbGlkYXRlU2hhZG93UmVuZGVyZXIoKSl7aWYodih0aGlzKSxcIlwiIT09ZSl7dmFyIG49SSh0aGlzKS5vd25lckRvY3VtZW50LmNyZWF0ZVRleHROb2RlKGUpO3RoaXMuYXBwZW5kQ2hpbGQobil9fWVsc2Ugdyh0aGlzKSxJKHRoaXMpLnRleHRDb250ZW50PWU7dmFyIHI9Yyh0aGlzLmNoaWxkTm9kZXMpO04odGhpcyxcImNoaWxkTGlzdFwiLHthZGRlZE5vZGVzOnIscmVtb3ZlZE5vZGVzOnR9KSxwKHQpLHUocix0aGlzKX0sZ2V0IGNoaWxkTm9kZXMoKXtmb3IodmFyIGU9bmV3IFQsdD0wLG49dGhpcy5maXJzdENoaWxkO247bj1uLm5leHRTaWJsaW5nKWVbdCsrXT1uO3JldHVybiBlLmxlbmd0aD10LGV9LGNsb25lTm9kZTpmdW5jdGlvbihlKXtyZXR1cm4geSh0aGlzLGUpfSxjb250YWluczpmdW5jdGlvbihlKXtyZXR1cm4gRSh0aGlzLFcoZSkpfSxjb21wYXJlRG9jdW1lbnRQb3NpdGlvbjpmdW5jdGlvbihlKXtyZXR1cm4gei5jYWxsKEkodGhpcyksayhlKSl9LGlzRXF1YWxOb2RlOmZ1bmN0aW9uKGUpe3JldHVybiBLLmNhbGwoSSh0aGlzKSxrKGUpKX0sbm9ybWFsaXplOmZ1bmN0aW9uKCl7Zm9yKHZhciBlLHQsbj1jKHRoaXMuY2hpbGROb2Rlcykscj1bXSxvPVwiXCIsaT0wO2k8bi5sZW5ndGg7aSsrKXQ9bltpXSx0Lm5vZGVUeXBlPT09Xy5URVhUX05PREU/ZXx8dC5kYXRhLmxlbmd0aD9lPyhvKz10LmRhdGEsci5wdXNoKHQpKTplPXQ6dGhpcy5yZW1vdmVDaGlsZCh0KTooZSYmci5sZW5ndGgmJihlLmRhdGErPW8sYihyKSkscj1bXSxvPVwiXCIsZT1udWxsLHQuY2hpbGROb2Rlcy5sZW5ndGgmJnQubm9ybWFsaXplKCkpO2UmJnIubGVuZ3RoJiYoZS5kYXRhKz1vLGIocikpfX0pLEwoXyxcIm93bmVyRG9jdW1lbnRcIikseChWLF8sZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpKSxkZWxldGUgXy5wcm90b3R5cGUucXVlcnlTZWxlY3RvcixkZWxldGUgXy5wcm90b3R5cGUucXVlcnlTZWxlY3RvckFsbCxfLnByb3RvdHlwZT1EKE9iamVjdC5jcmVhdGUoUy5wcm90b3R5cGUpLF8ucHJvdG90eXBlKSxlLmNsb25lTm9kZT15LGUubm9kZVdhc0FkZGVkPWwsZS5ub2RlV2FzUmVtb3ZlZD1kLGUubm9kZXNXZXJlQWRkZWQ9dSxlLm5vZGVzV2VyZVJlbW92ZWQ9cCxlLm9yaWdpbmFsSW5zZXJ0QmVmb3JlPSQsZS5vcmlnaW5hbFJlbW92ZUNoaWxkPVgsZS5zbmFwc2hvdE5vZGVMaXN0PWMsZS53cmFwcGVycy5Ob2RlPV99KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdCh0LG4scixvKXtmb3IodmFyIGk9bnVsbCxhPW51bGwscz0wLGM9dC5sZW5ndGg7Yz5zO3MrKylpPWIodFtzXSksIW8mJihhPXYoaSkucm9vdCkmJmEgaW5zdGFuY2VvZiBlLndyYXBwZXJzLlNoYWRvd1Jvb3R8fChyW24rK109aSk7cmV0dXJuIG59ZnVuY3Rpb24gbihlKXtyZXR1cm4gU3RyaW5nKGUpLnJlcGxhY2UoL1xcL2RlZXBcXC98OjpzaGFkb3d8Pj4+L2csXCIgXCIpfWZ1bmN0aW9uIHIoZSl7cmV0dXJuIFN0cmluZyhlKS5yZXBsYWNlKC86aG9zdFxcKChbXlxcc10rKVxcKS9nLFwiJDFcIikucmVwbGFjZSgvKFteXFxzXSk6aG9zdC9nLFwiJDFcIikucmVwbGFjZShcIjpob3N0XCIsXCIqXCIpLnJlcGxhY2UoL1xcXnxcXC9zaGFkb3dcXC98XFwvc2hhZG93LWRlZXBcXC98OjpzaGFkb3d8XFwvZGVlcFxcL3w6OmNvbnRlbnR8Pj4+L2csXCIgXCIpfWZ1bmN0aW9uIG8oZSx0KXtmb3IodmFyIG4scj1lLmZpcnN0RWxlbWVudENoaWxkO3I7KXtpZihyLm1hdGNoZXModCkpcmV0dXJuIHI7aWYobj1vKHIsdCkpcmV0dXJuIG47cj1yLm5leHRFbGVtZW50U2libGluZ31yZXR1cm4gbnVsbH1mdW5jdGlvbiBpKGUsdCl7cmV0dXJuIGUubWF0Y2hlcyh0KX1mdW5jdGlvbiBhKGUsdCxuKXt2YXIgcj1lLmxvY2FsTmFtZTtyZXR1cm4gcj09PXR8fHI9PT1uJiZlLm5hbWVzcGFjZVVSST09PWp9ZnVuY3Rpb24gcygpe3JldHVybiEwfWZ1bmN0aW9uIGMoZSx0LG4pe3JldHVybiBlLmxvY2FsTmFtZT09PW59ZnVuY3Rpb24gbChlLHQpe3JldHVybiBlLm5hbWVzcGFjZVVSST09PXR9ZnVuY3Rpb24gdShlLHQsbil7cmV0dXJuIGUubmFtZXNwYWNlVVJJPT09dCYmZS5sb2NhbE5hbWU9PT1ufWZ1bmN0aW9uIGQoZSx0LG4scixvLGkpe2Zvcih2YXIgYT1lLmZpcnN0RWxlbWVudENoaWxkO2E7KXIoYSxvLGkpJiYoblt0KytdPWEpLHQ9ZChhLHQsbixyLG8saSksYT1hLm5leHRFbGVtZW50U2libGluZztyZXR1cm4gdH1mdW5jdGlvbiBwKG4scixvLGksYSl7dmFyIHMsYz1nKHRoaXMpLGw9dih0aGlzKS5yb290O2lmKGwgaW5zdGFuY2VvZiBlLndyYXBwZXJzLlNoYWRvd1Jvb3QpcmV0dXJuIGQodGhpcyxyLG8sbixpLG51bGwpO2lmKGMgaW5zdGFuY2VvZiBOKXM9Uy5jYWxsKGMsaSk7ZWxzZXtpZighKGMgaW5zdGFuY2VvZiBDKSlyZXR1cm4gZCh0aGlzLHIsbyxuLGksbnVsbCk7cz1fLmNhbGwoYyxpKX1yZXR1cm4gdChzLHIsbyxhKX1mdW5jdGlvbiBoKG4scixvLGksYSl7dmFyIHMsYz1nKHRoaXMpLGw9dih0aGlzKS5yb290O2lmKGwgaW5zdGFuY2VvZiBlLndyYXBwZXJzLlNoYWRvd1Jvb3QpcmV0dXJuIGQodGhpcyxyLG8sbixpLGEpO2lmKGMgaW5zdGFuY2VvZiBOKXM9TS5jYWxsKGMsaSxhKTtlbHNle2lmKCEoYyBpbnN0YW5jZW9mIEMpKXJldHVybiBkKHRoaXMscixvLG4saSxhKTtzPVQuY2FsbChjLGksYSl9cmV0dXJuIHQocyxyLG8sITEpfWZ1bmN0aW9uIGYobixyLG8saSxhKXt2YXIgcyxjPWcodGhpcyksbD12KHRoaXMpLnJvb3Q7aWYobCBpbnN0YW5jZW9mIGUud3JhcHBlcnMuU2hhZG93Um9vdClyZXR1cm4gZCh0aGlzLHIsbyxuLGksYSk7aWYoYyBpbnN0YW5jZW9mIE4pcz1MLmNhbGwoYyxpLGEpO2Vsc2V7aWYoIShjIGluc3RhbmNlb2YgQykpcmV0dXJuIGQodGhpcyxyLG8sbixpLGEpO3M9Ty5jYWxsKGMsaSxhKX1yZXR1cm4gdChzLHIsbywhMSl9dmFyIG09ZS53cmFwcGVycy5IVE1MQ29sbGVjdGlvbix3PWUud3JhcHBlcnMuTm9kZUxpc3Qsdj1lLmdldFRyZWVTY29wZSxnPWUudW5zYWZlVW53cmFwLGI9ZS53cmFwLHk9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcixFPWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yLF89ZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCxTPWRvY3VtZW50LmRvY3VtZW50RWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsLFQ9ZG9jdW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUsTT1kb2N1bWVudC5kb2N1bWVudEVsZW1lbnQuZ2V0RWxlbWVudHNCeVRhZ05hbWUsTz1kb2N1bWVudC5nZXRFbGVtZW50c0J5VGFnTmFtZU5TLEw9ZG9jdW1lbnQuZG9jdW1lbnRFbGVtZW50LmdldEVsZW1lbnRzQnlUYWdOYW1lTlMsTj13aW5kb3cuRWxlbWVudCxDPXdpbmRvdy5IVE1MRG9jdW1lbnR8fHdpbmRvdy5Eb2N1bWVudCxqPVwiaHR0cDovL3d3dy53My5vcmcvMTk5OS94aHRtbFwiLEQ9e3F1ZXJ5U2VsZWN0b3I6ZnVuY3Rpb24odCl7dmFyIHI9bih0KSxpPXIhPT10O3Q9cjt2YXIgYSxzPWcodGhpcyksYz12KHRoaXMpLnJvb3Q7aWYoYyBpbnN0YW5jZW9mIGUud3JhcHBlcnMuU2hhZG93Um9vdClyZXR1cm4gbyh0aGlzLHQpO2lmKHMgaW5zdGFuY2VvZiBOKWE9YihFLmNhbGwocyx0KSk7ZWxzZXtcbmlmKCEocyBpbnN0YW5jZW9mIEMpKXJldHVybiBvKHRoaXMsdCk7YT1iKHkuY2FsbChzLHQpKX1yZXR1cm4gYSYmIWkmJihjPXYoYSkucm9vdCkmJmMgaW5zdGFuY2VvZiBlLndyYXBwZXJzLlNoYWRvd1Jvb3Q/byh0aGlzLHQpOmF9LHF1ZXJ5U2VsZWN0b3JBbGw6ZnVuY3Rpb24oZSl7dmFyIHQ9bihlKSxyPXQhPT1lO2U9dDt2YXIgbz1uZXcgdztyZXR1cm4gby5sZW5ndGg9cC5jYWxsKHRoaXMsaSwwLG8sZSxyKSxvfX0sSD17bWF0Y2hlczpmdW5jdGlvbih0KXtyZXR1cm4gdD1yKHQpLGUub3JpZ2luYWxNYXRjaGVzLmNhbGwoZyh0aGlzKSx0KX19LHg9e2dldEVsZW1lbnRzQnlUYWdOYW1lOmZ1bmN0aW9uKGUpe3ZhciB0PW5ldyBtLG49XCIqXCI9PT1lP3M6YTtyZXR1cm4gdC5sZW5ndGg9aC5jYWxsKHRoaXMsbiwwLHQsZSxlLnRvTG93ZXJDYXNlKCkpLHR9LGdldEVsZW1lbnRzQnlDbGFzc05hbWU6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMucXVlcnlTZWxlY3RvckFsbChcIi5cIitlKX0sZ2V0RWxlbWVudHNCeVRhZ05hbWVOUzpmdW5jdGlvbihlLHQpe3ZhciBuPW5ldyBtLHI9bnVsbDtyZXR1cm4gcj1cIipcIj09PWU/XCIqXCI9PT10P3M6YzpcIipcIj09PXQ/bDp1LG4ubGVuZ3RoPWYuY2FsbCh0aGlzLHIsMCxuLGV8fG51bGwsdCksbn19O2UuR2V0RWxlbWVudHNCeUludGVyZmFjZT14LGUuU2VsZWN0b3JzSW50ZXJmYWNlPUQsZS5NYXRjaGVzSW50ZXJmYWNlPUh9KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXtmb3IoO2UmJmUubm9kZVR5cGUhPT1Ob2RlLkVMRU1FTlRfTk9ERTspZT1lLm5leHRTaWJsaW5nO3JldHVybiBlfWZ1bmN0aW9uIG4oZSl7Zm9yKDtlJiZlLm5vZGVUeXBlIT09Tm9kZS5FTEVNRU5UX05PREU7KWU9ZS5wcmV2aW91c1NpYmxpbmc7cmV0dXJuIGV9dmFyIHI9ZS53cmFwcGVycy5Ob2RlTGlzdCxvPXtnZXQgZmlyc3RFbGVtZW50Q2hpbGQoKXtyZXR1cm4gdCh0aGlzLmZpcnN0Q2hpbGQpfSxnZXQgbGFzdEVsZW1lbnRDaGlsZCgpe3JldHVybiBuKHRoaXMubGFzdENoaWxkKX0sZ2V0IGNoaWxkRWxlbWVudENvdW50KCl7Zm9yKHZhciBlPTAsdD10aGlzLmZpcnN0RWxlbWVudENoaWxkO3Q7dD10Lm5leHRFbGVtZW50U2libGluZyllKys7cmV0dXJuIGV9LGdldCBjaGlsZHJlbigpe2Zvcih2YXIgZT1uZXcgcix0PTAsbj10aGlzLmZpcnN0RWxlbWVudENoaWxkO247bj1uLm5leHRFbGVtZW50U2libGluZyllW3QrK109bjtyZXR1cm4gZS5sZW5ndGg9dCxlfSxyZW1vdmU6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnBhcmVudE5vZGU7ZSYmZS5yZW1vdmVDaGlsZCh0aGlzKX19LGk9e2dldCBuZXh0RWxlbWVudFNpYmxpbmcoKXtyZXR1cm4gdCh0aGlzLm5leHRTaWJsaW5nKX0sZ2V0IHByZXZpb3VzRWxlbWVudFNpYmxpbmcoKXtyZXR1cm4gbih0aGlzLnByZXZpb3VzU2libGluZyl9fSxhPXtnZXRFbGVtZW50QnlJZDpmdW5jdGlvbihlKXtyZXR1cm4vWyBcXHRcXG5cXHJcXGZdLy50ZXN0KGUpP251bGw6dGhpcy5xdWVyeVNlbGVjdG9yKCdbaWQ9XCInK2UrJ1wiXScpfX07ZS5DaGlsZE5vZGVJbnRlcmZhY2U9aSxlLk5vbkVsZW1lbnRQYXJlbnROb2RlSW50ZXJmYWNlPWEsZS5QYXJlbnROb2RlSW50ZXJmYWNlPW99KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXtyLmNhbGwodGhpcyxlKX12YXIgbj1lLkNoaWxkTm9kZUludGVyZmFjZSxyPWUud3JhcHBlcnMuTm9kZSxvPWUuZW5xdWV1ZU11dGF0aW9uLGk9ZS5taXhpbixhPWUucmVnaXN0ZXJXcmFwcGVyLHM9ZS51bnNhZmVVbndyYXAsYz13aW5kb3cuQ2hhcmFjdGVyRGF0YTt0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHIucHJvdG90eXBlKSxpKHQucHJvdG90eXBlLHtnZXQgbm9kZVZhbHVlKCl7cmV0dXJuIHRoaXMuZGF0YX0sc2V0IG5vZGVWYWx1ZShlKXt0aGlzLmRhdGE9ZX0sZ2V0IHRleHRDb250ZW50KCl7cmV0dXJuIHRoaXMuZGF0YX0sc2V0IHRleHRDb250ZW50KGUpe3RoaXMuZGF0YT1lfSxnZXQgZGF0YSgpe3JldHVybiBzKHRoaXMpLmRhdGF9LHNldCBkYXRhKGUpe3ZhciB0PXModGhpcykuZGF0YTtvKHRoaXMsXCJjaGFyYWN0ZXJEYXRhXCIse29sZFZhbHVlOnR9KSxzKHRoaXMpLmRhdGE9ZX19KSxpKHQucHJvdG90eXBlLG4pLGEoYyx0LGRvY3VtZW50LmNyZWF0ZVRleHROb2RlKFwiXCIpKSxlLndyYXBwZXJzLkNoYXJhY3RlckRhdGE9dH0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUpe3JldHVybiBlPj4+MH1mdW5jdGlvbiBuKGUpe3IuY2FsbCh0aGlzLGUpfXZhciByPWUud3JhcHBlcnMuQ2hhcmFjdGVyRGF0YSxvPShlLmVucXVldWVNdXRhdGlvbixlLm1peGluKSxpPWUucmVnaXN0ZXJXcmFwcGVyLGE9d2luZG93LlRleHQ7bi5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShyLnByb3RvdHlwZSksbyhuLnByb3RvdHlwZSx7c3BsaXRUZXh0OmZ1bmN0aW9uKGUpe2U9dChlKTt2YXIgbj10aGlzLmRhdGE7aWYoZT5uLmxlbmd0aCl0aHJvdyBuZXcgRXJyb3IoXCJJbmRleFNpemVFcnJvclwiKTt2YXIgcj1uLnNsaWNlKDAsZSksbz1uLnNsaWNlKGUpO3RoaXMuZGF0YT1yO3ZhciBpPXRoaXMub3duZXJEb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShvKTtyZXR1cm4gdGhpcy5wYXJlbnROb2RlJiZ0aGlzLnBhcmVudE5vZGUuaW5zZXJ0QmVmb3JlKGksdGhpcy5uZXh0U2libGluZyksaX19KSxpKGEsbixkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShcIlwiKSksZS53cmFwcGVycy5UZXh0PW59KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXtyZXR1cm4gaShlKS5nZXRBdHRyaWJ1dGUoXCJjbGFzc1wiKX1mdW5jdGlvbiBuKGUsdCl7YShlLFwiYXR0cmlidXRlc1wiLHtuYW1lOlwiY2xhc3NcIixuYW1lc3BhY2U6bnVsbCxvbGRWYWx1ZTp0fSl9ZnVuY3Rpb24gcih0KXtlLmludmFsaWRhdGVSZW5kZXJlckJhc2VkT25BdHRyaWJ1dGUodCxcImNsYXNzXCIpfWZ1bmN0aW9uIG8oZSxvLGkpe3ZhciBhPWUub3duZXJFbGVtZW50XztpZihudWxsPT1hKXJldHVybiBvLmFwcGx5KGUsaSk7dmFyIHM9dChhKSxjPW8uYXBwbHkoZSxpKTtyZXR1cm4gdChhKSE9PXMmJihuKGEscykscihhKSksY31pZighd2luZG93LkRPTVRva2VuTGlzdClyZXR1cm4gdm9pZCBjb25zb2xlLndhcm4oXCJNaXNzaW5nIERPTVRva2VuTGlzdCBwcm90b3R5cGUsIHBsZWFzZSBpbmNsdWRlIGEgY29tcGF0aWJsZSBjbGFzc0xpc3QgcG9seWZpbGwgc3VjaCBhcyBodHRwOi8vZ29vLmdsL3VUY2VwSC5cIik7dmFyIGk9ZS51bnNhZmVVbndyYXAsYT1lLmVucXVldWVNdXRhdGlvbixzPURPTVRva2VuTGlzdC5wcm90b3R5cGUuYWRkO0RPTVRva2VuTGlzdC5wcm90b3R5cGUuYWRkPWZ1bmN0aW9uKCl7byh0aGlzLHMsYXJndW1lbnRzKX07dmFyIGM9RE9NVG9rZW5MaXN0LnByb3RvdHlwZS5yZW1vdmU7RE9NVG9rZW5MaXN0LnByb3RvdHlwZS5yZW1vdmU9ZnVuY3Rpb24oKXtvKHRoaXMsYyxhcmd1bWVudHMpfTt2YXIgbD1ET01Ub2tlbkxpc3QucHJvdG90eXBlLnRvZ2dsZTtET01Ub2tlbkxpc3QucHJvdG90eXBlLnRvZ2dsZT1mdW5jdGlvbigpe3JldHVybiBvKHRoaXMsbCxhcmd1bWVudHMpfX0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KHQsbil7dmFyIHI9dC5wYXJlbnROb2RlO2lmKHImJnIuc2hhZG93Um9vdCl7dmFyIG89ZS5nZXRSZW5kZXJlckZvckhvc3Qocik7by5kZXBlbmRzT25BdHRyaWJ1dGUobikmJm8uaW52YWxpZGF0ZSgpfX1mdW5jdGlvbiBuKGUsdCxuKXt1KGUsXCJhdHRyaWJ1dGVzXCIse25hbWU6dCxuYW1lc3BhY2U6bnVsbCxvbGRWYWx1ZTpufSl9ZnVuY3Rpb24gcihlKXthLmNhbGwodGhpcyxlKX12YXIgbz1lLkNoaWxkTm9kZUludGVyZmFjZSxpPWUuR2V0RWxlbWVudHNCeUludGVyZmFjZSxhPWUud3JhcHBlcnMuTm9kZSxzPWUuUGFyZW50Tm9kZUludGVyZmFjZSxjPWUuU2VsZWN0b3JzSW50ZXJmYWNlLGw9ZS5NYXRjaGVzSW50ZXJmYWNlLHU9KGUuYWRkV3JhcE5vZGVMaXN0TWV0aG9kLGUuZW5xdWV1ZU11dGF0aW9uKSxkPWUubWl4aW4scD0oZS5vbmVPZixlLnJlZ2lzdGVyV3JhcHBlciksaD1lLnVuc2FmZVVud3JhcCxmPWUud3JhcHBlcnMsbT13aW5kb3cuRWxlbWVudCx3PVtcIm1hdGNoZXNcIixcIm1vek1hdGNoZXNTZWxlY3RvclwiLFwibXNNYXRjaGVzU2VsZWN0b3JcIixcIndlYmtpdE1hdGNoZXNTZWxlY3RvclwiXS5maWx0ZXIoZnVuY3Rpb24oZSl7cmV0dXJuIG0ucHJvdG90eXBlW2VdfSksdj13WzBdLGc9bS5wcm90b3R5cGVbdl0sYj1uZXcgV2Vha01hcDtyLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKGEucHJvdG90eXBlKSxkKHIucHJvdG90eXBlLHtjcmVhdGVTaGFkb3dSb290OmZ1bmN0aW9uKCl7dmFyIHQ9bmV3IGYuU2hhZG93Um9vdCh0aGlzKTtoKHRoaXMpLnBvbHltZXJTaGFkb3dSb290Xz10O3ZhciBuPWUuZ2V0UmVuZGVyZXJGb3JIb3N0KHRoaXMpO3JldHVybiBuLmludmFsaWRhdGUoKSx0fSxnZXQgc2hhZG93Um9vdCgpe3JldHVybiBoKHRoaXMpLnBvbHltZXJTaGFkb3dSb290X3x8bnVsbH0sc2V0QXR0cmlidXRlOmZ1bmN0aW9uKGUscil7dmFyIG89aCh0aGlzKS5nZXRBdHRyaWJ1dGUoZSk7aCh0aGlzKS5zZXRBdHRyaWJ1dGUoZSxyKSxuKHRoaXMsZSxvKSx0KHRoaXMsZSl9LHJlbW92ZUF0dHJpYnV0ZTpmdW5jdGlvbihlKXt2YXIgcj1oKHRoaXMpLmdldEF0dHJpYnV0ZShlKTtoKHRoaXMpLnJlbW92ZUF0dHJpYnV0ZShlKSxuKHRoaXMsZSxyKSx0KHRoaXMsZSl9LGdldCBjbGFzc0xpc3QoKXt2YXIgZT1iLmdldCh0aGlzKTtpZighZSl7aWYoZT1oKHRoaXMpLmNsYXNzTGlzdCwhZSlyZXR1cm47ZS5vd25lckVsZW1lbnRfPXRoaXMsYi5zZXQodGhpcyxlKX1yZXR1cm4gZX0sZ2V0IGNsYXNzTmFtZSgpe3JldHVybiBoKHRoaXMpLmNsYXNzTmFtZX0sc2V0IGNsYXNzTmFtZShlKXt0aGlzLnNldEF0dHJpYnV0ZShcImNsYXNzXCIsZSl9LGdldCBpZCgpe3JldHVybiBoKHRoaXMpLmlkfSxzZXQgaWQoZSl7dGhpcy5zZXRBdHRyaWJ1dGUoXCJpZFwiLGUpfX0pLHcuZm9yRWFjaChmdW5jdGlvbihlKXtcIm1hdGNoZXNcIiE9PWUmJihyLnByb3RvdHlwZVtlXT1mdW5jdGlvbihlKXtyZXR1cm4gdGhpcy5tYXRjaGVzKGUpfSl9KSxtLnByb3RvdHlwZS53ZWJraXRDcmVhdGVTaGFkb3dSb290JiYoci5wcm90b3R5cGUud2Via2l0Q3JlYXRlU2hhZG93Um9vdD1yLnByb3RvdHlwZS5jcmVhdGVTaGFkb3dSb290KSxkKHIucHJvdG90eXBlLG8pLGQoci5wcm90b3R5cGUsaSksZChyLnByb3RvdHlwZSxzKSxkKHIucHJvdG90eXBlLGMpLGQoci5wcm90b3R5cGUsbCkscChtLHIsZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKG51bGwsXCJ4XCIpKSxlLmludmFsaWRhdGVSZW5kZXJlckJhc2VkT25BdHRyaWJ1dGU9dCxlLm1hdGNoZXNOYW1lcz13LGUub3JpZ2luYWxNYXRjaGVzPWcsZS53cmFwcGVycy5FbGVtZW50PXJ9KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXtzd2l0Y2goZSl7Y2FzZVwiJlwiOnJldHVyblwiJmFtcDtcIjtjYXNlXCI8XCI6cmV0dXJuXCImbHQ7XCI7Y2FzZVwiPlwiOnJldHVyblwiJmd0O1wiO2Nhc2UnXCInOnJldHVyblwiJnF1b3Q7XCI7Y2FzZVwiwqBcIjpyZXR1cm5cIiZuYnNwO1wifX1mdW5jdGlvbiBuKGUpe3JldHVybiBlLnJlcGxhY2UoTCx0KX1mdW5jdGlvbiByKGUpe3JldHVybiBlLnJlcGxhY2UoTix0KX1mdW5jdGlvbiBvKGUpe2Zvcih2YXIgdD17fSxuPTA7bjxlLmxlbmd0aDtuKyspdFtlW25dXT0hMDtyZXR1cm4gdH1mdW5jdGlvbiBpKGUpe2lmKGUubmFtZXNwYWNlVVJJIT09RClyZXR1cm4hMDt2YXIgdD1lLm93bmVyRG9jdW1lbnQuZG9jdHlwZTtyZXR1cm4gdCYmdC5wdWJsaWNJZCYmdC5zeXN0ZW1JZH1mdW5jdGlvbiBhKGUsdCl7c3dpdGNoKGUubm9kZVR5cGUpe2Nhc2UgTm9kZS5FTEVNRU5UX05PREU6Zm9yKHZhciBvLGE9ZS50YWdOYW1lLnRvTG93ZXJDYXNlKCksYz1cIjxcIithLGw9ZS5hdHRyaWJ1dGVzLHU9MDtvPWxbdV07dSsrKWMrPVwiIFwiK28ubmFtZSsnPVwiJytuKG8udmFsdWUpKydcIic7cmV0dXJuIENbYV0/KGkoZSkmJihjKz1cIi9cIiksYytcIj5cIik6YytcIj5cIitzKGUpK1wiPC9cIithK1wiPlwiO2Nhc2UgTm9kZS5URVhUX05PREU6dmFyIGQ9ZS5kYXRhO3JldHVybiB0JiZqW3QubG9jYWxOYW1lXT9kOnIoZCk7Y2FzZSBOb2RlLkNPTU1FTlRfTk9ERTpyZXR1cm5cIjwhLS1cIitlLmRhdGErXCItLT5cIjtkZWZhdWx0OnRocm93IGNvbnNvbGUuZXJyb3IoZSksbmV3IEVycm9yKFwibm90IGltcGxlbWVudGVkXCIpfX1mdW5jdGlvbiBzKGUpe2UgaW5zdGFuY2VvZiBPLkhUTUxUZW1wbGF0ZUVsZW1lbnQmJihlPWUuY29udGVudCk7Zm9yKHZhciB0PVwiXCIsbj1lLmZpcnN0Q2hpbGQ7bjtuPW4ubmV4dFNpYmxpbmcpdCs9YShuLGUpO3JldHVybiB0fWZ1bmN0aW9uIGMoZSx0LG4pe3ZhciByPW58fFwiZGl2XCI7ZS50ZXh0Q29udGVudD1cIlwiO3ZhciBvPVQoZS5vd25lckRvY3VtZW50LmNyZWF0ZUVsZW1lbnQocikpO28uaW5uZXJIVE1MPXQ7Zm9yKHZhciBpO2k9by5maXJzdENoaWxkOyllLmFwcGVuZENoaWxkKE0oaSkpfWZ1bmN0aW9uIGwoZSl7bS5jYWxsKHRoaXMsZSl9ZnVuY3Rpb24gdShlLHQpe3ZhciBuPVQoZS5jbG9uZU5vZGUoITEpKTtuLmlubmVySFRNTD10O2Zvcih2YXIgcixvPVQoZG9jdW1lbnQuY3JlYXRlRG9jdW1lbnRGcmFnbWVudCgpKTtyPW4uZmlyc3RDaGlsZDspby5hcHBlbmRDaGlsZChyKTtyZXR1cm4gTShvKX1mdW5jdGlvbiBkKHQpe3JldHVybiBmdW5jdGlvbigpe3JldHVybiBlLnJlbmRlckFsbFBlbmRpbmcoKSxTKHRoaXMpW3RdfX1mdW5jdGlvbiBwKGUpe3cobCxlLGQoZSkpfWZ1bmN0aW9uIGgodCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KGwucHJvdG90eXBlLHQse2dldDpkKHQpLHNldDpmdW5jdGlvbihuKXtlLnJlbmRlckFsbFBlbmRpbmcoKSxTKHRoaXMpW3RdPW59LGNvbmZpZ3VyYWJsZTohMCxlbnVtZXJhYmxlOiEwfSl9ZnVuY3Rpb24gZih0KXtPYmplY3QuZGVmaW5lUHJvcGVydHkobC5wcm90b3R5cGUsdCx7dmFsdWU6ZnVuY3Rpb24oKXtyZXR1cm4gZS5yZW5kZXJBbGxQZW5kaW5nKCksUyh0aGlzKVt0XS5hcHBseShTKHRoaXMpLGFyZ3VtZW50cyl9LGNvbmZpZ3VyYWJsZTohMCxlbnVtZXJhYmxlOiEwfSl9dmFyIG09ZS53cmFwcGVycy5FbGVtZW50LHc9ZS5kZWZpbmVHZXR0ZXIsdj1lLmVucXVldWVNdXRhdGlvbixnPWUubWl4aW4sYj1lLm5vZGVzV2VyZUFkZGVkLHk9ZS5ub2Rlc1dlcmVSZW1vdmVkLEU9ZS5yZWdpc3RlcldyYXBwZXIsXz1lLnNuYXBzaG90Tm9kZUxpc3QsUz1lLnVuc2FmZVVud3JhcCxUPWUudW53cmFwLE09ZS53cmFwLE89ZS53cmFwcGVycyxMPS9bJlxcdTAwQTBcIl0vZyxOPS9bJlxcdTAwQTA8Pl0vZyxDPW8oW1wiYXJlYVwiLFwiYmFzZVwiLFwiYnJcIixcImNvbFwiLFwiY29tbWFuZFwiLFwiZW1iZWRcIixcImhyXCIsXCJpbWdcIixcImlucHV0XCIsXCJrZXlnZW5cIixcImxpbmtcIixcIm1ldGFcIixcInBhcmFtXCIsXCJzb3VyY2VcIixcInRyYWNrXCIsXCJ3YnJcIl0pLGo9byhbXCJzdHlsZVwiLFwic2NyaXB0XCIsXCJ4bXBcIixcImlmcmFtZVwiLFwibm9lbWJlZFwiLFwibm9mcmFtZXNcIixcInBsYWludGV4dFwiLFwibm9zY3JpcHRcIl0pLEQ9XCJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hodG1sXCIsSD0vTVNJRS8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSx4PXdpbmRvdy5IVE1MRWxlbWVudCxSPXdpbmRvdy5IVE1MVGVtcGxhdGVFbGVtZW50O2wucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobS5wcm90b3R5cGUpLGcobC5wcm90b3R5cGUse2dldCBpbm5lckhUTUwoKXtyZXR1cm4gcyh0aGlzKX0sc2V0IGlubmVySFRNTChlKXtpZihIJiZqW3RoaXMubG9jYWxOYW1lXSlyZXR1cm4gdm9pZCh0aGlzLnRleHRDb250ZW50PWUpO3ZhciB0PV8odGhpcy5jaGlsZE5vZGVzKTt0aGlzLmludmFsaWRhdGVTaGFkb3dSZW5kZXJlcigpP3RoaXMgaW5zdGFuY2VvZiBPLkhUTUxUZW1wbGF0ZUVsZW1lbnQ/Yyh0aGlzLmNvbnRlbnQsZSk6Yyh0aGlzLGUsdGhpcy50YWdOYW1lKTohUiYmdGhpcyBpbnN0YW5jZW9mIE8uSFRNTFRlbXBsYXRlRWxlbWVudD9jKHRoaXMuY29udGVudCxlKTpTKHRoaXMpLmlubmVySFRNTD1lO3ZhciBuPV8odGhpcy5jaGlsZE5vZGVzKTt2KHRoaXMsXCJjaGlsZExpc3RcIix7YWRkZWROb2RlczpuLHJlbW92ZWROb2Rlczp0fSkseSh0KSxiKG4sdGhpcyl9LGdldCBvdXRlckhUTUwoKXtyZXR1cm4gYSh0aGlzLHRoaXMucGFyZW50Tm9kZSl9LHNldCBvdXRlckhUTUwoZSl7dmFyIHQ9dGhpcy5wYXJlbnROb2RlO2lmKHQpe3QuaW52YWxpZGF0ZVNoYWRvd1JlbmRlcmVyKCk7dmFyIG49dSh0LGUpO3QucmVwbGFjZUNoaWxkKG4sdGhpcyl9fSxpbnNlcnRBZGphY2VudEhUTUw6ZnVuY3Rpb24oZSx0KXt2YXIgbixyO3N3aXRjaChTdHJpbmcoZSkudG9Mb3dlckNhc2UoKSl7Y2FzZVwiYmVmb3JlYmVnaW5cIjpuPXRoaXMucGFyZW50Tm9kZSxyPXRoaXM7YnJlYWs7Y2FzZVwiYWZ0ZXJlbmRcIjpuPXRoaXMucGFyZW50Tm9kZSxyPXRoaXMubmV4dFNpYmxpbmc7YnJlYWs7Y2FzZVwiYWZ0ZXJiZWdpblwiOm49dGhpcyxyPXRoaXMuZmlyc3RDaGlsZDticmVhaztjYXNlXCJiZWZvcmVlbmRcIjpuPXRoaXMscj1udWxsO2JyZWFrO2RlZmF1bHQ6cmV0dXJufXZhciBvPXUobix0KTtuLmluc2VydEJlZm9yZShvLHIpfSxnZXQgaGlkZGVuKCl7cmV0dXJuIHRoaXMuaGFzQXR0cmlidXRlKFwiaGlkZGVuXCIpfSxzZXQgaGlkZGVuKGUpe2U/dGhpcy5zZXRBdHRyaWJ1dGUoXCJoaWRkZW5cIixcIlwiKTp0aGlzLnJlbW92ZUF0dHJpYnV0ZShcImhpZGRlblwiKX19KSxbXCJjbGllbnRIZWlnaHRcIixcImNsaWVudExlZnRcIixcImNsaWVudFRvcFwiLFwiY2xpZW50V2lkdGhcIixcIm9mZnNldEhlaWdodFwiLFwib2Zmc2V0TGVmdFwiLFwib2Zmc2V0VG9wXCIsXCJvZmZzZXRXaWR0aFwiLFwic2Nyb2xsSGVpZ2h0XCIsXCJzY3JvbGxXaWR0aFwiXS5mb3JFYWNoKHApLFtcInNjcm9sbExlZnRcIixcInNjcm9sbFRvcFwiXS5mb3JFYWNoKGgpLFtcImdldEJvdW5kaW5nQ2xpZW50UmVjdFwiLFwiZ2V0Q2xpZW50UmVjdHNcIixcInNjcm9sbEludG9WaWV3XCJdLmZvckVhY2goZiksRSh4LGwsZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImJcIikpLGUud3JhcHBlcnMuSFRNTEVsZW1lbnQ9bCxlLmdldElubmVySFRNTD1zLGUuc2V0SW5uZXJIVE1MPWN9KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXtuLmNhbGwodGhpcyxlKX12YXIgbj1lLndyYXBwZXJzLkhUTUxFbGVtZW50LHI9ZS5taXhpbixvPWUucmVnaXN0ZXJXcmFwcGVyLGk9ZS51bnNhZmVVbndyYXAsYT1lLndyYXAscz13aW5kb3cuSFRNTENhbnZhc0VsZW1lbnQ7dC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSkscih0LnByb3RvdHlwZSx7Z2V0Q29udGV4dDpmdW5jdGlvbigpe3ZhciBlPWkodGhpcykuZ2V0Q29udGV4dC5hcHBseShpKHRoaXMpLGFyZ3VtZW50cyk7cmV0dXJuIGUmJmEoZSl9fSksbyhzLHQsZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKSksZS53cmFwcGVycy5IVE1MQ2FudmFzRWxlbWVudD10fSh3aW5kb3cuU2hhZG93RE9NUG9seWZpbGwpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHQoZSl7bi5jYWxsKHRoaXMsZSl9dmFyIG49ZS53cmFwcGVycy5IVE1MRWxlbWVudCxyPWUubWl4aW4sbz1lLnJlZ2lzdGVyV3JhcHBlcixpPXdpbmRvdy5IVE1MQ29udGVudEVsZW1lbnQ7dC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSkscih0LnByb3RvdHlwZSx7Y29uc3RydWN0b3I6dCxnZXQgc2VsZWN0KCl7cmV0dXJuIHRoaXMuZ2V0QXR0cmlidXRlKFwic2VsZWN0XCIpfSxzZXQgc2VsZWN0KGUpe3RoaXMuc2V0QXR0cmlidXRlKFwic2VsZWN0XCIsZSl9LHNldEF0dHJpYnV0ZTpmdW5jdGlvbihlLHQpe24ucHJvdG90eXBlLnNldEF0dHJpYnV0ZS5jYWxsKHRoaXMsZSx0KSxcInNlbGVjdFwiPT09U3RyaW5nKGUpLnRvTG93ZXJDYXNlKCkmJnRoaXMuaW52YWxpZGF0ZVNoYWRvd1JlbmRlcmVyKCEwKX19KSxpJiZvKGksdCksZS53cmFwcGVycy5IVE1MQ29udGVudEVsZW1lbnQ9dH0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUpe24uY2FsbCh0aGlzLGUpfXZhciBuPWUud3JhcHBlcnMuSFRNTEVsZW1lbnQscj1lLm1peGluLG89ZS5yZWdpc3RlcldyYXBwZXIsaT1lLndyYXBIVE1MQ29sbGVjdGlvbixhPWUudW53cmFwLHM9d2luZG93LkhUTUxGb3JtRWxlbWVudDt0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSxyKHQucHJvdG90eXBlLHtnZXQgZWxlbWVudHMoKXtyZXR1cm4gaShhKHRoaXMpLmVsZW1lbnRzKX19KSxvKHMsdCxkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZm9ybVwiKSksZS53cmFwcGVycy5IVE1MRm9ybUVsZW1lbnQ9dH0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUpe3IuY2FsbCh0aGlzLGUpfWZ1bmN0aW9uIG4oZSx0KXtpZighKHRoaXMgaW5zdGFuY2VvZiBuKSl0aHJvdyBuZXcgVHlwZUVycm9yKFwiRE9NIG9iamVjdCBjb25zdHJ1Y3RvciBjYW5ub3QgYmUgY2FsbGVkIGFzIGEgZnVuY3Rpb24uXCIpO3ZhciBvPWkoZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKSk7ci5jYWxsKHRoaXMsbyksYShvLHRoaXMpLHZvaWQgMCE9PWUmJihvLndpZHRoPWUpLHZvaWQgMCE9PXQmJihvLmhlaWdodD10KX12YXIgcj1lLndyYXBwZXJzLkhUTUxFbGVtZW50LG89ZS5yZWdpc3RlcldyYXBwZXIsaT1lLnVud3JhcCxhPWUucmV3cmFwLHM9d2luZG93LkhUTUxJbWFnZUVsZW1lbnQ7dC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShyLnByb3RvdHlwZSksbyhzLHQsZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImltZ1wiKSksbi5wcm90b3R5cGU9dC5wcm90b3R5cGUsZS53cmFwcGVycy5IVE1MSW1hZ2VFbGVtZW50PXQsZS53cmFwcGVycy5JbWFnZT1ufSh3aW5kb3cuU2hhZG93RE9NUG9seWZpbGwpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHQoZSl7bi5jYWxsKHRoaXMsZSl9dmFyIG49ZS53cmFwcGVycy5IVE1MRWxlbWVudCxyPShlLm1peGluLGUud3JhcHBlcnMuTm9kZUxpc3QsZS5yZWdpc3RlcldyYXBwZXIpLG89d2luZG93LkhUTUxTaGFkb3dFbGVtZW50O3QucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobi5wcm90b3R5cGUpLHQucHJvdG90eXBlLmNvbnN0cnVjdG9yPXQsbyYmcihvLHQpLGUud3JhcHBlcnMuSFRNTFNoYWRvd0VsZW1lbnQ9dH0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUpe2lmKCFlLmRlZmF1bHRWaWV3KXJldHVybiBlO3ZhciB0PWQuZ2V0KGUpO2lmKCF0KXtmb3IodD1lLmltcGxlbWVudGF0aW9uLmNyZWF0ZUhUTUxEb2N1bWVudChcIlwiKTt0Lmxhc3RDaGlsZDspdC5yZW1vdmVDaGlsZCh0Lmxhc3RDaGlsZCk7ZC5zZXQoZSx0KX1yZXR1cm4gdH1mdW5jdGlvbiBuKGUpe2Zvcih2YXIgbixyPXQoZS5vd25lckRvY3VtZW50KSxvPWMoci5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCkpO249ZS5maXJzdENoaWxkOylvLmFwcGVuZENoaWxkKG4pO3JldHVybiBvfWZ1bmN0aW9uIHIoZSl7aWYoby5jYWxsKHRoaXMsZSksIXApe3ZhciB0PW4oZSk7dS5zZXQodGhpcyxsKHQpKX19dmFyIG89ZS53cmFwcGVycy5IVE1MRWxlbWVudCxpPWUubWl4aW4sYT1lLnJlZ2lzdGVyV3JhcHBlcixzPWUudW5zYWZlVW53cmFwLGM9ZS51bndyYXAsbD1lLndyYXAsdT1uZXcgV2Vha01hcCxkPW5ldyBXZWFrTWFwLHA9d2luZG93LkhUTUxUZW1wbGF0ZUVsZW1lbnQ7ci5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShvLnByb3RvdHlwZSksaShyLnByb3RvdHlwZSx7Y29uc3RydWN0b3I6cixnZXQgY29udGVudCgpe3JldHVybiBwP2wocyh0aGlzKS5jb250ZW50KTp1LmdldCh0aGlzKX19KSxwJiZhKHAsciksZS53cmFwcGVycy5IVE1MVGVtcGxhdGVFbGVtZW50PXJ9KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXtuLmNhbGwodGhpcyxlKX12YXIgbj1lLndyYXBwZXJzLkhUTUxFbGVtZW50LHI9ZS5yZWdpc3RlcldyYXBwZXIsbz13aW5kb3cuSFRNTE1lZGlhRWxlbWVudDtvJiYodC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSkscihvLHQsZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImF1ZGlvXCIpKSxlLndyYXBwZXJzLkhUTUxNZWRpYUVsZW1lbnQ9dCl9KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXtyLmNhbGwodGhpcyxlKX1mdW5jdGlvbiBuKGUpe2lmKCEodGhpcyBpbnN0YW5jZW9mIG4pKXRocm93IG5ldyBUeXBlRXJyb3IoXCJET00gb2JqZWN0IGNvbnN0cnVjdG9yIGNhbm5vdCBiZSBjYWxsZWQgYXMgYSBmdW5jdGlvbi5cIik7dmFyIHQ9aShkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYXVkaW9cIikpO3IuY2FsbCh0aGlzLHQpLGEodCx0aGlzKSx0LnNldEF0dHJpYnV0ZShcInByZWxvYWRcIixcImF1dG9cIiksdm9pZCAwIT09ZSYmdC5zZXRBdHRyaWJ1dGUoXCJzcmNcIixlKX12YXIgcj1lLndyYXBwZXJzLkhUTUxNZWRpYUVsZW1lbnQsbz1lLnJlZ2lzdGVyV3JhcHBlcixpPWUudW53cmFwLGE9ZS5yZXdyYXAscz13aW5kb3cuSFRNTEF1ZGlvRWxlbWVudDtzJiYodC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShyLnByb3RvdHlwZSksbyhzLHQsZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImF1ZGlvXCIpKSxuLnByb3RvdHlwZT10LnByb3RvdHlwZSxlLndyYXBwZXJzLkhUTUxBdWRpb0VsZW1lbnQ9dCxlLndyYXBwZXJzLkF1ZGlvPW4pfSh3aW5kb3cuU2hhZG93RE9NUG9seWZpbGwpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHQoZSl7cmV0dXJuIGUucmVwbGFjZSgvXFxzKy9nLFwiIFwiKS50cmltKCl9ZnVuY3Rpb24gbihlKXtvLmNhbGwodGhpcyxlKX1mdW5jdGlvbiByKGUsdCxuLGkpe2lmKCEodGhpcyBpbnN0YW5jZW9mIHIpKXRocm93IG5ldyBUeXBlRXJyb3IoXCJET00gb2JqZWN0IGNvbnN0cnVjdG9yIGNhbm5vdCBiZSBjYWxsZWQgYXMgYSBmdW5jdGlvbi5cIik7dmFyIGE9Yyhkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpKTtvLmNhbGwodGhpcyxhKSxzKGEsdGhpcyksdm9pZCAwIT09ZSYmKGEudGV4dD1lKSx2b2lkIDAhPT10JiZhLnNldEF0dHJpYnV0ZShcInZhbHVlXCIsdCksbj09PSEwJiZhLnNldEF0dHJpYnV0ZShcInNlbGVjdGVkXCIsXCJcIiksYS5zZWxlY3RlZD1pPT09ITB9dmFyIG89ZS53cmFwcGVycy5IVE1MRWxlbWVudCxpPWUubWl4aW4sYT1lLnJlZ2lzdGVyV3JhcHBlcixzPWUucmV3cmFwLGM9ZS51bndyYXAsbD1lLndyYXAsdT13aW5kb3cuSFRNTE9wdGlvbkVsZW1lbnQ7bi5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShvLnByb3RvdHlwZSksaShuLnByb3RvdHlwZSx7Z2V0IHRleHQoKXtyZXR1cm4gdCh0aGlzLnRleHRDb250ZW50KX0sc2V0IHRleHQoZSl7dGhpcy50ZXh0Q29udGVudD10KFN0cmluZyhlKSl9LGdldCBmb3JtKCl7cmV0dXJuIGwoYyh0aGlzKS5mb3JtKX19KSxhKHUsbixkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwib3B0aW9uXCIpKSxyLnByb3RvdHlwZT1uLnByb3RvdHlwZSxlLndyYXBwZXJzLkhUTUxPcHRpb25FbGVtZW50PW4sZS53cmFwcGVycy5PcHRpb249cn0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUpe24uY2FsbCh0aGlzLGUpfXZhciBuPWUud3JhcHBlcnMuSFRNTEVsZW1lbnQscj1lLm1peGluLG89ZS5yZWdpc3RlcldyYXBwZXIsaT1lLnVud3JhcCxhPWUud3JhcCxzPXdpbmRvdy5IVE1MU2VsZWN0RWxlbWVudDt0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSxyKHQucHJvdG90eXBlLHthZGQ6ZnVuY3Rpb24oZSx0KXtcIm9iamVjdFwiPT10eXBlb2YgdCYmKHQ9aSh0KSksaSh0aGlzKS5hZGQoaShlKSx0KX0scmVtb3ZlOmZ1bmN0aW9uKGUpe3JldHVybiB2b2lkIDA9PT1lP3ZvaWQgbi5wcm90b3R5cGUucmVtb3ZlLmNhbGwodGhpcyk6KFwib2JqZWN0XCI9PXR5cGVvZiBlJiYoZT1pKGUpKSx2b2lkIGkodGhpcykucmVtb3ZlKGUpKX0sZ2V0IGZvcm0oKXtyZXR1cm4gYShpKHRoaXMpLmZvcm0pfX0pLG8ocyx0LGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJzZWxlY3RcIikpLGUud3JhcHBlcnMuSFRNTFNlbGVjdEVsZW1lbnQ9dH0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUpe24uY2FsbCh0aGlzLGUpfXZhciBuPWUud3JhcHBlcnMuSFRNTEVsZW1lbnQscj1lLm1peGluLG89ZS5yZWdpc3RlcldyYXBwZXIsaT1lLnVud3JhcCxhPWUud3JhcCxzPWUud3JhcEhUTUxDb2xsZWN0aW9uLGM9d2luZG93LkhUTUxUYWJsZUVsZW1lbnQ7dC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSkscih0LnByb3RvdHlwZSx7Z2V0IGNhcHRpb24oKXtyZXR1cm4gYShpKHRoaXMpLmNhcHRpb24pfSxjcmVhdGVDYXB0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIGEoaSh0aGlzKS5jcmVhdGVDYXB0aW9uKCkpfSxnZXQgdEhlYWQoKXtyZXR1cm4gYShpKHRoaXMpLnRIZWFkKX0sY3JlYXRlVEhlYWQ6ZnVuY3Rpb24oKXtyZXR1cm4gYShpKHRoaXMpLmNyZWF0ZVRIZWFkKCkpfSxjcmVhdGVURm9vdDpmdW5jdGlvbigpe3JldHVybiBhKGkodGhpcykuY3JlYXRlVEZvb3QoKSl9LGdldCB0Rm9vdCgpe3JldHVybiBhKGkodGhpcykudEZvb3QpfSxnZXQgdEJvZGllcygpe3JldHVybiBzKGkodGhpcykudEJvZGllcyl9LGNyZWF0ZVRCb2R5OmZ1bmN0aW9uKCl7cmV0dXJuIGEoaSh0aGlzKS5jcmVhdGVUQm9keSgpKX0sZ2V0IHJvd3MoKXtyZXR1cm4gcyhpKHRoaXMpLnJvd3MpfSxpbnNlcnRSb3c6ZnVuY3Rpb24oZSl7cmV0dXJuIGEoaSh0aGlzKS5pbnNlcnRSb3coZSkpfX0pLG8oYyx0LGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJ0YWJsZVwiKSksZS53cmFwcGVycy5IVE1MVGFibGVFbGVtZW50PXR9KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXtuLmNhbGwodGhpcyxlKX12YXIgbj1lLndyYXBwZXJzLkhUTUxFbGVtZW50LHI9ZS5taXhpbixvPWUucmVnaXN0ZXJXcmFwcGVyLGk9ZS53cmFwSFRNTENvbGxlY3Rpb24sYT1lLnVud3JhcCxzPWUud3JhcCxjPXdpbmRvdy5IVE1MVGFibGVTZWN0aW9uRWxlbWVudDt0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSxyKHQucHJvdG90eXBlLHtjb25zdHJ1Y3Rvcjp0LGdldCByb3dzKCl7cmV0dXJuIGkoYSh0aGlzKS5yb3dzKX0saW5zZXJ0Um93OmZ1bmN0aW9uKGUpe3JldHVybiBzKGEodGhpcykuaW5zZXJ0Um93KGUpKX19KSxvKGMsdCxkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidGhlYWRcIikpLGUud3JhcHBlcnMuSFRNTFRhYmxlU2VjdGlvbkVsZW1lbnQ9dH0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUpe24uY2FsbCh0aGlzLGUpfXZhciBuPWUud3JhcHBlcnMuSFRNTEVsZW1lbnQscj1lLm1peGluLG89ZS5yZWdpc3RlcldyYXBwZXIsaT1lLndyYXBIVE1MQ29sbGVjdGlvbixhPWUudW53cmFwLHM9ZS53cmFwLGM9d2luZG93LkhUTUxUYWJsZVJvd0VsZW1lbnQ7dC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSkscih0LnByb3RvdHlwZSx7Z2V0IGNlbGxzKCl7cmV0dXJuIGkoYSh0aGlzKS5jZWxscyl9LGluc2VydENlbGw6ZnVuY3Rpb24oZSl7cmV0dXJuIHMoYSh0aGlzKS5pbnNlcnRDZWxsKGUpKX19KSxvKGMsdCxkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwidHJcIikpLGUud3JhcHBlcnMuSFRNTFRhYmxlUm93RWxlbWVudD10fSh3aW5kb3cuU2hhZG93RE9NUG9seWZpbGwpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHQoZSl7c3dpdGNoKGUubG9jYWxOYW1lKXtjYXNlXCJjb250ZW50XCI6cmV0dXJuIG5ldyBuKGUpO2Nhc2VcInNoYWRvd1wiOnJldHVybiBuZXcgbyhlKTtjYXNlXCJ0ZW1wbGF0ZVwiOnJldHVybiBuZXcgaShlKX1yLmNhbGwodGhpcyxlKX12YXIgbj1lLndyYXBwZXJzLkhUTUxDb250ZW50RWxlbWVudCxyPWUud3JhcHBlcnMuSFRNTEVsZW1lbnQsbz1lLndyYXBwZXJzLkhUTUxTaGFkb3dFbGVtZW50LGk9ZS53cmFwcGVycy5IVE1MVGVtcGxhdGVFbGVtZW50LGE9KGUubWl4aW4sZS5yZWdpc3RlcldyYXBwZXIpLHM9d2luZG93LkhUTUxVbmtub3duRWxlbWVudDt0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKHIucHJvdG90eXBlKSxhKHMsdCksZS53cmFwcGVycy5IVE1MVW5rbm93bkVsZW1lbnQ9dH0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUpe24uY2FsbCh0aGlzLGUpfXZhciBuPWUud3JhcHBlcnMuRWxlbWVudCxyPWUud3JhcHBlcnMuSFRNTEVsZW1lbnQsbz1lLnJlZ2lzdGVyV3JhcHBlcixpPShlLmRlZmluZVdyYXBHZXR0ZXIsZS51bnNhZmVVbndyYXApLGE9ZS53cmFwLHM9ZS5taXhpbixjPVwiaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmdcIixsPXdpbmRvdy5TVkdFbGVtZW50LHU9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKGMsXCJ0aXRsZVwiKTtpZighKFwiY2xhc3NMaXN0XCJpbiB1KSl7dmFyIGQ9T2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihuLnByb3RvdHlwZSxcImNsYXNzTGlzdFwiKTtPYmplY3QuZGVmaW5lUHJvcGVydHkoci5wcm90b3R5cGUsXCJjbGFzc0xpc3RcIixkKSxkZWxldGUgbi5wcm90b3R5cGUuY2xhc3NMaXN0fXQucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobi5wcm90b3R5cGUpLHModC5wcm90b3R5cGUse2dldCBvd25lclNWR0VsZW1lbnQoKXtyZXR1cm4gYShpKHRoaXMpLm93bmVyU1ZHRWxlbWVudCl9fSksbyhsLHQsZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKGMsXCJ0aXRsZVwiKSksZS53cmFwcGVycy5TVkdFbGVtZW50PXR9KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXtwLmNhbGwodGhpcyxlKX12YXIgbj1lLm1peGluLHI9ZS5yZWdpc3RlcldyYXBwZXIsbz1lLnVud3JhcCxpPWUud3JhcCxhPXdpbmRvdy5TVkdVc2VFbGVtZW50LHM9XCJodHRwOi8vd3d3LnczLm9yZy8yMDAwL3N2Z1wiLGM9aShkb2N1bWVudC5jcmVhdGVFbGVtZW50TlMocyxcImdcIikpLGw9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudE5TKHMsXCJ1c2VcIiksdT1jLmNvbnN0cnVjdG9yLGQ9T2JqZWN0LmdldFByb3RvdHlwZU9mKHUucHJvdG90eXBlKSxwPWQuY29uc3RydWN0b3I7dC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShkKSxcImluc3RhbmNlUm9vdFwiaW4gbCYmbih0LnByb3RvdHlwZSx7Z2V0IGluc3RhbmNlUm9vdCgpe3JldHVybiBpKG8odGhpcykuaW5zdGFuY2VSb290KX0sZ2V0IGFuaW1hdGVkSW5zdGFuY2VSb290KCl7cmV0dXJuIGkobyh0aGlzKS5hbmltYXRlZEluc3RhbmNlUm9vdCl9fSkscihhLHQsbCksZS53cmFwcGVycy5TVkdVc2VFbGVtZW50PXR9KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXtuLmNhbGwodGhpcyxlKX12YXIgbj1lLndyYXBwZXJzLkV2ZW50VGFyZ2V0LHI9ZS5taXhpbixvPWUucmVnaXN0ZXJXcmFwcGVyLGk9ZS51bnNhZmVVbndyYXAsYT1lLndyYXAscz13aW5kb3cuU1ZHRWxlbWVudEluc3RhbmNlO3MmJih0LnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKG4ucHJvdG90eXBlKSxyKHQucHJvdG90eXBlLHtnZXQgY29ycmVzcG9uZGluZ0VsZW1lbnQoKXtyZXR1cm4gYShpKHRoaXMpLmNvcnJlc3BvbmRpbmdFbGVtZW50KX0sZ2V0IGNvcnJlc3BvbmRpbmdVc2VFbGVtZW50KCl7cmV0dXJuIGEoaSh0aGlzKS5jb3JyZXNwb25kaW5nVXNlRWxlbWVudCl9LGdldCBwYXJlbnROb2RlKCl7cmV0dXJuIGEoaSh0aGlzKS5wYXJlbnROb2RlKX0sZ2V0IGNoaWxkTm9kZXMoKXt0aHJvdyBuZXcgRXJyb3IoXCJOb3QgaW1wbGVtZW50ZWRcIil9LGdldCBmaXJzdENoaWxkKCl7cmV0dXJuIGEoaSh0aGlzKS5maXJzdENoaWxkKX0sZ2V0IGxhc3RDaGlsZCgpe3JldHVybiBhKGkodGhpcykubGFzdENoaWxkKX0sZ2V0IHByZXZpb3VzU2libGluZygpe3JldHVybiBhKGkodGhpcykucHJldmlvdXNTaWJsaW5nKX0sZ2V0IG5leHRTaWJsaW5nKCl7cmV0dXJuIGEoaSh0aGlzKS5uZXh0U2libGluZyl9fSksbyhzLHQpLGUud3JhcHBlcnMuU1ZHRWxlbWVudEluc3RhbmNlPXQpfSh3aW5kb3cuU2hhZG93RE9NUG9seWZpbGwpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHQoZSl7byhlLHRoaXMpfXZhciBuPWUubWl4aW4scj1lLnJlZ2lzdGVyV3JhcHBlcixvPWUuc2V0V3JhcHBlcixpPWUudW5zYWZlVW53cmFwLGE9ZS51bndyYXAscz1lLnVud3JhcElmTmVlZGVkLGM9ZS53cmFwLGw9d2luZG93LkNhbnZhc1JlbmRlcmluZ0NvbnRleHQyRDtuKHQucHJvdG90eXBlLHtnZXQgY2FudmFzKCl7cmV0dXJuIGMoaSh0aGlzKS5jYW52YXMpfSxkcmF3SW1hZ2U6ZnVuY3Rpb24oKXthcmd1bWVudHNbMF09cyhhcmd1bWVudHNbMF0pLGkodGhpcykuZHJhd0ltYWdlLmFwcGx5KGkodGhpcyksYXJndW1lbnRzKX0sY3JlYXRlUGF0dGVybjpmdW5jdGlvbigpe3JldHVybiBhcmd1bWVudHNbMF09YShhcmd1bWVudHNbMF0pLGkodGhpcykuY3JlYXRlUGF0dGVybi5hcHBseShpKHRoaXMpLGFyZ3VtZW50cyl9fSkscihsLHQsZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImNhbnZhc1wiKS5nZXRDb250ZXh0KFwiMmRcIikpLGUud3JhcHBlcnMuQ2FudmFzUmVuZGVyaW5nQ29udGV4dDJEPXR9KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXtvKGUsdGhpcyl9dmFyIG49ZS5taXhpbixyPWUucmVnaXN0ZXJXcmFwcGVyLG89ZS5zZXRXcmFwcGVyLGk9ZS51bnNhZmVVbndyYXAsYT1lLnVud3JhcElmTmVlZGVkLHM9ZS53cmFwLGM9d2luZG93LldlYkdMUmVuZGVyaW5nQ29udGV4dDtpZihjKXtuKHQucHJvdG90eXBlLHtnZXQgY2FudmFzKCl7cmV0dXJuIHMoaSh0aGlzKS5jYW52YXMpfSx0ZXhJbWFnZTJEOmZ1bmN0aW9uKCl7YXJndW1lbnRzWzVdPWEoYXJndW1lbnRzWzVdKSxpKHRoaXMpLnRleEltYWdlMkQuYXBwbHkoaSh0aGlzKSxhcmd1bWVudHMpfSx0ZXhTdWJJbWFnZTJEOmZ1bmN0aW9uKCl7YXJndW1lbnRzWzZdPWEoYXJndW1lbnRzWzZdKSxpKHRoaXMpLnRleFN1YkltYWdlMkQuYXBwbHkoaSh0aGlzKSxhcmd1bWVudHMpfX0pO3ZhciBsPS9XZWJLaXQvLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk/e2RyYXdpbmdCdWZmZXJIZWlnaHQ6bnVsbCxkcmF3aW5nQnVmZmVyV2lkdGg6bnVsbH06e307cihjLHQsbCksZS53cmFwcGVycy5XZWJHTFJlbmRlcmluZ0NvbnRleHQ9dH19KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXtuLmNhbGwodGhpcyxlKX12YXIgbj1lLndyYXBwZXJzLk5vZGUscj1lLkdldEVsZW1lbnRzQnlJbnRlcmZhY2Usbz1lLk5vbkVsZW1lbnRQYXJlbnROb2RlSW50ZXJmYWNlLGk9ZS5QYXJlbnROb2RlSW50ZXJmYWNlLGE9ZS5TZWxlY3RvcnNJbnRlcmZhY2Uscz1lLm1peGluLGM9ZS5yZWdpc3Rlck9iamVjdCxsPWUucmVnaXN0ZXJXcmFwcGVyLHU9d2luZG93LkRvY3VtZW50RnJhZ21lbnQ7dC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSkscyh0LnByb3RvdHlwZSxpKSxzKHQucHJvdG90eXBlLGEpLHModC5wcm90b3R5cGUscikscyh0LnByb3RvdHlwZSxvKSxsKHUsdCxkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCkpLGUud3JhcHBlcnMuRG9jdW1lbnRGcmFnbWVudD10O3ZhciBkPWMoZG9jdW1lbnQuY3JlYXRlQ29tbWVudChcIlwiKSk7ZS53cmFwcGVycy5Db21tZW50PWR9KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXt2YXIgdD1kKHUoZSkub3duZXJEb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCkpO24uY2FsbCh0aGlzLHQpLGModCx0aGlzKTt2YXIgbz1lLnNoYWRvd1Jvb3Q7aC5zZXQodGhpcyxvKSx0aGlzLnRyZWVTY29wZV89bmV3IHIodGhpcyxhKG98fGUpKSxwLnNldCh0aGlzLGUpfXZhciBuPWUud3JhcHBlcnMuRG9jdW1lbnRGcmFnbWVudCxyPWUuVHJlZVNjb3BlLG89ZS5lbGVtZW50RnJvbVBvaW50LGk9ZS5nZXRJbm5lckhUTUwsYT1lLmdldFRyZWVTY29wZSxzPWUubWl4aW4sYz1lLnJld3JhcCxsPWUuc2V0SW5uZXJIVE1MLHU9ZS51bnNhZmVVbndyYXAsZD1lLnVud3JhcCxwPW5ldyBXZWFrTWFwLGg9bmV3IFdlYWtNYXA7dC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSkscyh0LnByb3RvdHlwZSx7Y29uc3RydWN0b3I6dCxnZXQgaW5uZXJIVE1MKCl7cmV0dXJuIGkodGhpcyl9LHNldCBpbm5lckhUTUwoZSl7bCh0aGlzLGUpLHRoaXMuaW52YWxpZGF0ZVNoYWRvd1JlbmRlcmVyKCl9LGdldCBvbGRlclNoYWRvd1Jvb3QoKXtyZXR1cm4gaC5nZXQodGhpcyl8fG51bGx9LGdldCBob3N0KCl7cmV0dXJuIHAuZ2V0KHRoaXMpfHxudWxsfSxpbnZhbGlkYXRlU2hhZG93UmVuZGVyZXI6ZnVuY3Rpb24oKXtyZXR1cm4gcC5nZXQodGhpcykuaW52YWxpZGF0ZVNoYWRvd1JlbmRlcmVyKCl9LGVsZW1lbnRGcm9tUG9pbnQ6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbyh0aGlzLHRoaXMub3duZXJEb2N1bWVudCxlLHQpfX0pLGUud3JhcHBlcnMuU2hhZG93Um9vdD10fSh3aW5kb3cuU2hhZG93RE9NUG9seWZpbGwpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHQoZSl7dmFyIHQ9ZChlKS5yb290O3JldHVybiB0IGluc3RhbmNlb2YgaD90Lmhvc3Q6bnVsbH1mdW5jdGlvbiBuKHQsbil7aWYodC5zaGFkb3dSb290KXtuPU1hdGgubWluKHQuY2hpbGROb2Rlcy5sZW5ndGgtMSxuKTt2YXIgcj10LmNoaWxkTm9kZXNbbl07aWYocil7dmFyIG89ZS5nZXREZXN0aW5hdGlvbkluc2VydGlvblBvaW50cyhyKTtpZihvLmxlbmd0aD4wKXt2YXIgaT1vWzBdLnBhcmVudE5vZGU7aS5ub2RlVHlwZT09Tm9kZS5FTEVNRU5UX05PREUmJih0PWkpfX19cmV0dXJuIHR9ZnVuY3Rpb24gcihlKXtyZXR1cm4gZT11KGUpLHQoZSl8fGV9ZnVuY3Rpb24gbyhlKXthKGUsdGhpcyl9dmFyIGk9ZS5yZWdpc3RlcldyYXBwZXIsYT1lLnNldFdyYXBwZXIscz1lLnVuc2FmZVVud3JhcCxjPWUudW53cmFwLGw9ZS51bndyYXBJZk5lZWRlZCx1PWUud3JhcCxkPWUuZ2V0VHJlZVNjb3BlLHA9d2luZG93LlJhbmdlLGg9ZS53cmFwcGVycy5TaGFkb3dSb290O28ucHJvdG90eXBlPXtnZXQgc3RhcnRDb250YWluZXIoKXtyZXR1cm4gcihzKHRoaXMpLnN0YXJ0Q29udGFpbmVyKX0sZ2V0IGVuZENvbnRhaW5lcigpe3JldHVybiByKHModGhpcykuZW5kQ29udGFpbmVyKX0sZ2V0IGNvbW1vbkFuY2VzdG9yQ29udGFpbmVyKCl7cmV0dXJuIHIocyh0aGlzKS5jb21tb25BbmNlc3RvckNvbnRhaW5lcil9LHNldFN0YXJ0OmZ1bmN0aW9uKGUsdCl7ZT1uKGUsdCkscyh0aGlzKS5zZXRTdGFydChsKGUpLHQpfSxzZXRFbmQ6ZnVuY3Rpb24oZSx0KXtlPW4oZSx0KSxzKHRoaXMpLnNldEVuZChsKGUpLHQpfSxzZXRTdGFydEJlZm9yZTpmdW5jdGlvbihlKXtzKHRoaXMpLnNldFN0YXJ0QmVmb3JlKGwoZSkpfSxzZXRTdGFydEFmdGVyOmZ1bmN0aW9uKGUpe3ModGhpcykuc2V0U3RhcnRBZnRlcihsKGUpKX0sc2V0RW5kQmVmb3JlOmZ1bmN0aW9uKGUpe3ModGhpcykuc2V0RW5kQmVmb3JlKGwoZSkpfSxzZXRFbmRBZnRlcjpmdW5jdGlvbihlKXtzKHRoaXMpLnNldEVuZEFmdGVyKGwoZSkpfSxzZWxlY3ROb2RlOmZ1bmN0aW9uKGUpe3ModGhpcykuc2VsZWN0Tm9kZShsKGUpKX0sc2VsZWN0Tm9kZUNvbnRlbnRzOmZ1bmN0aW9uKGUpe3ModGhpcykuc2VsZWN0Tm9kZUNvbnRlbnRzKGwoZSkpfSxjb21wYXJlQm91bmRhcnlQb2ludHM6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gcyh0aGlzKS5jb21wYXJlQm91bmRhcnlQb2ludHMoZSxjKHQpKX0sZXh0cmFjdENvbnRlbnRzOmZ1bmN0aW9uKCl7cmV0dXJuIHUocyh0aGlzKS5leHRyYWN0Q29udGVudHMoKSl9LGNsb25lQ29udGVudHM6ZnVuY3Rpb24oKXtyZXR1cm4gdShzKHRoaXMpLmNsb25lQ29udGVudHMoKSl9LGluc2VydE5vZGU6ZnVuY3Rpb24oZSl7cyh0aGlzKS5pbnNlcnROb2RlKGwoZSkpfSxzdXJyb3VuZENvbnRlbnRzOmZ1bmN0aW9uKGUpe3ModGhpcykuc3Vycm91bmRDb250ZW50cyhsKGUpKX0sY2xvbmVSYW5nZTpmdW5jdGlvbigpe3JldHVybiB1KHModGhpcykuY2xvbmVSYW5nZSgpKX0saXNQb2ludEluUmFuZ2U6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gcyh0aGlzKS5pc1BvaW50SW5SYW5nZShsKGUpLHQpfSxjb21wYXJlUG9pbnQ6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gcyh0aGlzKS5jb21wYXJlUG9pbnQobChlKSx0KX0saW50ZXJzZWN0c05vZGU6ZnVuY3Rpb24oZSl7cmV0dXJuIHModGhpcykuaW50ZXJzZWN0c05vZGUobChlKSl9LHRvU3RyaW5nOmZ1bmN0aW9uKCl7cmV0dXJuIHModGhpcykudG9TdHJpbmcoKX19LHAucHJvdG90eXBlLmNyZWF0ZUNvbnRleHR1YWxGcmFnbWVudCYmKG8ucHJvdG90eXBlLmNyZWF0ZUNvbnRleHR1YWxGcmFnbWVudD1mdW5jdGlvbihlKXtyZXR1cm4gdShzKHRoaXMpLmNyZWF0ZUNvbnRleHR1YWxGcmFnbWVudChlKSl9KSxpKHdpbmRvdy5SYW5nZSxvLGRvY3VtZW50LmNyZWF0ZVJhbmdlKCkpLGUud3JhcHBlcnMuUmFuZ2U9b30od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUpe2UucHJldmlvdXNTaWJsaW5nXz1lLnByZXZpb3VzU2libGluZyxlLm5leHRTaWJsaW5nXz1lLm5leHRTaWJsaW5nLGUucGFyZW50Tm9kZV89ZS5wYXJlbnROb2RlfWZ1bmN0aW9uIG4obixvLGkpe3ZhciBhPXgobikscz14KG8pLGM9aT94KGkpOm51bGw7aWYocihvKSx0KG8pLGkpbi5maXJzdENoaWxkPT09aSYmKG4uZmlyc3RDaGlsZF89aSksaS5wcmV2aW91c1NpYmxpbmdfPWkucHJldmlvdXNTaWJsaW5nO2Vsc2V7bi5sYXN0Q2hpbGRfPW4ubGFzdENoaWxkLG4ubGFzdENoaWxkPT09bi5maXJzdENoaWxkJiYobi5maXJzdENoaWxkXz1uLmZpcnN0Q2hpbGQpO3ZhciBsPVIoYS5sYXN0Q2hpbGQpO2wmJihsLm5leHRTaWJsaW5nXz1sLm5leHRTaWJsaW5nKX1lLm9yaWdpbmFsSW5zZXJ0QmVmb3JlLmNhbGwoYSxzLGMpfWZ1bmN0aW9uIHIobil7dmFyIHI9eChuKSxvPXIucGFyZW50Tm9kZTtpZihvKXt2YXIgaT1SKG8pO3Qobiksbi5wcmV2aW91c1NpYmxpbmcmJihuLnByZXZpb3VzU2libGluZy5uZXh0U2libGluZ189biksbi5uZXh0U2libGluZyYmKG4ubmV4dFNpYmxpbmcucHJldmlvdXNTaWJsaW5nXz1uKSxpLmxhc3RDaGlsZD09PW4mJihpLmxhc3RDaGlsZF89biksaS5maXJzdENoaWxkPT09biYmKGkuZmlyc3RDaGlsZF89biksZS5vcmlnaW5hbFJlbW92ZUNoaWxkLmNhbGwobyxyKX19ZnVuY3Rpb24gbyhlKXtQLnNldChlLFtdKX1mdW5jdGlvbiBpKGUpe3ZhciB0PVAuZ2V0KGUpO3JldHVybiB0fHxQLnNldChlLHQ9W10pLHR9ZnVuY3Rpb24gYShlKXtmb3IodmFyIHQ9W10sbj0wLHI9ZS5maXJzdENoaWxkO3I7cj1yLm5leHRTaWJsaW5nKXRbbisrXT1yO3JldHVybiB0fWZ1bmN0aW9uIHMoKXtmb3IodmFyIGU9MDtlPEYubGVuZ3RoO2UrKyl7dmFyIHQ9RltlXSxuPXQucGFyZW50UmVuZGVyZXI7biYmbi5kaXJ0eXx8dC5yZW5kZXIoKX1GPVtdfWZ1bmN0aW9uIGMoKXtUPW51bGwscygpfWZ1bmN0aW9uIGwoZSl7dmFyIHQ9QS5nZXQoZSk7cmV0dXJuIHR8fCh0PW5ldyBoKGUpLEEuc2V0KGUsdCkpLHR9ZnVuY3Rpb24gdShlKXt2YXIgdD1qKGUpLnJvb3Q7cmV0dXJuIHQgaW5zdGFuY2VvZiBDP3Q6bnVsbH1mdW5jdGlvbiBkKGUpe3JldHVybiBsKGUuaG9zdCl9ZnVuY3Rpb24gcChlKXt0aGlzLnNraXA9ITEsdGhpcy5ub2RlPWUsdGhpcy5jaGlsZE5vZGVzPVtdfWZ1bmN0aW9uIGgoZSl7dGhpcy5ob3N0PWUsdGhpcy5kaXJ0eT0hMSx0aGlzLmludmFsaWRhdGVBdHRyaWJ1dGVzKCksdGhpcy5hc3NvY2lhdGVOb2RlKGUpfWZ1bmN0aW9uIGYoZSl7Zm9yKHZhciB0PVtdLG49ZS5maXJzdENoaWxkO247bj1uLm5leHRTaWJsaW5nKUUobik/dC5wdXNoLmFwcGx5KHQsaShuKSk6dC5wdXNoKG4pO3JldHVybiB0fWZ1bmN0aW9uIG0oZSl7aWYoZSBpbnN0YW5jZW9mIEwpcmV0dXJuIGU7aWYoZSBpbnN0YW5jZW9mIE8pcmV0dXJuIG51bGw7Zm9yKHZhciB0PWUuZmlyc3RDaGlsZDt0O3Q9dC5uZXh0U2libGluZyl7dmFyIG49bSh0KTtpZihuKXJldHVybiBufXJldHVybiBudWxsfWZ1bmN0aW9uIHcoZSx0KXtpKHQpLnB1c2goZSk7dmFyIG49ay5nZXQoZSk7bj9uLnB1c2godCk6ay5zZXQoZSxbdF0pfWZ1bmN0aW9uIHYoZSl7cmV0dXJuIGsuZ2V0KGUpfWZ1bmN0aW9uIGcoZSl7ay5zZXQoZSx2b2lkIDApfWZ1bmN0aW9uIGIoZSx0KXt2YXIgbj10LmdldEF0dHJpYnV0ZShcInNlbGVjdFwiKTtpZighbilyZXR1cm4hMDtpZihuPW4udHJpbSgpLCFuKXJldHVybiEwO2lmKCEoZSBpbnN0YW5jZW9mIE0pKXJldHVybiExO2lmKCFxLnRlc3QobikpcmV0dXJuITE7dHJ5e3JldHVybiBlLm1hdGNoZXMobil9Y2F0Y2gocil7cmV0dXJuITF9fWZ1bmN0aW9uIHkoZSx0KXt2YXIgbj12KHQpO3JldHVybiBuJiZuW24ubGVuZ3RoLTFdPT09ZX1mdW5jdGlvbiBFKGUpe3JldHVybiBlIGluc3RhbmNlb2YgT3x8ZSBpbnN0YW5jZW9mIEx9ZnVuY3Rpb24gXyhlKXtyZXR1cm4gZS5zaGFkb3dSb290fWZ1bmN0aW9uIFMoZSl7Zm9yKHZhciB0PVtdLG49ZS5zaGFkb3dSb290O247bj1uLm9sZGVyU2hhZG93Um9vdCl0LnB1c2gobik7cmV0dXJuIHR9dmFyIFQsTT1lLndyYXBwZXJzLkVsZW1lbnQsTz1lLndyYXBwZXJzLkhUTUxDb250ZW50RWxlbWVudCxMPWUud3JhcHBlcnMuSFRNTFNoYWRvd0VsZW1lbnQsTj1lLndyYXBwZXJzLk5vZGUsQz1lLndyYXBwZXJzLlNoYWRvd1Jvb3Qsaj0oZS5hc3NlcnQsZS5nZXRUcmVlU2NvcGUpLEQ9KGUubWl4aW4sZS5vbmVPZiksSD1lLnVuc2FmZVVud3JhcCx4PWUudW53cmFwLFI9ZS53cmFwLEk9ZS5BcnJheVNwbGljZSxQPW5ldyBXZWFrTWFwLGs9bmV3IFdlYWtNYXAsQT1uZXcgV2Vha01hcCxXPUQod2luZG93LFtcInJlcXVlc3RBbmltYXRpb25GcmFtZVwiLFwibW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lXCIsXCJ3ZWJraXRSZXF1ZXN0QW5pbWF0aW9uRnJhbWVcIixcInNldFRpbWVvdXRcIl0pLEY9W10sVT1uZXcgSTtVLmVxdWFscz1mdW5jdGlvbihlLHQpe3JldHVybiB4KGUubm9kZSk9PT10fSxwLnByb3RvdHlwZT17YXBwZW5kOmZ1bmN0aW9uKGUpe3ZhciB0PW5ldyBwKGUpO3JldHVybiB0aGlzLmNoaWxkTm9kZXMucHVzaCh0KSx0fSxzeW5jOmZ1bmN0aW9uKGUpe2lmKCF0aGlzLnNraXApe2Zvcih2YXIgdD10aGlzLm5vZGUsbz10aGlzLmNoaWxkTm9kZXMsaT1hKHgodCkpLHM9ZXx8bmV3IFdlYWtNYXAsYz1VLmNhbGN1bGF0ZVNwbGljZXMobyxpKSxsPTAsdT0wLGQ9MCxwPTA7cDxjLmxlbmd0aDtwKyspe2Zvcih2YXIgaD1jW3BdO2Q8aC5pbmRleDtkKyspdSsrLG9bbCsrXS5zeW5jKHMpO2Zvcih2YXIgZj1oLnJlbW92ZWQubGVuZ3RoLG09MDtmPm07bSsrKXt2YXIgdz1SKGlbdSsrXSk7cy5nZXQodyl8fHIodyl9Zm9yKHZhciB2PWguYWRkZWRDb3VudCxnPWlbdV0mJlIoaVt1XSksbT0wO3Y+bTttKyspe3ZhciBiPW9bbCsrXSx5PWIubm9kZTtuKHQseSxnKSxzLnNldCh5LCEwKSxiLnN5bmMocyl9ZCs9dn1mb3IodmFyIHA9ZDtwPG8ubGVuZ3RoO3ArKylvW3BdLnN5bmMocyl9fX0saC5wcm90b3R5cGU9e3JlbmRlcjpmdW5jdGlvbihlKXtpZih0aGlzLmRpcnR5KXt0aGlzLmludmFsaWRhdGVBdHRyaWJ1dGVzKCk7dmFyIHQ9dGhpcy5ob3N0O3RoaXMuZGlzdHJpYnV0aW9uKHQpO3ZhciBuPWV8fG5ldyBwKHQpO3RoaXMuYnVpbGRSZW5kZXJUcmVlKG4sdCk7dmFyIHI9IWU7ciYmbi5zeW5jKCksdGhpcy5kaXJ0eT0hMX19LGdldCBwYXJlbnRSZW5kZXJlcigpe3JldHVybiBqKHRoaXMuaG9zdCkucmVuZGVyZXJ9LGludmFsaWRhdGU6ZnVuY3Rpb24oKXtpZighdGhpcy5kaXJ0eSl7dGhpcy5kaXJ0eT0hMDt2YXIgZT10aGlzLnBhcmVudFJlbmRlcmVyO2lmKGUmJmUuaW52YWxpZGF0ZSgpLEYucHVzaCh0aGlzKSxUKXJldHVybjtUPXdpbmRvd1tXXShjLDApfX0sZGlzdHJpYnV0aW9uOmZ1bmN0aW9uKGUpe3RoaXMucmVzZXRBbGxTdWJ0cmVlcyhlKSx0aGlzLmRpc3RyaWJ1dGlvblJlc29sdXRpb24oZSl9LHJlc2V0QWxsOmZ1bmN0aW9uKGUpe0UoZSk/byhlKTpnKGUpLHRoaXMucmVzZXRBbGxTdWJ0cmVlcyhlKX0scmVzZXRBbGxTdWJ0cmVlczpmdW5jdGlvbihlKXtmb3IodmFyIHQ9ZS5maXJzdENoaWxkO3Q7dD10Lm5leHRTaWJsaW5nKXRoaXMucmVzZXRBbGwodCk7ZS5zaGFkb3dSb290JiZ0aGlzLnJlc2V0QWxsKGUuc2hhZG93Um9vdCksZS5vbGRlclNoYWRvd1Jvb3QmJnRoaXMucmVzZXRBbGwoZS5vbGRlclNoYWRvd1Jvb3QpfSxkaXN0cmlidXRpb25SZXNvbHV0aW9uOmZ1bmN0aW9uKGUpe2lmKF8oZSkpe2Zvcih2YXIgdD1lLG49Zih0KSxyPVModCksbz0wO288ci5sZW5ndGg7bysrKXRoaXMucG9vbERpc3RyaWJ1dGlvbihyW29dLG4pO2Zvcih2YXIgbz1yLmxlbmd0aC0xO28+PTA7by0tKXt2YXIgaT1yW29dLGE9bShpKTtpZihhKXt2YXIgcz1pLm9sZGVyU2hhZG93Um9vdDtzJiYobj1mKHMpKTtmb3IodmFyIGM9MDtjPG4ubGVuZ3RoO2MrKyl3KG5bY10sYSl9dGhpcy5kaXN0cmlidXRpb25SZXNvbHV0aW9uKGkpfX1mb3IodmFyIGw9ZS5maXJzdENoaWxkO2w7bD1sLm5leHRTaWJsaW5nKXRoaXMuZGlzdHJpYnV0aW9uUmVzb2x1dGlvbihsKX0scG9vbERpc3RyaWJ1dGlvbjpmdW5jdGlvbihlLHQpe2lmKCEoZSBpbnN0YW5jZW9mIEwpKWlmKGUgaW5zdGFuY2VvZiBPKXt2YXIgbj1lO3RoaXMudXBkYXRlRGVwZW5kZW50QXR0cmlidXRlcyhuLmdldEF0dHJpYnV0ZShcInNlbGVjdFwiKSk7Zm9yKHZhciByPSExLG89MDtvPHQubGVuZ3RoO28rKyl7dmFyIGU9dFtvXTtlJiZiKGUsbikmJih3KGUsbiksdFtvXT12b2lkIDAscj0hMCl9aWYoIXIpZm9yKHZhciBpPW4uZmlyc3RDaGlsZDtpO2k9aS5uZXh0U2libGluZyl3KGksbil9ZWxzZSBmb3IodmFyIGk9ZS5maXJzdENoaWxkO2k7aT1pLm5leHRTaWJsaW5nKXRoaXMucG9vbERpc3RyaWJ1dGlvbihpLHQpfSxidWlsZFJlbmRlclRyZWU6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49dGhpcy5jb21wb3NlKHQpLHI9MDtyPG4ubGVuZ3RoO3IrKyl7dmFyIG89bltyXSxpPWUuYXBwZW5kKG8pO3RoaXMuYnVpbGRSZW5kZXJUcmVlKGksbyl9aWYoXyh0KSl7dmFyIGE9bCh0KTthLmRpcnR5PSExfX0sY29tcG9zZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9W10sbj1lLnNoYWRvd1Jvb3R8fGUscj1uLmZpcnN0Q2hpbGQ7cjtyPXIubmV4dFNpYmxpbmcpaWYoRShyKSl7dGhpcy5hc3NvY2lhdGVOb2RlKG4pO2Zvcih2YXIgbz1pKHIpLGE9MDthPG8ubGVuZ3RoO2ErKyl7dmFyIHM9b1thXTt5KHIscykmJnQucHVzaChzKX19ZWxzZSB0LnB1c2gocik7cmV0dXJuIHR9LGludmFsaWRhdGVBdHRyaWJ1dGVzOmZ1bmN0aW9uKCl7dGhpcy5hdHRyaWJ1dGVzPU9iamVjdC5jcmVhdGUobnVsbCl9LHVwZGF0ZURlcGVuZGVudEF0dHJpYnV0ZXM6ZnVuY3Rpb24oZSl7aWYoZSl7dmFyIHQ9dGhpcy5hdHRyaWJ1dGVzOy9cXC5cXHcrLy50ZXN0KGUpJiYodFtcImNsYXNzXCJdPSEwKSwvI1xcdysvLnRlc3QoZSkmJih0LmlkPSEwKSxlLnJlcGxhY2UoL1xcW1xccyooW15cXHM9XFx8flxcXV0rKS9nLGZ1bmN0aW9uKGUsbil7dFtuXT0hMH0pfX0sZGVwZW5kc09uQXR0cmlidXRlOmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmF0dHJpYnV0ZXNbZV19LGFzc29jaWF0ZU5vZGU6ZnVuY3Rpb24oZSl7SChlKS5wb2x5bWVyU2hhZG93UmVuZGVyZXJfPXRoaXN9fTt2YXIgcT0vXig6bm90XFwoKT9bKi4jW2EtekEtWl98XS87Ti5wcm90b3R5cGUuaW52YWxpZGF0ZVNoYWRvd1JlbmRlcmVyPWZ1bmN0aW9uKGUpe3ZhciB0PUgodGhpcykucG9seW1lclNoYWRvd1JlbmRlcmVyXztyZXR1cm4gdD8odC5pbnZhbGlkYXRlKCksITApOiExfSxPLnByb3RvdHlwZS5nZXREaXN0cmlidXRlZE5vZGVzPUwucHJvdG90eXBlLmdldERpc3RyaWJ1dGVkTm9kZXM9ZnVuY3Rpb24oKXtyZXR1cm4gcygpLGkodGhpcyl9LE0ucHJvdG90eXBlLmdldERlc3RpbmF0aW9uSW5zZXJ0aW9uUG9pbnRzPWZ1bmN0aW9uKCl7cmV0dXJuIHMoKSx2KHRoaXMpfHxbXX0sTy5wcm90b3R5cGUubm9kZUlzSW5zZXJ0ZWRfPUwucHJvdG90eXBlLm5vZGVJc0luc2VydGVkXz1mdW5jdGlvbigpe3RoaXMuaW52YWxpZGF0ZVNoYWRvd1JlbmRlcmVyKCk7dmFyIGUsdD11KHRoaXMpO3QmJihlPWQodCkpLEgodGhpcykucG9seW1lclNoYWRvd1JlbmRlcmVyXz1lLGUmJmUuaW52YWxpZGF0ZSgpfSxlLmdldFJlbmRlcmVyRm9ySG9zdD1sLGUuZ2V0U2hhZG93VHJlZXM9UyxlLnJlbmRlckFsbFBlbmRpbmc9cyxlLmdldERlc3RpbmF0aW9uSW5zZXJ0aW9uUG9pbnRzPXYsZS52aXN1YWw9e2luc2VydEJlZm9yZTpuLHJlbW92ZTpyfX0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KHQpe2lmKHdpbmRvd1t0XSl7cighZS53cmFwcGVyc1t0XSk7dmFyIGM9ZnVuY3Rpb24oZSl7bi5jYWxsKHRoaXMsZSl9O2MucHJvdG90eXBlPU9iamVjdC5jcmVhdGUobi5wcm90b3R5cGUpLG8oYy5wcm90b3R5cGUse2dldCBmb3JtKCl7cmV0dXJuIHMoYSh0aGlzKS5mb3JtKX19KSxpKHdpbmRvd1t0XSxjLGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodC5zbGljZSg0LC03KSkpLGUud3JhcHBlcnNbdF09Y319dmFyIG49ZS53cmFwcGVycy5IVE1MRWxlbWVudCxyPWUuYXNzZXJ0LG89ZS5taXhpbixpPWUucmVnaXN0ZXJXcmFwcGVyLGE9ZS51bndyYXAscz1lLndyYXAsYz1bXCJIVE1MQnV0dG9uRWxlbWVudFwiLFwiSFRNTEZpZWxkU2V0RWxlbWVudFwiLFwiSFRNTElucHV0RWxlbWVudFwiLFwiSFRNTEtleWdlbkVsZW1lbnRcIixcIkhUTUxMYWJlbEVsZW1lbnRcIixcIkhUTUxMZWdlbmRFbGVtZW50XCIsXCJIVE1MT2JqZWN0RWxlbWVudFwiLFwiSFRNTE91dHB1dEVsZW1lbnRcIixcIkhUTUxUZXh0QXJlYUVsZW1lbnRcIl07Yy5mb3JFYWNoKHQpfSh3aW5kb3cuU2hhZG93RE9NUG9seWZpbGwpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHQoZSl7cihlLHRoaXMpfXZhciBuPWUucmVnaXN0ZXJXcmFwcGVyLHI9ZS5zZXRXcmFwcGVyLG89ZS51bnNhZmVVbndyYXAsaT1lLnVud3JhcCxhPWUudW53cmFwSWZOZWVkZWQscz1lLndyYXAsYz13aW5kb3cuU2VsZWN0aW9uO3QucHJvdG90eXBlPXtnZXQgYW5jaG9yTm9kZSgpe3JldHVybiBzKG8odGhpcykuYW5jaG9yTm9kZSl9LGdldCBmb2N1c05vZGUoKXtyZXR1cm4gcyhvKHRoaXMpLmZvY3VzTm9kZSl9LGFkZFJhbmdlOmZ1bmN0aW9uKGUpe28odGhpcykuYWRkUmFuZ2UoYShlKSl9LGNvbGxhcHNlOmZ1bmN0aW9uKGUsdCl7byh0aGlzKS5jb2xsYXBzZShhKGUpLHQpfSxjb250YWluc05vZGU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbyh0aGlzKS5jb250YWluc05vZGUoYShlKSx0KX0sZ2V0UmFuZ2VBdDpmdW5jdGlvbihlKXtyZXR1cm4gcyhvKHRoaXMpLmdldFJhbmdlQXQoZSkpfSxyZW1vdmVSYW5nZTpmdW5jdGlvbihlKXtvKHRoaXMpLnJlbW92ZVJhbmdlKGkoZSkpfSxzZWxlY3RBbGxDaGlsZHJlbjpmdW5jdGlvbihlKXtvKHRoaXMpLnNlbGVjdEFsbENoaWxkcmVuKGEoZSkpfSx0b1N0cmluZzpmdW5jdGlvbigpe3JldHVybiBvKHRoaXMpLnRvU3RyaW5nKCl9fSxjLnByb3RvdHlwZS5leHRlbmQmJih0LnByb3RvdHlwZS5leHRlbmQ9ZnVuY3Rpb24oZSx0KXtvKHRoaXMpLmV4dGVuZChhKGUpLHQpfSksbih3aW5kb3cuU2VsZWN0aW9uLHQsd2luZG93LmdldFNlbGVjdGlvbigpKSxlLndyYXBwZXJzLlNlbGVjdGlvbj10fSh3aW5kb3cuU2hhZG93RE9NUG9seWZpbGwpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHQoZSl7cihlLHRoaXMpfXZhciBuPWUucmVnaXN0ZXJXcmFwcGVyLHI9ZS5zZXRXcmFwcGVyLG89ZS51bnNhZmVVbndyYXAsaT1lLnVud3JhcElmTmVlZGVkLGE9ZS53cmFwLHM9d2luZG93LlRyZWVXYWxrZXI7dC5wcm90b3R5cGU9e2dldCByb290KCl7cmV0dXJuIGEobyh0aGlzKS5yb290KX0sZ2V0IGN1cnJlbnROb2RlKCl7cmV0dXJuIGEobyh0aGlzKS5jdXJyZW50Tm9kZSl9LHNldCBjdXJyZW50Tm9kZShlKXtvKHRoaXMpLmN1cnJlbnROb2RlPWkoZSl9LGdldCBmaWx0ZXIoKXtyZXR1cm4gbyh0aGlzKS5maWx0ZXJ9LHBhcmVudE5vZGU6ZnVuY3Rpb24oKXtyZXR1cm4gYShvKHRoaXMpLnBhcmVudE5vZGUoKSl9LGZpcnN0Q2hpbGQ6ZnVuY3Rpb24oKXtyZXR1cm4gYShvKHRoaXMpLmZpcnN0Q2hpbGQoKSl9LGxhc3RDaGlsZDpmdW5jdGlvbigpe3JldHVybiBhKG8odGhpcykubGFzdENoaWxkKCkpfSxwcmV2aW91c1NpYmxpbmc6ZnVuY3Rpb24oKXtyZXR1cm4gYShvKHRoaXMpLnByZXZpb3VzU2libGluZygpKX0scHJldmlvdXNOb2RlOmZ1bmN0aW9uKCl7cmV0dXJuIGEobyh0aGlzKS5wcmV2aW91c05vZGUoKSl9LG5leHROb2RlOmZ1bmN0aW9uKCl7cmV0dXJuIGEobyh0aGlzKS5uZXh0Tm9kZSgpKX19LG4ocyx0KSxlLndyYXBwZXJzLlRyZWVXYWxrZXI9dH0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUpe3UuY2FsbCh0aGlzLGUpLHRoaXMudHJlZVNjb3BlXz1uZXcgdyh0aGlzLG51bGwpfWZ1bmN0aW9uIG4oZSl7dmFyIG49ZG9jdW1lbnRbZV07dC5wcm90b3R5cGVbZV09ZnVuY3Rpb24oKXtyZXR1cm4gQyhuLmFwcGx5KEwodGhpcyksYXJndW1lbnRzKSl9fWZ1bmN0aW9uIHIoZSx0KXtILmNhbGwoTCh0KSxOKGUpKSxvKGUsdCl9ZnVuY3Rpb24gbyhlLHQpe2Uuc2hhZG93Um9vdCYmdC5hZG9wdE5vZGUoZS5zaGFkb3dSb290KSxlIGluc3RhbmNlb2YgbSYmaShlLHQpO2Zvcih2YXIgbj1lLmZpcnN0Q2hpbGQ7bjtuPW4ubmV4dFNpYmxpbmcpbyhuLHQpfWZ1bmN0aW9uIGkoZSx0KXt2YXIgbj1lLm9sZGVyU2hhZG93Um9vdDtuJiZ0LmFkb3B0Tm9kZShuKX1mdW5jdGlvbiBhKGUpe08oZSx0aGlzKX1mdW5jdGlvbiBzKGUsdCl7dmFyIG49ZG9jdW1lbnQuaW1wbGVtZW50YXRpb25bdF07ZS5wcm90b3R5cGVbdF09ZnVuY3Rpb24oKXtyZXR1cm4gQyhuLmFwcGx5KEwodGhpcyksYXJndW1lbnRzKSl9fWZ1bmN0aW9uIGMoZSx0KXt2YXIgbj1kb2N1bWVudC5pbXBsZW1lbnRhdGlvblt0XTtlLnByb3RvdHlwZVt0XT1mdW5jdGlvbigpe3JldHVybiBuLmFwcGx5KEwodGhpcyksYXJndW1lbnRzKX19dmFyIGw9ZS5HZXRFbGVtZW50c0J5SW50ZXJmYWNlLHU9ZS53cmFwcGVycy5Ob2RlLGQ9ZS5QYXJlbnROb2RlSW50ZXJmYWNlLHA9ZS5Ob25FbGVtZW50UGFyZW50Tm9kZUludGVyZmFjZSxoPWUud3JhcHBlcnMuU2VsZWN0aW9uLGY9ZS5TZWxlY3RvcnNJbnRlcmZhY2UsbT1lLndyYXBwZXJzLlNoYWRvd1Jvb3Qsdz1lLlRyZWVTY29wZSx2PWUuY2xvbmVOb2RlLGc9ZS5kZWZpbmVXcmFwR2V0dGVyLGI9ZS5lbGVtZW50RnJvbVBvaW50LHk9ZS5mb3J3YXJkTWV0aG9kc1RvV3JhcHBlcixFPWUubWF0Y2hlc05hbWVzLF89ZS5taXhpbixTPWUucmVnaXN0ZXJXcmFwcGVyLFQ9ZS5yZW5kZXJBbGxQZW5kaW5nLE09ZS5yZXdyYXAsTz1lLnNldFdyYXBwZXIsTD1lLnVuc2FmZVVud3JhcCxOPWUudW53cmFwLEM9ZS53cmFwLGo9ZS53cmFwRXZlbnRUYXJnZXRNZXRob2RzLEQ9KGUud3JhcE5vZGVMaXN0LFxubmV3IFdlYWtNYXApO3QucHJvdG90eXBlPU9iamVjdC5jcmVhdGUodS5wcm90b3R5cGUpLGcodCxcImRvY3VtZW50RWxlbWVudFwiKSxnKHQsXCJib2R5XCIpLGcodCxcImhlYWRcIiksW1wiY3JlYXRlQ29tbWVudFwiLFwiY3JlYXRlRG9jdW1lbnRGcmFnbWVudFwiLFwiY3JlYXRlRWxlbWVudFwiLFwiY3JlYXRlRWxlbWVudE5TXCIsXCJjcmVhdGVFdmVudFwiLFwiY3JlYXRlRXZlbnROU1wiLFwiY3JlYXRlUmFuZ2VcIixcImNyZWF0ZVRleHROb2RlXCJdLmZvckVhY2gobik7dmFyIEg9ZG9jdW1lbnQuYWRvcHROb2RlLHg9ZG9jdW1lbnQuZ2V0U2VsZWN0aW9uO18odC5wcm90b3R5cGUse2Fkb3B0Tm9kZTpmdW5jdGlvbihlKXtyZXR1cm4gZS5wYXJlbnROb2RlJiZlLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZSkscihlLHRoaXMpLGV9LGVsZW1lbnRGcm9tUG9pbnQ6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gYih0aGlzLHRoaXMsZSx0KX0saW1wb3J0Tm9kZTpmdW5jdGlvbihlLHQpe3JldHVybiB2KGUsdCxMKHRoaXMpKX0sZ2V0U2VsZWN0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIFQoKSxuZXcgaCh4LmNhbGwoTih0aGlzKSkpfSxnZXRFbGVtZW50c0J5TmFtZTpmdW5jdGlvbihlKXtyZXR1cm4gZi5xdWVyeVNlbGVjdG9yQWxsLmNhbGwodGhpcyxcIltuYW1lPVwiK0pTT04uc3RyaW5naWZ5KFN0cmluZyhlKSkrXCJdXCIpfX0pO3ZhciBSPWRvY3VtZW50LmNyZWF0ZVRyZWVXYWxrZXIsST1lLndyYXBwZXJzLlRyZWVXYWxrZXI7aWYodC5wcm90b3R5cGUuY3JlYXRlVHJlZVdhbGtlcj1mdW5jdGlvbihlLHQsbixyKXt2YXIgbz1udWxsO3JldHVybiBuJiYobi5hY2NlcHROb2RlJiZcImZ1bmN0aW9uXCI9PXR5cGVvZiBuLmFjY2VwdE5vZGU/bz17YWNjZXB0Tm9kZTpmdW5jdGlvbihlKXtyZXR1cm4gbi5hY2NlcHROb2RlKEMoZSkpfX06XCJmdW5jdGlvblwiPT10eXBlb2YgbiYmKG89ZnVuY3Rpb24oZSl7cmV0dXJuIG4oQyhlKSl9KSksbmV3IEkoUi5jYWxsKE4odGhpcyksTihlKSx0LG8scikpfSxkb2N1bWVudC5yZWdpc3RlckVsZW1lbnQpe3ZhciBQPWRvY3VtZW50LnJlZ2lzdGVyRWxlbWVudDt0LnByb3RvdHlwZS5yZWdpc3RlckVsZW1lbnQ9ZnVuY3Rpb24odCxuKXtmdW5jdGlvbiByKGUpe3JldHVybiBlP3ZvaWQgTyhlLHRoaXMpOmk/ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChpLHQpOmRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodCl9dmFyIG8saTtpZih2b2lkIDAhPT1uJiYobz1uLnByb3RvdHlwZSxpPW5bXCJleHRlbmRzXCJdKSxvfHwobz1PYmplY3QuY3JlYXRlKEhUTUxFbGVtZW50LnByb3RvdHlwZSkpLGUubmF0aXZlUHJvdG90eXBlVGFibGUuZ2V0KG8pKXRocm93IG5ldyBFcnJvcihcIk5vdFN1cHBvcnRlZEVycm9yXCIpO2Zvcih2YXIgYSxzPU9iamVjdC5nZXRQcm90b3R5cGVPZihvKSxjPVtdO3MmJiEoYT1lLm5hdGl2ZVByb3RvdHlwZVRhYmxlLmdldChzKSk7KWMucHVzaChzKSxzPU9iamVjdC5nZXRQcm90b3R5cGVPZihzKTtpZighYSl0aHJvdyBuZXcgRXJyb3IoXCJOb3RTdXBwb3J0ZWRFcnJvclwiKTtmb3IodmFyIGw9T2JqZWN0LmNyZWF0ZShhKSx1PWMubGVuZ3RoLTE7dT49MDt1LS0pbD1PYmplY3QuY3JlYXRlKGwpO1tcImNyZWF0ZWRDYWxsYmFja1wiLFwiYXR0YWNoZWRDYWxsYmFja1wiLFwiZGV0YWNoZWRDYWxsYmFja1wiLFwiYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrXCJdLmZvckVhY2goZnVuY3Rpb24oZSl7dmFyIHQ9b1tlXTt0JiYobFtlXT1mdW5jdGlvbigpe0ModGhpcylpbnN0YW5jZW9mIHJ8fE0odGhpcyksdC5hcHBseShDKHRoaXMpLGFyZ3VtZW50cyl9KX0pO3ZhciBkPXtwcm90b3R5cGU6bH07aSYmKGRbXCJleHRlbmRzXCJdPWkpLHIucHJvdG90eXBlPW8sci5wcm90b3R5cGUuY29uc3RydWN0b3I9cixlLmNvbnN0cnVjdG9yVGFibGUuc2V0KGwsciksZS5uYXRpdmVQcm90b3R5cGVUYWJsZS5zZXQobyxsKTtQLmNhbGwoTih0aGlzKSx0LGQpO3JldHVybiByfSx5KFt3aW5kb3cuSFRNTERvY3VtZW50fHx3aW5kb3cuRG9jdW1lbnRdLFtcInJlZ2lzdGVyRWxlbWVudFwiXSl9eShbd2luZG93LkhUTUxCb2R5RWxlbWVudCx3aW5kb3cuSFRNTERvY3VtZW50fHx3aW5kb3cuRG9jdW1lbnQsd2luZG93LkhUTUxIZWFkRWxlbWVudCx3aW5kb3cuSFRNTEh0bWxFbGVtZW50XSxbXCJhcHBlbmRDaGlsZFwiLFwiY29tcGFyZURvY3VtZW50UG9zaXRpb25cIixcImNvbnRhaW5zXCIsXCJnZXRFbGVtZW50c0J5Q2xhc3NOYW1lXCIsXCJnZXRFbGVtZW50c0J5VGFnTmFtZVwiLFwiZ2V0RWxlbWVudHNCeVRhZ05hbWVOU1wiLFwiaW5zZXJ0QmVmb3JlXCIsXCJxdWVyeVNlbGVjdG9yXCIsXCJxdWVyeVNlbGVjdG9yQWxsXCIsXCJyZW1vdmVDaGlsZFwiLFwicmVwbGFjZUNoaWxkXCJdKSx5KFt3aW5kb3cuSFRNTEJvZHlFbGVtZW50LHdpbmRvdy5IVE1MSGVhZEVsZW1lbnQsd2luZG93LkhUTUxIdG1sRWxlbWVudF0sRSkseShbd2luZG93LkhUTUxEb2N1bWVudHx8d2luZG93LkRvY3VtZW50XSxbXCJhZG9wdE5vZGVcIixcImltcG9ydE5vZGVcIixcImNvbnRhaW5zXCIsXCJjcmVhdGVDb21tZW50XCIsXCJjcmVhdGVEb2N1bWVudEZyYWdtZW50XCIsXCJjcmVhdGVFbGVtZW50XCIsXCJjcmVhdGVFbGVtZW50TlNcIixcImNyZWF0ZUV2ZW50XCIsXCJjcmVhdGVFdmVudE5TXCIsXCJjcmVhdGVSYW5nZVwiLFwiY3JlYXRlVGV4dE5vZGVcIixcImNyZWF0ZVRyZWVXYWxrZXJcIixcImVsZW1lbnRGcm9tUG9pbnRcIixcImdldEVsZW1lbnRCeUlkXCIsXCJnZXRFbGVtZW50c0J5TmFtZVwiLFwiZ2V0U2VsZWN0aW9uXCJdKSxfKHQucHJvdG90eXBlLGwpLF8odC5wcm90b3R5cGUsZCksXyh0LnByb3RvdHlwZSxmKSxfKHQucHJvdG90eXBlLHApLF8odC5wcm90b3R5cGUse2dldCBpbXBsZW1lbnRhdGlvbigpe3ZhciBlPUQuZ2V0KHRoaXMpO3JldHVybiBlP2U6KGU9bmV3IGEoTih0aGlzKS5pbXBsZW1lbnRhdGlvbiksRC5zZXQodGhpcyxlKSxlKX0sZ2V0IGRlZmF1bHRWaWV3KCl7cmV0dXJuIEMoTih0aGlzKS5kZWZhdWx0Vmlldyl9fSksUyh3aW5kb3cuRG9jdW1lbnQsdCxkb2N1bWVudC5pbXBsZW1lbnRhdGlvbi5jcmVhdGVIVE1MRG9jdW1lbnQoXCJcIikpLHdpbmRvdy5IVE1MRG9jdW1lbnQmJlMod2luZG93LkhUTUxEb2N1bWVudCx0KSxqKFt3aW5kb3cuSFRNTEJvZHlFbGVtZW50LHdpbmRvdy5IVE1MRG9jdW1lbnR8fHdpbmRvdy5Eb2N1bWVudCx3aW5kb3cuSFRNTEhlYWRFbGVtZW50XSk7dmFyIGs9ZG9jdW1lbnQuaW1wbGVtZW50YXRpb24uY3JlYXRlRG9jdW1lbnQ7YS5wcm90b3R5cGUuY3JlYXRlRG9jdW1lbnQ9ZnVuY3Rpb24oKXtyZXR1cm4gYXJndW1lbnRzWzJdPU4oYXJndW1lbnRzWzJdKSxDKGsuYXBwbHkoTCh0aGlzKSxhcmd1bWVudHMpKX0scyhhLFwiY3JlYXRlRG9jdW1lbnRUeXBlXCIpLHMoYSxcImNyZWF0ZUhUTUxEb2N1bWVudFwiKSxjKGEsXCJoYXNGZWF0dXJlXCIpLFMod2luZG93LkRPTUltcGxlbWVudGF0aW9uLGEpLHkoW3dpbmRvdy5ET01JbXBsZW1lbnRhdGlvbl0sW1wiY3JlYXRlRG9jdW1lbnRcIixcImNyZWF0ZURvY3VtZW50VHlwZVwiLFwiY3JlYXRlSFRNTERvY3VtZW50XCIsXCJoYXNGZWF0dXJlXCJdKSxlLmFkb3B0Tm9kZU5vUmVtb3ZlPXIsZS53cmFwcGVycy5ET01JbXBsZW1lbnRhdGlvbj1hLGUud3JhcHBlcnMuRG9jdW1lbnQ9dH0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUpe24uY2FsbCh0aGlzLGUpfXZhciBuPWUud3JhcHBlcnMuRXZlbnRUYXJnZXQscj1lLndyYXBwZXJzLlNlbGVjdGlvbixvPWUubWl4aW4saT1lLnJlZ2lzdGVyV3JhcHBlcixhPWUucmVuZGVyQWxsUGVuZGluZyxzPWUudW53cmFwLGM9ZS51bndyYXBJZk5lZWRlZCxsPWUud3JhcCx1PXdpbmRvdy5XaW5kb3csZD13aW5kb3cuZ2V0Q29tcHV0ZWRTdHlsZSxwPXdpbmRvdy5nZXREZWZhdWx0Q29tcHV0ZWRTdHlsZSxoPXdpbmRvdy5nZXRTZWxlY3Rpb247dC5wcm90b3R5cGU9T2JqZWN0LmNyZWF0ZShuLnByb3RvdHlwZSksdS5wcm90b3R5cGUuZ2V0Q29tcHV0ZWRTdHlsZT1mdW5jdGlvbihlLHQpe3JldHVybiBsKHRoaXN8fHdpbmRvdykuZ2V0Q29tcHV0ZWRTdHlsZShjKGUpLHQpfSxwJiYodS5wcm90b3R5cGUuZ2V0RGVmYXVsdENvbXB1dGVkU3R5bGU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gbCh0aGlzfHx3aW5kb3cpLmdldERlZmF1bHRDb21wdXRlZFN0eWxlKGMoZSksdCl9KSx1LnByb3RvdHlwZS5nZXRTZWxlY3Rpb249ZnVuY3Rpb24oKXtyZXR1cm4gbCh0aGlzfHx3aW5kb3cpLmdldFNlbGVjdGlvbigpfSxkZWxldGUgd2luZG93LmdldENvbXB1dGVkU3R5bGUsZGVsZXRlIHdpbmRvdy5nZXREZWZhdWx0Q29tcHV0ZWRTdHlsZSxkZWxldGUgd2luZG93LmdldFNlbGVjdGlvbixbXCJhZGRFdmVudExpc3RlbmVyXCIsXCJyZW1vdmVFdmVudExpc3RlbmVyXCIsXCJkaXNwYXRjaEV2ZW50XCJdLmZvckVhY2goZnVuY3Rpb24oZSl7dS5wcm90b3R5cGVbZV09ZnVuY3Rpb24oKXt2YXIgdD1sKHRoaXN8fHdpbmRvdyk7cmV0dXJuIHRbZV0uYXBwbHkodCxhcmd1bWVudHMpfSxkZWxldGUgd2luZG93W2VdfSksbyh0LnByb3RvdHlwZSx7Z2V0Q29tcHV0ZWRTdHlsZTpmdW5jdGlvbihlLHQpe3JldHVybiBhKCksZC5jYWxsKHModGhpcyksYyhlKSx0KX0sZ2V0U2VsZWN0aW9uOmZ1bmN0aW9uKCl7cmV0dXJuIGEoKSxuZXcgcihoLmNhbGwocyh0aGlzKSkpfSxnZXQgZG9jdW1lbnQoKXtyZXR1cm4gbChzKHRoaXMpLmRvY3VtZW50KX19KSxwJiYodC5wcm90b3R5cGUuZ2V0RGVmYXVsdENvbXB1dGVkU3R5bGU9ZnVuY3Rpb24oZSx0KXtyZXR1cm4gYSgpLHAuY2FsbChzKHRoaXMpLGMoZSksdCl9KSxpKHUsdCx3aW5kb3cpLGUud3JhcHBlcnMuV2luZG93PXR9KHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7dmFyIHQ9ZS51bndyYXAsbj13aW5kb3cuRGF0YVRyYW5zZmVyfHx3aW5kb3cuQ2xpcGJvYXJkLHI9bi5wcm90b3R5cGUuc2V0RHJhZ0ltYWdlO3ImJihuLnByb3RvdHlwZS5zZXREcmFnSW1hZ2U9ZnVuY3Rpb24oZSxuLG8pe3IuY2FsbCh0aGlzLHQoZSksbixvKX0pfSh3aW5kb3cuU2hhZG93RE9NUG9seWZpbGwpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2Z1bmN0aW9uIHQoZSl7dmFyIHQ7dD1lIGluc3RhbmNlb2YgaT9lOm5ldyBpKGUmJm8oZSkpLHIodCx0aGlzKX12YXIgbj1lLnJlZ2lzdGVyV3JhcHBlcixyPWUuc2V0V3JhcHBlcixvPWUudW53cmFwLGk9d2luZG93LkZvcm1EYXRhO2kmJihuKGksdCxuZXcgaSksZS53cmFwcGVycy5Gb3JtRGF0YT10KX0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjt2YXIgdD1lLnVud3JhcElmTmVlZGVkLG49WE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLnNlbmQ7WE1MSHR0cFJlcXVlc3QucHJvdG90eXBlLnNlbmQ9ZnVuY3Rpb24oZSl7cmV0dXJuIG4uY2FsbCh0aGlzLHQoZSkpfX0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtcInVzZSBzdHJpY3RcIjtmdW5jdGlvbiB0KGUpe3ZhciB0PW5bZV0scj13aW5kb3dbdF07aWYocil7dmFyIG89ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChlKSxpPW8uY29uc3RydWN0b3I7d2luZG93W3RdPWl9fXZhciBuPShlLmlzV3JhcHBlckZvcix7YTpcIkhUTUxBbmNob3JFbGVtZW50XCIsYXJlYTpcIkhUTUxBcmVhRWxlbWVudFwiLGF1ZGlvOlwiSFRNTEF1ZGlvRWxlbWVudFwiLGJhc2U6XCJIVE1MQmFzZUVsZW1lbnRcIixib2R5OlwiSFRNTEJvZHlFbGVtZW50XCIsYnI6XCJIVE1MQlJFbGVtZW50XCIsYnV0dG9uOlwiSFRNTEJ1dHRvbkVsZW1lbnRcIixjYW52YXM6XCJIVE1MQ2FudmFzRWxlbWVudFwiLGNhcHRpb246XCJIVE1MVGFibGVDYXB0aW9uRWxlbWVudFwiLGNvbDpcIkhUTUxUYWJsZUNvbEVsZW1lbnRcIixjb250ZW50OlwiSFRNTENvbnRlbnRFbGVtZW50XCIsZGF0YTpcIkhUTUxEYXRhRWxlbWVudFwiLGRhdGFsaXN0OlwiSFRNTERhdGFMaXN0RWxlbWVudFwiLGRlbDpcIkhUTUxNb2RFbGVtZW50XCIsZGlyOlwiSFRNTERpcmVjdG9yeUVsZW1lbnRcIixkaXY6XCJIVE1MRGl2RWxlbWVudFwiLGRsOlwiSFRNTERMaXN0RWxlbWVudFwiLGVtYmVkOlwiSFRNTEVtYmVkRWxlbWVudFwiLGZpZWxkc2V0OlwiSFRNTEZpZWxkU2V0RWxlbWVudFwiLGZvbnQ6XCJIVE1MRm9udEVsZW1lbnRcIixmb3JtOlwiSFRNTEZvcm1FbGVtZW50XCIsZnJhbWU6XCJIVE1MRnJhbWVFbGVtZW50XCIsZnJhbWVzZXQ6XCJIVE1MRnJhbWVTZXRFbGVtZW50XCIsaDE6XCJIVE1MSGVhZGluZ0VsZW1lbnRcIixoZWFkOlwiSFRNTEhlYWRFbGVtZW50XCIsaHI6XCJIVE1MSFJFbGVtZW50XCIsaHRtbDpcIkhUTUxIdG1sRWxlbWVudFwiLGlmcmFtZTpcIkhUTUxJRnJhbWVFbGVtZW50XCIsaW1nOlwiSFRNTEltYWdlRWxlbWVudFwiLGlucHV0OlwiSFRNTElucHV0RWxlbWVudFwiLGtleWdlbjpcIkhUTUxLZXlnZW5FbGVtZW50XCIsbGFiZWw6XCJIVE1MTGFiZWxFbGVtZW50XCIsbGVnZW5kOlwiSFRNTExlZ2VuZEVsZW1lbnRcIixsaTpcIkhUTUxMSUVsZW1lbnRcIixsaW5rOlwiSFRNTExpbmtFbGVtZW50XCIsbWFwOlwiSFRNTE1hcEVsZW1lbnRcIixtYXJxdWVlOlwiSFRNTE1hcnF1ZWVFbGVtZW50XCIsbWVudTpcIkhUTUxNZW51RWxlbWVudFwiLG1lbnVpdGVtOlwiSFRNTE1lbnVJdGVtRWxlbWVudFwiLG1ldGE6XCJIVE1MTWV0YUVsZW1lbnRcIixtZXRlcjpcIkhUTUxNZXRlckVsZW1lbnRcIixvYmplY3Q6XCJIVE1MT2JqZWN0RWxlbWVudFwiLG9sOlwiSFRNTE9MaXN0RWxlbWVudFwiLG9wdGdyb3VwOlwiSFRNTE9wdEdyb3VwRWxlbWVudFwiLG9wdGlvbjpcIkhUTUxPcHRpb25FbGVtZW50XCIsb3V0cHV0OlwiSFRNTE91dHB1dEVsZW1lbnRcIixwOlwiSFRNTFBhcmFncmFwaEVsZW1lbnRcIixwYXJhbTpcIkhUTUxQYXJhbUVsZW1lbnRcIixwcmU6XCJIVE1MUHJlRWxlbWVudFwiLHByb2dyZXNzOlwiSFRNTFByb2dyZXNzRWxlbWVudFwiLHE6XCJIVE1MUXVvdGVFbGVtZW50XCIsc2NyaXB0OlwiSFRNTFNjcmlwdEVsZW1lbnRcIixzZWxlY3Q6XCJIVE1MU2VsZWN0RWxlbWVudFwiLHNoYWRvdzpcIkhUTUxTaGFkb3dFbGVtZW50XCIsc291cmNlOlwiSFRNTFNvdXJjZUVsZW1lbnRcIixzcGFuOlwiSFRNTFNwYW5FbGVtZW50XCIsc3R5bGU6XCJIVE1MU3R5bGVFbGVtZW50XCIsdGFibGU6XCJIVE1MVGFibGVFbGVtZW50XCIsdGJvZHk6XCJIVE1MVGFibGVTZWN0aW9uRWxlbWVudFwiLHRlbXBsYXRlOlwiSFRNTFRlbXBsYXRlRWxlbWVudFwiLHRleHRhcmVhOlwiSFRNTFRleHRBcmVhRWxlbWVudFwiLHRoZWFkOlwiSFRNTFRhYmxlU2VjdGlvbkVsZW1lbnRcIix0aW1lOlwiSFRNTFRpbWVFbGVtZW50XCIsdGl0bGU6XCJIVE1MVGl0bGVFbGVtZW50XCIsdHI6XCJIVE1MVGFibGVSb3dFbGVtZW50XCIsdHJhY2s6XCJIVE1MVHJhY2tFbGVtZW50XCIsdWw6XCJIVE1MVUxpc3RFbGVtZW50XCIsdmlkZW86XCJIVE1MVmlkZW9FbGVtZW50XCJ9KTtPYmplY3Qua2V5cyhuKS5mb3JFYWNoKHQpLE9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKGUud3JhcHBlcnMpLmZvckVhY2goZnVuY3Rpb24odCl7d2luZG93W3RdPWUud3JhcHBlcnNbdF19KX0od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxmdW5jdGlvbihlKXtmdW5jdGlvbiB0KGUsdCl7dmFyIG49XCJcIjtyZXR1cm4gQXJyYXkucHJvdG90eXBlLmZvckVhY2guY2FsbChlLGZ1bmN0aW9uKGUpe24rPWUudGV4dENvbnRlbnQrXCJcXG5cXG5cIn0pLHR8fChuPW4ucmVwbGFjZShkLFwiXCIpKSxufWZ1bmN0aW9uIG4oZSl7dmFyIHQ9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO3JldHVybiB0LnRleHRDb250ZW50PWUsdH1mdW5jdGlvbiByKGUpe3ZhciB0PW4oZSk7ZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCh0KTt2YXIgcj1bXTtpZih0LnNoZWV0KXRyeXtyPXQuc2hlZXQuY3NzUnVsZXN9Y2F0Y2gobyl7fWVsc2UgY29uc29sZS53YXJuKFwic2hlZXQgbm90IGZvdW5kXCIsdCk7cmV0dXJuIHQucGFyZW50Tm9kZS5yZW1vdmVDaGlsZCh0KSxyfWZ1bmN0aW9uIG8oKXtDLmluaXRpYWxpemVkPSEwLGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoQyk7dmFyIGU9Qy5jb250ZW50RG9jdW1lbnQsdD1lLmNyZWF0ZUVsZW1lbnQoXCJiYXNlXCIpO3QuaHJlZj1kb2N1bWVudC5iYXNlVVJJLGUuaGVhZC5hcHBlbmRDaGlsZCh0KX1mdW5jdGlvbiBpKGUpe0MuaW5pdGlhbGl6ZWR8fG8oKSxkb2N1bWVudC5ib2R5LmFwcGVuZENoaWxkKEMpLGUoQy5jb250ZW50RG9jdW1lbnQpLGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQoQyl9ZnVuY3Rpb24gYShlLHQpe2lmKHQpe3ZhciBvO2lmKGUubWF0Y2goXCJAaW1wb3J0XCIpJiZEKXt2YXIgYT1uKGUpO2koZnVuY3Rpb24oZSl7ZS5oZWFkLmFwcGVuZENoaWxkKGEuaW1wbCksbz1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhLnNoZWV0LmNzc1J1bGVzLDApLHQobyl9KX1lbHNlIG89cihlKSx0KG8pfX1mdW5jdGlvbiBzKGUpe2UmJmwoKS5hcHBlbmRDaGlsZChkb2N1bWVudC5jcmVhdGVUZXh0Tm9kZShlKSl9ZnVuY3Rpb24gYyhlLHQpe3ZhciByPW4oZSk7ci5zZXRBdHRyaWJ1dGUodCxcIlwiKSxyLnNldEF0dHJpYnV0ZSh4LFwiXCIpLGRvY3VtZW50LmhlYWQuYXBwZW5kQ2hpbGQocil9ZnVuY3Rpb24gbCgpe3JldHVybiBqfHwoaj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIiksai5zZXRBdHRyaWJ1dGUoeCxcIlwiKSxqW3hdPSEwKSxqfXZhciB1PXtzdHJpY3RTdHlsaW5nOiExLHJlZ2lzdHJ5Ont9LHNoaW1TdHlsaW5nOmZ1bmN0aW9uKGUsbixyKXt2YXIgbz10aGlzLnByZXBhcmVSb290KGUsbixyKSxpPXRoaXMuaXNUeXBlRXh0ZW5zaW9uKHIpLGE9dGhpcy5tYWtlU2NvcGVTZWxlY3RvcihuLGkpLHM9dChvLCEwKTtzPXRoaXMuc2NvcGVDc3NUZXh0KHMsYSksZSYmKGUuc2hpbW1lZFN0eWxlPXMpLHRoaXMuYWRkQ3NzVG9Eb2N1bWVudChzLG4pfSxzaGltU3R5bGU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdGhpcy5zaGltQ3NzVGV4dChlLnRleHRDb250ZW50LHQpfSxzaGltQ3NzVGV4dDpmdW5jdGlvbihlLHQpe3JldHVybiBlPXRoaXMuaW5zZXJ0RGlyZWN0aXZlcyhlKSx0aGlzLnNjb3BlQ3NzVGV4dChlLHQpfSxtYWtlU2NvcGVTZWxlY3RvcjpmdW5jdGlvbihlLHQpe3JldHVybiBlP3Q/XCJbaXM9XCIrZStcIl1cIjplOlwiXCJ9LGlzVHlwZUV4dGVuc2lvbjpmdW5jdGlvbihlKXtyZXR1cm4gZSYmZS5pbmRleE9mKFwiLVwiKTwwfSxwcmVwYXJlUm9vdDpmdW5jdGlvbihlLHQsbil7dmFyIHI9dGhpcy5yZWdpc3RlclJvb3QoZSx0LG4pO3JldHVybiB0aGlzLnJlcGxhY2VUZXh0SW5TdHlsZXMoci5yb290U3R5bGVzLHRoaXMuaW5zZXJ0RGlyZWN0aXZlcyksdGhpcy5yZW1vdmVTdHlsZXMoZSxyLnJvb3RTdHlsZXMpLHRoaXMuc3RyaWN0U3R5bGluZyYmdGhpcy5hcHBseVNjb3BlVG9Db250ZW50KGUsdCksci5zY29wZVN0eWxlc30scmVtb3ZlU3R5bGVzOmZ1bmN0aW9uKGUsdCl7Zm9yKHZhciBuLHI9MCxvPXQubGVuZ3RoO28+ciYmKG49dFtyXSk7cisrKW4ucGFyZW50Tm9kZS5yZW1vdmVDaGlsZChuKX0scmVnaXN0ZXJSb290OmZ1bmN0aW9uKGUsdCxuKXt2YXIgcj10aGlzLnJlZ2lzdHJ5W3RdPXtyb290OmUsbmFtZTp0LGV4dGVuZHNOYW1lOm59LG89dGhpcy5maW5kU3R5bGVzKGUpO3Iucm9vdFN0eWxlcz1vLHIuc2NvcGVTdHlsZXM9ci5yb290U3R5bGVzO3ZhciBpPXRoaXMucmVnaXN0cnlbci5leHRlbmRzTmFtZV07cmV0dXJuIGkmJihyLnNjb3BlU3R5bGVzPWkuc2NvcGVTdHlsZXMuY29uY2F0KHIuc2NvcGVTdHlsZXMpKSxyfSxmaW5kU3R5bGVzOmZ1bmN0aW9uKGUpe2lmKCFlKXJldHVybltdO3ZhciB0PWUucXVlcnlTZWxlY3RvckFsbChcInN0eWxlXCIpO3JldHVybiBBcnJheS5wcm90b3R5cGUuZmlsdGVyLmNhbGwodCxmdW5jdGlvbihlKXtyZXR1cm4hZS5oYXNBdHRyaWJ1dGUoUil9KX0sYXBwbHlTY29wZVRvQ29udGVudDpmdW5jdGlvbihlLHQpe2UmJihBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGUucXVlcnlTZWxlY3RvckFsbChcIipcIiksZnVuY3Rpb24oZSl7ZS5zZXRBdHRyaWJ1dGUodCxcIlwiKX0pLEFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZS5xdWVyeVNlbGVjdG9yQWxsKFwidGVtcGxhdGVcIiksZnVuY3Rpb24oZSl7dGhpcy5hcHBseVNjb3BlVG9Db250ZW50KGUuY29udGVudCx0KX0sdGhpcykpfSxpbnNlcnREaXJlY3RpdmVzOmZ1bmN0aW9uKGUpe3JldHVybiBlPXRoaXMuaW5zZXJ0UG9seWZpbGxEaXJlY3RpdmVzSW5Dc3NUZXh0KGUpLHRoaXMuaW5zZXJ0UG9seWZpbGxSdWxlc0luQ3NzVGV4dChlKX0saW5zZXJ0UG9seWZpbGxEaXJlY3RpdmVzSW5Dc3NUZXh0OmZ1bmN0aW9uKGUpe3JldHVybiBlPWUucmVwbGFjZShwLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQuc2xpY2UoMCwtMikrXCJ7XCJ9KSxlLnJlcGxhY2UoaCxmdW5jdGlvbihlLHQpe3JldHVybiB0K1wiIHtcIn0pfSxpbnNlcnRQb2x5ZmlsbFJ1bGVzSW5Dc3NUZXh0OmZ1bmN0aW9uKGUpe3JldHVybiBlPWUucmVwbGFjZShmLGZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQuc2xpY2UoMCwtMSl9KSxlLnJlcGxhY2UobSxmdW5jdGlvbihlLHQsbixyKXt2YXIgbz1lLnJlcGxhY2UodCxcIlwiKS5yZXBsYWNlKG4sXCJcIik7cmV0dXJuIHIrb30pfSxzY29wZUNzc1RleHQ6ZnVuY3Rpb24oZSx0KXt2YXIgbj10aGlzLmV4dHJhY3RVbnNjb3BlZFJ1bGVzRnJvbUNzc1RleHQoZSk7aWYoZT10aGlzLmluc2VydFBvbHlmaWxsSG9zdEluQ3NzVGV4dChlKSxlPXRoaXMuY29udmVydENvbG9uSG9zdChlKSxlPXRoaXMuY29udmVydENvbG9uSG9zdENvbnRleHQoZSksZT10aGlzLmNvbnZlcnRTaGFkb3dET01TZWxlY3RvcnMoZSksdCl7dmFyIGUscj10aGlzO2EoZSxmdW5jdGlvbihuKXtlPXIuc2NvcGVSdWxlcyhuLHQpfSl9cmV0dXJuIGU9ZStcIlxcblwiK24sZS50cmltKCl9LGV4dHJhY3RVbnNjb3BlZFJ1bGVzRnJvbUNzc1RleHQ6ZnVuY3Rpb24oZSl7Zm9yKHZhciB0LG49XCJcIjt0PXcuZXhlYyhlKTspbis9dFsxXS5zbGljZSgwLC0xKStcIlxcblxcblwiO2Zvcig7dD12LmV4ZWMoZSk7KW4rPXRbMF0ucmVwbGFjZSh0WzJdLFwiXCIpLnJlcGxhY2UodFsxXSx0WzNdKStcIlxcblxcblwiO3JldHVybiBufSxjb252ZXJ0Q29sb25Ib3N0OmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmNvbnZlcnRDb2xvblJ1bGUoZSxFLHRoaXMuY29sb25Ib3N0UGFydFJlcGxhY2VyKX0sY29udmVydENvbG9uSG9zdENvbnRleHQ6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuY29udmVydENvbG9uUnVsZShlLF8sdGhpcy5jb2xvbkhvc3RDb250ZXh0UGFydFJlcGxhY2VyKX0sY29udmVydENvbG9uUnVsZTpmdW5jdGlvbihlLHQsbil7cmV0dXJuIGUucmVwbGFjZSh0LGZ1bmN0aW9uKGUsdCxyLG8pe2lmKHQ9TyxyKXtmb3IodmFyIGksYT1yLnNwbGl0KFwiLFwiKSxzPVtdLGM9MCxsPWEubGVuZ3RoO2w+YyYmKGk9YVtjXSk7YysrKWk9aS50cmltKCkscy5wdXNoKG4odCxpLG8pKTtyZXR1cm4gcy5qb2luKFwiLFwiKX1yZXR1cm4gdCtvfSl9LGNvbG9uSG9zdENvbnRleHRQYXJ0UmVwbGFjZXI6ZnVuY3Rpb24oZSx0LG4pe3JldHVybiB0Lm1hdGNoKGcpP3RoaXMuY29sb25Ib3N0UGFydFJlcGxhY2VyKGUsdCxuKTplK3QrbitcIiwgXCIrdCtcIiBcIitlK259LGNvbG9uSG9zdFBhcnRSZXBsYWNlcjpmdW5jdGlvbihlLHQsbil7cmV0dXJuIGUrdC5yZXBsYWNlKGcsXCJcIikrbn0sY29udmVydFNoYWRvd0RPTVNlbGVjdG9yczpmdW5jdGlvbihlKXtmb3IodmFyIHQ9MDt0PE4ubGVuZ3RoO3QrKyllPWUucmVwbGFjZShOW3RdLFwiIFwiKTtyZXR1cm4gZX0sc2NvcGVSdWxlczpmdW5jdGlvbihlLHQpe3ZhciBuPVwiXCI7cmV0dXJuIGUmJkFycmF5LnByb3RvdHlwZS5mb3JFYWNoLmNhbGwoZSxmdW5jdGlvbihlKXtpZihlLnNlbGVjdG9yVGV4dCYmZS5zdHlsZSYmdm9pZCAwIT09ZS5zdHlsZS5jc3NUZXh0KW4rPXRoaXMuc2NvcGVTZWxlY3RvcihlLnNlbGVjdG9yVGV4dCx0LHRoaXMuc3RyaWN0U3R5bGluZykrXCIge1xcbiBcIixuKz10aGlzLnByb3BlcnRpZXNGcm9tUnVsZShlKStcIlxcbn1cXG5cXG5cIjtlbHNlIGlmKGUudHlwZT09PUNTU1J1bGUuTUVESUFfUlVMRSluKz1cIkBtZWRpYSBcIitlLm1lZGlhLm1lZGlhVGV4dCtcIiB7XFxuXCIsbis9dGhpcy5zY29wZVJ1bGVzKGUuY3NzUnVsZXMsdCksbis9XCJcXG59XFxuXFxuXCI7ZWxzZSB0cnl7ZS5jc3NUZXh0JiYobis9ZS5jc3NUZXh0K1wiXFxuXFxuXCIpfWNhdGNoKHIpe2UudHlwZT09PUNTU1J1bGUuS0VZRlJBTUVTX1JVTEUmJmUuY3NzUnVsZXMmJihuKz10aGlzLmllU2FmZUNzc1RleHRGcm9tS2V5RnJhbWVSdWxlKGUpKX19LHRoaXMpLG59LGllU2FmZUNzc1RleHRGcm9tS2V5RnJhbWVSdWxlOmZ1bmN0aW9uKGUpe3ZhciB0PVwiQGtleWZyYW1lcyBcIitlLm5hbWUrXCIge1wiO3JldHVybiBBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGUuY3NzUnVsZXMsZnVuY3Rpb24oZSl7dCs9XCIgXCIrZS5rZXlUZXh0K1wiIHtcIitlLnN0eWxlLmNzc1RleHQrXCJ9XCJ9KSx0Kz1cIiB9XCJ9LHNjb3BlU2VsZWN0b3I6ZnVuY3Rpb24oZSx0LG4pe3ZhciByPVtdLG89ZS5zcGxpdChcIixcIik7cmV0dXJuIG8uZm9yRWFjaChmdW5jdGlvbihlKXtlPWUudHJpbSgpLHRoaXMuc2VsZWN0b3JOZWVkc1Njb3BpbmcoZSx0KSYmKGU9biYmIWUubWF0Y2goTyk/dGhpcy5hcHBseVN0cmljdFNlbGVjdG9yU2NvcGUoZSx0KTp0aGlzLmFwcGx5U2VsZWN0b3JTY29wZShlLHQpKSxyLnB1c2goZSl9LHRoaXMpLHIuam9pbihcIiwgXCIpfSxzZWxlY3Rvck5lZWRzU2NvcGluZzpmdW5jdGlvbihlLHQpe2lmKEFycmF5LmlzQXJyYXkodCkpcmV0dXJuITA7dmFyIG49dGhpcy5tYWtlU2NvcGVNYXRjaGVyKHQpO3JldHVybiFlLm1hdGNoKG4pfSxtYWtlU2NvcGVNYXRjaGVyOmZ1bmN0aW9uKGUpe3JldHVybiBlPWUucmVwbGFjZSgvXFxbL2csXCJcXFxcW1wiKS5yZXBsYWNlKC9cXF0vZyxcIlxcXFxdXCIpLG5ldyBSZWdFeHAoXCJeKFwiK2UrXCIpXCIrUyxcIm1cIil9LGFwcGx5U2VsZWN0b3JTY29wZTpmdW5jdGlvbihlLHQpe3JldHVybiBBcnJheS5pc0FycmF5KHQpP3RoaXMuYXBwbHlTZWxlY3RvclNjb3BlTGlzdChlLHQpOnRoaXMuYXBwbHlTaW1wbGVTZWxlY3RvclNjb3BlKGUsdCl9LGFwcGx5U2VsZWN0b3JTY29wZUxpc3Q6ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG4scj1bXSxvPTA7bj10W29dO28rKylyLnB1c2godGhpcy5hcHBseVNpbXBsZVNlbGVjdG9yU2NvcGUoZSxuKSk7cmV0dXJuIHIuam9pbihcIiwgXCIpfSxhcHBseVNpbXBsZVNlbGVjdG9yU2NvcGU6ZnVuY3Rpb24oZSx0KXtyZXR1cm4gZS5tYXRjaChMKT8oZT1lLnJlcGxhY2UoTyx0KSxlLnJlcGxhY2UoTCx0K1wiIFwiKSk6dCtcIiBcIitlfSxhcHBseVN0cmljdFNlbGVjdG9yU2NvcGU6ZnVuY3Rpb24oZSx0KXt0PXQucmVwbGFjZSgvXFxbaXM9KFteXFxdXSopXFxdL2csXCIkMVwiKTt2YXIgbj1bXCIgXCIsXCI+XCIsXCIrXCIsXCJ+XCJdLHI9ZSxvPVwiW1wiK3QrXCJdXCI7cmV0dXJuIG4uZm9yRWFjaChmdW5jdGlvbihlKXt2YXIgdD1yLnNwbGl0KGUpO3I9dC5tYXAoZnVuY3Rpb24oZSl7dmFyIHQ9ZS50cmltKCkucmVwbGFjZShMLFwiXCIpO3JldHVybiB0JiZuLmluZGV4T2YodCk8MCYmdC5pbmRleE9mKG8pPDAmJihlPXQucmVwbGFjZSgvKFteOl0qKSg6KikoLiopLyxcIiQxXCIrbytcIiQyJDNcIikpLGV9KS5qb2luKGUpfSkscn0saW5zZXJ0UG9seWZpbGxIb3N0SW5Dc3NUZXh0OmZ1bmN0aW9uKGUpe3JldHVybiBlLnJlcGxhY2UoTSxiKS5yZXBsYWNlKFQsZyl9LHByb3BlcnRpZXNGcm9tUnVsZTpmdW5jdGlvbihlKXt2YXIgdD1lLnN0eWxlLmNzc1RleHQ7ZS5zdHlsZS5jb250ZW50JiYhZS5zdHlsZS5jb250ZW50Lm1hdGNoKC9bJ1wiXSt8YXR0ci8pJiYodD10LnJlcGxhY2UoL2NvbnRlbnQ6W147XSo7L2csXCJjb250ZW50OiAnXCIrZS5zdHlsZS5jb250ZW50K1wiJztcIikpO3ZhciBuPWUuc3R5bGU7Zm9yKHZhciByIGluIG4pXCJpbml0aWFsXCI9PT1uW3JdJiYodCs9citcIjogaW5pdGlhbDsgXCIpO3JldHVybiB0fSxyZXBsYWNlVGV4dEluU3R5bGVzOmZ1bmN0aW9uKGUsdCl7ZSYmdCYmKGUgaW5zdGFuY2VvZiBBcnJheXx8KGU9W2VdKSxBcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsKGUsZnVuY3Rpb24oZSl7ZS50ZXh0Q29udGVudD10LmNhbGwodGhpcyxlLnRleHRDb250ZW50KX0sdGhpcykpfSxhZGRDc3NUb0RvY3VtZW50OmZ1bmN0aW9uKGUsdCl7ZS5tYXRjaChcIkBpbXBvcnRcIik/YyhlLHQpOnMoZSl9fSxkPS9cXC9cXCpbXipdKlxcKisoW14vKl1bXipdKlxcKispKlxcLy9naW0scD0vXFwvXFwqXFxzKkBwb2x5ZmlsbCAoW14qXSpcXCorKFteLypdW14qXSpcXCorKSpcXC8pKFtee10qPyl7L2dpbSxoPS9wb2x5ZmlsbC1uZXh0LXNlbGVjdG9yW159XSpjb250ZW50XFw6W1xcc10qP1snXCJdKC4qPylbJ1wiXVs7XFxzXSp9KFtee10qPyl7L2dpbSxmPS9cXC9cXCpcXHNAcG9seWZpbGwtcnVsZShbXipdKlxcKisoW14vKl1bXipdKlxcKispKilcXC8vZ2ltLG09Lyhwb2x5ZmlsbC1ydWxlKVtefV0qKGNvbnRlbnRcXDpbXFxzXSpbJ1wiXSguKj8pWydcIl0pWztcXHNdKltefV0qfS9naW0sdz0vXFwvXFwqXFxzQHBvbHlmaWxsLXVuc2NvcGVkLXJ1bGUoW14qXSpcXCorKFteLypdW14qXSpcXCorKSopXFwvL2dpbSx2PS8ocG9seWZpbGwtdW5zY29wZWQtcnVsZSlbXn1dKihjb250ZW50XFw6W1xcc10qWydcIl0oLio/KVsnXCJdKVs7XFxzXSpbXn1dKn0vZ2ltLGc9XCItc2hhZG93Y3NzaG9zdFwiLGI9XCItc2hhZG93Y3NzY29udGV4dFwiLHk9XCIpKD86XFxcXCgoKD86XFxcXChbXikoXSpcXFxcKXxbXikoXSopKz8pXFxcXCkpPyhbXix7XSopXCIsRT1uZXcgUmVnRXhwKFwiKFwiK2creSxcImdpbVwiKSxfPW5ldyBSZWdFeHAoXCIoXCIrYit5LFwiZ2ltXCIpLFM9XCIoWz5cXFxcc34rWy4sezpdW1xcXFxzXFxcXFNdKik/JFwiLFQ9L1xcOmhvc3QvZ2ltLE09L1xcOmhvc3QtY29udGV4dC9naW0sTz1nK1wiLW5vLWNvbWJpbmF0b3JcIixMPW5ldyBSZWdFeHAoZyxcImdpbVwiKSxOPShuZXcgUmVnRXhwKGIsXCJnaW1cIiksWy8+Pj4vZywvOjpzaGFkb3cvZywvOjpjb250ZW50L2csL1xcL2RlZXBcXC8vZywvXFwvc2hhZG93XFwvL2csL1xcL3NoYWRvdy1kZWVwXFwvL2csL1xcXlxcXi9nLC9cXF4vZ10pLEM9ZG9jdW1lbnQuY3JlYXRlRWxlbWVudChcImlmcmFtZVwiKTtDLnN0eWxlLmRpc3BsYXk9XCJub25lXCI7dmFyIGosRD1uYXZpZ2F0b3IudXNlckFnZW50Lm1hdGNoKFwiQ2hyb21lXCIpLEg9XCJzaGltLXNoYWRvd2RvbVwiLHg9XCJzaGltLXNoYWRvd2RvbS1jc3NcIixSPVwibm8tc2hpbVwiO2lmKHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCl7cyhcInN0eWxlIHsgZGlzcGxheTogbm9uZSAhaW1wb3J0YW50OyB9XFxuXCIpO3ZhciBJPVNoYWRvd0RPTVBvbHlmaWxsLndyYXAoZG9jdW1lbnQpLFA9SS5xdWVyeVNlbGVjdG9yKFwiaGVhZFwiKTtQLmluc2VydEJlZm9yZShsKCksUC5jaGlsZE5vZGVzWzBdKSxkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwiRE9NQ29udGVudExvYWRlZFwiLGZ1bmN0aW9uKCl7ZS51cmxSZXNvbHZlcjtpZih3aW5kb3cuSFRNTEltcG9ydHMmJiFIVE1MSW1wb3J0cy51c2VOYXRpdmUpe3ZhciB0PVwibGlua1tyZWw9c3R5bGVzaGVldF1bXCIrSCtcIl1cIixuPVwic3R5bGVbXCIrSCtcIl1cIjtIVE1MSW1wb3J0cy5pbXBvcnRlci5kb2N1bWVudFByZWxvYWRTZWxlY3RvcnMrPVwiLFwiK3QsSFRNTEltcG9ydHMuaW1wb3J0ZXIuaW1wb3J0c1ByZWxvYWRTZWxlY3RvcnMrPVwiLFwiK3QsSFRNTEltcG9ydHMucGFyc2VyLmRvY3VtZW50U2VsZWN0b3JzPVtIVE1MSW1wb3J0cy5wYXJzZXIuZG9jdW1lbnRTZWxlY3RvcnMsdCxuXS5qb2luKFwiLFwiKTt2YXIgcj1IVE1MSW1wb3J0cy5wYXJzZXIucGFyc2VHZW5lcmljO0hUTUxJbXBvcnRzLnBhcnNlci5wYXJzZUdlbmVyaWM9ZnVuY3Rpb24oZSl7aWYoIWVbeF0pe3ZhciB0PWUuX19pbXBvcnRFbGVtZW50fHxlO2lmKCF0Lmhhc0F0dHJpYnV0ZShIKSlyZXR1cm4gdm9pZCByLmNhbGwodGhpcyxlKTtlLl9fcmVzb3VyY2UmJih0PWUub3duZXJEb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIiksdC50ZXh0Q29udGVudD1lLl9fcmVzb3VyY2UpLEhUTUxJbXBvcnRzLnBhdGgucmVzb2x2ZVVybHNJblN0eWxlKHQsZS5ocmVmKSx0LnRleHRDb250ZW50PXUuc2hpbVN0eWxlKHQpLHQucmVtb3ZlQXR0cmlidXRlKEgsXCJcIiksdC5zZXRBdHRyaWJ1dGUoeCxcIlwiKSx0W3hdPSEwLHQucGFyZW50Tm9kZSE9PVAmJihlLnBhcmVudE5vZGU9PT1QP1AucmVwbGFjZUNoaWxkKHQsZSk6dGhpcy5hZGRFbGVtZW50VG9Eb2N1bWVudCh0KSksdC5fX2ltcG9ydFBhcnNlZD0hMCx0aGlzLm1hcmtQYXJzaW5nQ29tcGxldGUoZSksdGhpcy5wYXJzZU5leHQoKX19O3ZhciBvPUhUTUxJbXBvcnRzLnBhcnNlci5oYXNSZXNvdXJjZTtIVE1MSW1wb3J0cy5wYXJzZXIuaGFzUmVzb3VyY2U9ZnVuY3Rpb24oZSl7cmV0dXJuXCJsaW5rXCI9PT1lLmxvY2FsTmFtZSYmXCJzdHlsZXNoZWV0XCI9PT1lLnJlbCYmZS5oYXNBdHRyaWJ1dGUoSCk/ZS5fX3Jlc291cmNlOm8uY2FsbCh0aGlzLGUpfX19KX1lLlNoYWRvd0NTUz11fSh3aW5kb3cuV2ViQ29tcG9uZW50cykpLGZ1bmN0aW9uKGUpe3dpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbD8od2luZG93LndyYXA9U2hhZG93RE9NUG9seWZpbGwud3JhcElmTmVlZGVkLHdpbmRvdy51bndyYXA9U2hhZG93RE9NUG9seWZpbGwudW53cmFwSWZOZWVkZWQpOndpbmRvdy53cmFwPXdpbmRvdy51bndyYXA9ZnVuY3Rpb24oZSl7cmV0dXJuIGV9fSh3aW5kb3cuV2ViQ29tcG9uZW50cyksZnVuY3Rpb24oZSl7XCJ1c2Ugc3RyaWN0XCI7ZnVuY3Rpb24gdChlKXtyZXR1cm4gdm9pZCAwIT09cFtlXX1mdW5jdGlvbiBuKCl7cy5jYWxsKHRoaXMpLHRoaXMuX2lzSW52YWxpZD0hMH1mdW5jdGlvbiByKGUpe3JldHVyblwiXCI9PWUmJm4uY2FsbCh0aGlzKSxlLnRvTG93ZXJDYXNlKCl9ZnVuY3Rpb24gbyhlKXt2YXIgdD1lLmNoYXJDb2RlQXQoMCk7cmV0dXJuIHQ+MzImJjEyNz50JiYtMT09WzM0LDM1LDYwLDYyLDYzLDk2XS5pbmRleE9mKHQpP2U6ZW5jb2RlVVJJQ29tcG9uZW50KGUpfWZ1bmN0aW9uIGkoZSl7dmFyIHQ9ZS5jaGFyQ29kZUF0KDApO3JldHVybiB0PjMyJiYxMjc+dCYmLTE9PVszNCwzNSw2MCw2Miw5Nl0uaW5kZXhPZih0KT9lOmVuY29kZVVSSUNvbXBvbmVudChlKX1mdW5jdGlvbiBhKGUsYSxzKXtmdW5jdGlvbiBjKGUpe2IucHVzaChlKX12YXIgbD1hfHxcInNjaGVtZSBzdGFydFwiLHU9MCxkPVwiXCIsdj0hMSxnPSExLGI9W107ZTpmb3IoOyhlW3UtMV0hPWZ8fDA9PXUpJiYhdGhpcy5faXNJbnZhbGlkOyl7dmFyIHk9ZVt1XTtzd2l0Y2gobCl7Y2FzZVwic2NoZW1lIHN0YXJ0XCI6aWYoIXl8fCFtLnRlc3QoeSkpe2lmKGEpe2MoXCJJbnZhbGlkIHNjaGVtZS5cIik7YnJlYWsgZX1kPVwiXCIsbD1cIm5vIHNjaGVtZVwiO2NvbnRpbnVlfWQrPXkudG9Mb3dlckNhc2UoKSxsPVwic2NoZW1lXCI7YnJlYWs7Y2FzZVwic2NoZW1lXCI6aWYoeSYmdy50ZXN0KHkpKWQrPXkudG9Mb3dlckNhc2UoKTtlbHNle2lmKFwiOlwiIT15KXtpZihhKXtpZihmPT15KWJyZWFrIGU7YyhcIkNvZGUgcG9pbnQgbm90IGFsbG93ZWQgaW4gc2NoZW1lOiBcIit5KTticmVhayBlfWQ9XCJcIix1PTAsbD1cIm5vIHNjaGVtZVwiO2NvbnRpbnVlfWlmKHRoaXMuX3NjaGVtZT1kLGQ9XCJcIixhKWJyZWFrIGU7dCh0aGlzLl9zY2hlbWUpJiYodGhpcy5faXNSZWxhdGl2ZT0hMCksbD1cImZpbGVcIj09dGhpcy5fc2NoZW1lP1wicmVsYXRpdmVcIjp0aGlzLl9pc1JlbGF0aXZlJiZzJiZzLl9zY2hlbWU9PXRoaXMuX3NjaGVtZT9cInJlbGF0aXZlIG9yIGF1dGhvcml0eVwiOnRoaXMuX2lzUmVsYXRpdmU/XCJhdXRob3JpdHkgZmlyc3Qgc2xhc2hcIjpcInNjaGVtZSBkYXRhXCJ9YnJlYWs7Y2FzZVwic2NoZW1lIGRhdGFcIjpcIj9cIj09eT8odGhpcy5fcXVlcnk9XCI/XCIsbD1cInF1ZXJ5XCIpOlwiI1wiPT15Pyh0aGlzLl9mcmFnbWVudD1cIiNcIixsPVwiZnJhZ21lbnRcIik6ZiE9eSYmXCIgXCIhPXkmJlwiXFxuXCIhPXkmJlwiXFxyXCIhPXkmJih0aGlzLl9zY2hlbWVEYXRhKz1vKHkpKTticmVhaztjYXNlXCJubyBzY2hlbWVcIjppZihzJiZ0KHMuX3NjaGVtZSkpe2w9XCJyZWxhdGl2ZVwiO2NvbnRpbnVlfWMoXCJNaXNzaW5nIHNjaGVtZS5cIiksbi5jYWxsKHRoaXMpO2JyZWFrO2Nhc2VcInJlbGF0aXZlIG9yIGF1dGhvcml0eVwiOmlmKFwiL1wiIT15fHxcIi9cIiE9ZVt1KzFdKXtjKFwiRXhwZWN0ZWQgLywgZ290OiBcIit5KSxsPVwicmVsYXRpdmVcIjtjb250aW51ZX1sPVwiYXV0aG9yaXR5IGlnbm9yZSBzbGFzaGVzXCI7YnJlYWs7Y2FzZVwicmVsYXRpdmVcIjppZih0aGlzLl9pc1JlbGF0aXZlPSEwLFwiZmlsZVwiIT10aGlzLl9zY2hlbWUmJih0aGlzLl9zY2hlbWU9cy5fc2NoZW1lKSxmPT15KXt0aGlzLl9ob3N0PXMuX2hvc3QsdGhpcy5fcG9ydD1zLl9wb3J0LHRoaXMuX3BhdGg9cy5fcGF0aC5zbGljZSgpLHRoaXMuX3F1ZXJ5PXMuX3F1ZXJ5LHRoaXMuX3VzZXJuYW1lPXMuX3VzZXJuYW1lLHRoaXMuX3Bhc3N3b3JkPXMuX3Bhc3N3b3JkO2JyZWFrIGV9aWYoXCIvXCI9PXl8fFwiXFxcXFwiPT15KVwiXFxcXFwiPT15JiZjKFwiXFxcXCBpcyBhbiBpbnZhbGlkIGNvZGUgcG9pbnQuXCIpLGw9XCJyZWxhdGl2ZSBzbGFzaFwiO2Vsc2UgaWYoXCI/XCI9PXkpdGhpcy5faG9zdD1zLl9ob3N0LHRoaXMuX3BvcnQ9cy5fcG9ydCx0aGlzLl9wYXRoPXMuX3BhdGguc2xpY2UoKSx0aGlzLl9xdWVyeT1cIj9cIix0aGlzLl91c2VybmFtZT1zLl91c2VybmFtZSx0aGlzLl9wYXNzd29yZD1zLl9wYXNzd29yZCxsPVwicXVlcnlcIjtlbHNle2lmKFwiI1wiIT15KXt2YXIgRT1lW3UrMV0sXz1lW3UrMl07KFwiZmlsZVwiIT10aGlzLl9zY2hlbWV8fCFtLnRlc3QoeSl8fFwiOlwiIT1FJiZcInxcIiE9RXx8ZiE9XyYmXCIvXCIhPV8mJlwiXFxcXFwiIT1fJiZcIj9cIiE9XyYmXCIjXCIhPV8pJiYodGhpcy5faG9zdD1zLl9ob3N0LHRoaXMuX3BvcnQ9cy5fcG9ydCx0aGlzLl91c2VybmFtZT1zLl91c2VybmFtZSx0aGlzLl9wYXNzd29yZD1zLl9wYXNzd29yZCx0aGlzLl9wYXRoPXMuX3BhdGguc2xpY2UoKSx0aGlzLl9wYXRoLnBvcCgpKSxsPVwicmVsYXRpdmUgcGF0aFwiO2NvbnRpbnVlfXRoaXMuX2hvc3Q9cy5faG9zdCx0aGlzLl9wb3J0PXMuX3BvcnQsdGhpcy5fcGF0aD1zLl9wYXRoLnNsaWNlKCksdGhpcy5fcXVlcnk9cy5fcXVlcnksdGhpcy5fZnJhZ21lbnQ9XCIjXCIsdGhpcy5fdXNlcm5hbWU9cy5fdXNlcm5hbWUsdGhpcy5fcGFzc3dvcmQ9cy5fcGFzc3dvcmQsbD1cImZyYWdtZW50XCJ9YnJlYWs7Y2FzZVwicmVsYXRpdmUgc2xhc2hcIjppZihcIi9cIiE9eSYmXCJcXFxcXCIhPXkpe1wiZmlsZVwiIT10aGlzLl9zY2hlbWUmJih0aGlzLl9ob3N0PXMuX2hvc3QsdGhpcy5fcG9ydD1zLl9wb3J0LHRoaXMuX3VzZXJuYW1lPXMuX3VzZXJuYW1lLHRoaXMuX3Bhc3N3b3JkPXMuX3Bhc3N3b3JkKSxsPVwicmVsYXRpdmUgcGF0aFwiO2NvbnRpbnVlfVwiXFxcXFwiPT15JiZjKFwiXFxcXCBpcyBhbiBpbnZhbGlkIGNvZGUgcG9pbnQuXCIpLGw9XCJmaWxlXCI9PXRoaXMuX3NjaGVtZT9cImZpbGUgaG9zdFwiOlwiYXV0aG9yaXR5IGlnbm9yZSBzbGFzaGVzXCI7YnJlYWs7Y2FzZVwiYXV0aG9yaXR5IGZpcnN0IHNsYXNoXCI6aWYoXCIvXCIhPXkpe2MoXCJFeHBlY3RlZCAnLycsIGdvdDogXCIreSksbD1cImF1dGhvcml0eSBpZ25vcmUgc2xhc2hlc1wiO2NvbnRpbnVlfWw9XCJhdXRob3JpdHkgc2Vjb25kIHNsYXNoXCI7YnJlYWs7Y2FzZVwiYXV0aG9yaXR5IHNlY29uZCBzbGFzaFwiOmlmKGw9XCJhdXRob3JpdHkgaWdub3JlIHNsYXNoZXNcIixcIi9cIiE9eSl7YyhcIkV4cGVjdGVkICcvJywgZ290OiBcIit5KTtjb250aW51ZX1icmVhaztjYXNlXCJhdXRob3JpdHkgaWdub3JlIHNsYXNoZXNcIjppZihcIi9cIiE9eSYmXCJcXFxcXCIhPXkpe2w9XCJhdXRob3JpdHlcIjtjb250aW51ZX1jKFwiRXhwZWN0ZWQgYXV0aG9yaXR5LCBnb3Q6IFwiK3kpO2JyZWFrO2Nhc2VcImF1dGhvcml0eVwiOmlmKFwiQFwiPT15KXt2JiYoYyhcIkAgYWxyZWFkeSBzZWVuLlwiKSxkKz1cIiU0MFwiKSx2PSEwO2Zvcih2YXIgUz0wO1M8ZC5sZW5ndGg7UysrKXt2YXIgVD1kW1NdO2lmKFwiICAgXCIhPVQmJlwiXFxuXCIhPVQmJlwiXFxyXCIhPVQpaWYoXCI6XCIhPVR8fG51bGwhPT10aGlzLl9wYXNzd29yZCl7dmFyIE09byhUKTtudWxsIT09dGhpcy5fcGFzc3dvcmQ/dGhpcy5fcGFzc3dvcmQrPU06dGhpcy5fdXNlcm5hbWUrPU19ZWxzZSB0aGlzLl9wYXNzd29yZD1cIlwiO2Vsc2UgYyhcIkludmFsaWQgd2hpdGVzcGFjZSBpbiBhdXRob3JpdHkuXCIpfWQ9XCJcIn1lbHNle2lmKGY9PXl8fFwiL1wiPT15fHxcIlxcXFxcIj09eXx8XCI/XCI9PXl8fFwiI1wiPT15KXt1LT1kLmxlbmd0aCxkPVwiXCIsbD1cImhvc3RcIjtjb250aW51ZX1kKz15fWJyZWFrO2Nhc2VcImZpbGUgaG9zdFwiOmlmKGY9PXl8fFwiL1wiPT15fHxcIlxcXFxcIj09eXx8XCI/XCI9PXl8fFwiI1wiPT15KXsyIT1kLmxlbmd0aHx8IW0udGVzdChkWzBdKXx8XCI6XCIhPWRbMV0mJlwifFwiIT1kWzFdPzA9PWQubGVuZ3RoP2w9XCJyZWxhdGl2ZSBwYXRoIHN0YXJ0XCI6KHRoaXMuX2hvc3Q9ci5jYWxsKHRoaXMsZCksZD1cIlwiLGw9XCJyZWxhdGl2ZSBwYXRoIHN0YXJ0XCIpOmw9XCJyZWxhdGl2ZSBwYXRoXCI7Y29udGludWV9XCIgIFwiPT15fHxcIlxcblwiPT15fHxcIlxcclwiPT15P2MoXCJJbnZhbGlkIHdoaXRlc3BhY2UgaW4gZmlsZSBob3N0LlwiKTpkKz15O2JyZWFrO2Nhc2VcImhvc3RcIjpjYXNlXCJob3N0bmFtZVwiOmlmKFwiOlwiIT15fHxnKXtpZihmPT15fHxcIi9cIj09eXx8XCJcXFxcXCI9PXl8fFwiP1wiPT15fHxcIiNcIj09eSl7aWYodGhpcy5faG9zdD1yLmNhbGwodGhpcyxkKSxkPVwiXCIsbD1cInJlbGF0aXZlIHBhdGggc3RhcnRcIixhKWJyZWFrIGU7Y29udGludWV9XCIgICAgXCIhPXkmJlwiXFxuXCIhPXkmJlwiXFxyXCIhPXk/KFwiW1wiPT15P2c9ITA6XCJdXCI9PXkmJihnPSExKSxkKz15KTpjKFwiSW52YWxpZCBjb2RlIHBvaW50IGluIGhvc3QvaG9zdG5hbWU6IFwiK3kpfWVsc2UgaWYodGhpcy5faG9zdD1yLmNhbGwodGhpcyxkKSxkPVwiXCIsbD1cInBvcnRcIixcImhvc3RuYW1lXCI9PWEpYnJlYWsgZTticmVhaztjYXNlXCJwb3J0XCI6aWYoL1swLTldLy50ZXN0KHkpKWQrPXk7ZWxzZXtpZihmPT15fHxcIi9cIj09eXx8XCJcXFxcXCI9PXl8fFwiP1wiPT15fHxcIiNcIj09eXx8YSl7aWYoXCJcIiE9ZCl7dmFyIE89cGFyc2VJbnQoZCwxMCk7TyE9cFt0aGlzLl9zY2hlbWVdJiYodGhpcy5fcG9ydD1PK1wiXCIpLGQ9XCJcIn1pZihhKWJyZWFrIGU7bD1cInJlbGF0aXZlIHBhdGggc3RhcnRcIjtjb250aW51ZX1cIiAgICBcIj09eXx8XCJcXG5cIj09eXx8XCJcXHJcIj09eT9jKFwiSW52YWxpZCBjb2RlIHBvaW50IGluIHBvcnQ6IFwiK3kpOm4uY2FsbCh0aGlzKX1icmVhaztjYXNlXCJyZWxhdGl2ZSBwYXRoIHN0YXJ0XCI6aWYoXCJcXFxcXCI9PXkmJmMoXCInXFxcXCcgbm90IGFsbG93ZWQgaW4gcGF0aC5cIiksbD1cInJlbGF0aXZlIHBhdGhcIixcIi9cIiE9eSYmXCJcXFxcXCIhPXkpY29udGludWU7YnJlYWs7Y2FzZVwicmVsYXRpdmUgcGF0aFwiOmlmKGYhPXkmJlwiL1wiIT15JiZcIlxcXFxcIiE9eSYmKGF8fFwiP1wiIT15JiZcIiNcIiE9eSkpXCIgXCIhPXkmJlwiXFxuXCIhPXkmJlwiXFxyXCIhPXkmJihkKz1vKHkpKTtlbHNle1wiXFxcXFwiPT15JiZjKFwiXFxcXCBub3QgYWxsb3dlZCBpbiByZWxhdGl2ZSBwYXRoLlwiKTt2YXIgTDsoTD1oW2QudG9Mb3dlckNhc2UoKV0pJiYoZD1MKSxcIi4uXCI9PWQ/KHRoaXMuX3BhdGgucG9wKCksXCIvXCIhPXkmJlwiXFxcXFwiIT15JiZ0aGlzLl9wYXRoLnB1c2goXCJcIikpOlwiLlwiPT1kJiZcIi9cIiE9eSYmXCJcXFxcXCIhPXk/dGhpcy5fcGF0aC5wdXNoKFwiXCIpOlwiLlwiIT1kJiYoXCJmaWxlXCI9PXRoaXMuX3NjaGVtZSYmMD09dGhpcy5fcGF0aC5sZW5ndGgmJjI9PWQubGVuZ3RoJiZtLnRlc3QoZFswXSkmJlwifFwiPT1kWzFdJiYoZD1kWzBdK1wiOlwiKSx0aGlzLl9wYXRoLnB1c2goZCkpLGQ9XCJcIixcIj9cIj09eT8odGhpcy5fcXVlcnk9XCI/XCIsbD1cInF1ZXJ5XCIpOlwiI1wiPT15JiYodGhpcy5fZnJhZ21lbnQ9XCIjXCIsbD1cImZyYWdtZW50XCIpfWJyZWFrO2Nhc2VcInF1ZXJ5XCI6YXx8XCIjXCIhPXk/ZiE9eSYmXCIgXCIhPXkmJlwiXFxuXCIhPXkmJlwiXFxyXCIhPXkmJih0aGlzLl9xdWVyeSs9aSh5KSk6KHRoaXMuX2ZyYWdtZW50PVwiI1wiLGw9XCJmcmFnbWVudFwiKTticmVhaztjYXNlXCJmcmFnbWVudFwiOmYhPXkmJlwiICBcIiE9eSYmXCJcXG5cIiE9eSYmXCJcXHJcIiE9eSYmKHRoaXMuX2ZyYWdtZW50Kz15KX11Kyt9fWZ1bmN0aW9uIHMoKXt0aGlzLl9zY2hlbWU9XCJcIix0aGlzLl9zY2hlbWVEYXRhPVwiXCIsdGhpcy5fdXNlcm5hbWU9XCJcIix0aGlzLl9wYXNzd29yZD1udWxsLHRoaXMuX2hvc3Q9XCJcIix0aGlzLl9wb3J0PVwiXCIsdGhpcy5fcGF0aD1bXSx0aGlzLl9xdWVyeT1cIlwiLHRoaXMuX2ZyYWdtZW50PVwiXCIsdGhpcy5faXNJbnZhbGlkPSExLHRoaXMuX2lzUmVsYXRpdmU9ITF9ZnVuY3Rpb24gYyhlLHQpe3ZvaWQgMD09PXR8fHQgaW5zdGFuY2VvZiBjfHwodD1uZXcgYyhTdHJpbmcodCkpKSx0aGlzLl91cmw9ZSxzLmNhbGwodGhpcyk7dmFyIG49ZS5yZXBsYWNlKC9eWyBcXHRcXHJcXG5cXGZdK3xbIFxcdFxcclxcblxcZl0rJC9nLFwiXCIpO2EuY2FsbCh0aGlzLG4sbnVsbCx0KX12YXIgbD0hMTtpZighZS5mb3JjZUpVUkwpdHJ5e3ZhciB1PW5ldyBVUkwoXCJiXCIsXCJodHRwOi8vYVwiKTt1LnBhdGhuYW1lPVwiYyUyMGRcIixsPVwiaHR0cDovL2EvYyUyMGRcIj09PXUuaHJlZn1jYXRjaChkKXt9aWYoIWwpe3ZhciBwPU9iamVjdC5jcmVhdGUobnVsbCk7cC5mdHA9MjEscC5maWxlPTAscC5nb3BoZXI9NzAscC5odHRwPTgwLHAuaHR0cHM9NDQzLHAud3M9ODAscC53c3M9NDQzO3ZhciBoPU9iamVjdC5jcmVhdGUobnVsbCk7aFtcIiUyZVwiXT1cIi5cIixoW1wiLiUyZVwiXT1cIi4uXCIsaFtcIiUyZS5cIl09XCIuLlwiLGhbXCIlMmUlMmVcIl09XCIuLlwiO3ZhciBmPXZvaWQgMCxtPS9bYS16QS1aXS8sdz0vW2EtekEtWjAtOVxcK1xcLVxcLl0vO2MucHJvdG90eXBlPXt0b1N0cmluZzpmdW5jdGlvbigpe3JldHVybiB0aGlzLmhyZWZ9LGdldCBocmVmKCl7aWYodGhpcy5faXNJbnZhbGlkKXJldHVybiB0aGlzLl91cmw7dmFyIGU9XCJcIjtyZXR1cm4oXCJcIiE9dGhpcy5fdXNlcm5hbWV8fG51bGwhPXRoaXMuX3Bhc3N3b3JkKSYmKGU9dGhpcy5fdXNlcm5hbWUrKG51bGwhPXRoaXMuX3Bhc3N3b3JkP1wiOlwiK3RoaXMuX3Bhc3N3b3JkOlwiXCIpK1wiQFwiKSx0aGlzLnByb3RvY29sKyh0aGlzLl9pc1JlbGF0aXZlP1wiLy9cIitlK3RoaXMuaG9zdDpcIlwiKSt0aGlzLnBhdGhuYW1lK3RoaXMuX3F1ZXJ5K3RoaXMuX2ZyYWdtZW50fSxzZXQgaHJlZihlKXtzLmNhbGwodGhpcyksYS5jYWxsKHRoaXMsZSl9LGdldCBwcm90b2NvbCgpe3JldHVybiB0aGlzLl9zY2hlbWUrXCI6XCJ9LHNldCBwcm90b2NvbChlKXt0aGlzLl9pc0ludmFsaWR8fGEuY2FsbCh0aGlzLGUrXCI6XCIsXCJzY2hlbWUgc3RhcnRcIil9LGdldCBob3N0KCl7cmV0dXJuIHRoaXMuX2lzSW52YWxpZD9cIlwiOnRoaXMuX3BvcnQ/dGhpcy5faG9zdCtcIjpcIit0aGlzLl9wb3J0OnRoaXMuX2hvc3R9LHNldCBob3N0KGUpeyF0aGlzLl9pc0ludmFsaWQmJnRoaXMuX2lzUmVsYXRpdmUmJmEuY2FsbCh0aGlzLGUsXCJob3N0XCIpfSxnZXQgaG9zdG5hbWUoKXtyZXR1cm4gdGhpcy5faG9zdH0sc2V0IGhvc3RuYW1lKGUpeyF0aGlzLl9pc0ludmFsaWQmJnRoaXMuX2lzUmVsYXRpdmUmJmEuY2FsbCh0aGlzLGUsXCJob3N0bmFtZVwiKX0sZ2V0IHBvcnQoKXtyZXR1cm4gdGhpcy5fcG9ydH0sc2V0IHBvcnQoZSl7IXRoaXMuX2lzSW52YWxpZCYmdGhpcy5faXNSZWxhdGl2ZSYmYS5jYWxsKHRoaXMsZSxcInBvcnRcIil9LGdldCBwYXRobmFtZSgpe3JldHVybiB0aGlzLl9pc0ludmFsaWQ/XCJcIjp0aGlzLl9pc1JlbGF0aXZlP1wiL1wiK3RoaXMuX3BhdGguam9pbihcIi9cIik6dGhpcy5fc2NoZW1lRGF0YX0sc2V0IHBhdGhuYW1lKGUpeyF0aGlzLl9pc0ludmFsaWQmJnRoaXMuX2lzUmVsYXRpdmUmJih0aGlzLl9wYXRoPVtdLGEuY2FsbCh0aGlzLGUsXCJyZWxhdGl2ZSBwYXRoIHN0YXJ0XCIpKX0sZ2V0IHNlYXJjaCgpe3JldHVybiB0aGlzLl9pc0ludmFsaWR8fCF0aGlzLl9xdWVyeXx8XCI/XCI9PXRoaXMuX3F1ZXJ5P1wiXCI6dGhpcy5fcXVlcnl9LHNldCBzZWFyY2goZSl7IXRoaXMuX2lzSW52YWxpZCYmdGhpcy5faXNSZWxhdGl2ZSYmKHRoaXMuX3F1ZXJ5PVwiP1wiLFwiP1wiPT1lWzBdJiYoZT1lLnNsaWNlKDEpKSxhLmNhbGwodGhpcyxlLFwicXVlcnlcIikpfSxnZXQgaGFzaCgpe3JldHVybiB0aGlzLl9pc0ludmFsaWR8fCF0aGlzLl9mcmFnbWVudHx8XCIjXCI9PXRoaXMuX2ZyYWdtZW50P1wiXCI6dGhpcy5fZnJhZ21lbnR9LHNldCBoYXNoKGUpe3RoaXMuX2lzSW52YWxpZHx8KHRoaXMuX2ZyYWdtZW50PVwiI1wiLFwiI1wiPT1lWzBdJiYoZT1lLnNsaWNlKDEpKSxhLmNhbGwodGhpcyxlLFwiZnJhZ21lbnRcIikpfSxnZXQgb3JpZ2luKCl7dmFyIGU7aWYodGhpcy5faXNJbnZhbGlkfHwhdGhpcy5fc2NoZW1lKXJldHVyblwiXCI7c3dpdGNoKHRoaXMuX3NjaGVtZSl7Y2FzZVwiZGF0YVwiOmNhc2VcImZpbGVcIjpjYXNlXCJqYXZhc2NyaXB0XCI6Y2FzZVwibWFpbHRvXCI6cmV0dXJuXCJudWxsXCJ9cmV0dXJuIGU9dGhpcy5ob3N0LGU/dGhpcy5fc2NoZW1lK1wiOi8vXCIrZTpcIlwifX07dmFyIHY9ZS5VUkw7diYmKGMuY3JlYXRlT2JqZWN0VVJMPWZ1bmN0aW9uKGUpe3JldHVybiB2LmNyZWF0ZU9iamVjdFVSTC5hcHBseSh2LGFyZ3VtZW50cyl9LGMucmV2b2tlT2JqZWN0VVJMPWZ1bmN0aW9uKGUpe3YucmV2b2tlT2JqZWN0VVJMKGUpfSksZS5VUkw9Y319KHNlbGYpLGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSl7eS5wdXNoKGUpLGJ8fChiPSEwLG0ocikpfWZ1bmN0aW9uIG4oZSl7cmV0dXJuIHdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCYmd2luZG93LlNoYWRvd0RPTVBvbHlmaWxsLndyYXBJZk5lZWRlZChlKXx8ZX1mdW5jdGlvbiByKCl7Yj0hMTt2YXIgZT15O3k9W10sZS5zb3J0KGZ1bmN0aW9uKGUsdCl7cmV0dXJuIGUudWlkXy10LnVpZF99KTt2YXIgdD0hMTtlLmZvckVhY2goZnVuY3Rpb24oZSl7dmFyIG49ZS50YWtlUmVjb3JkcygpO28oZSksbi5sZW5ndGgmJihlLmNhbGxiYWNrXyhuLGUpLHQ9ITApfSksdCYmcigpfWZ1bmN0aW9uIG8oZSl7ZS5ub2Rlc18uZm9yRWFjaChmdW5jdGlvbih0KXt2YXIgbj13LmdldCh0KTtuJiZuLmZvckVhY2goZnVuY3Rpb24odCl7dC5vYnNlcnZlcj09PWUmJnQucmVtb3ZlVHJhbnNpZW50T2JzZXJ2ZXJzKCl9KX0pfWZ1bmN0aW9uIGkoZSx0KXtmb3IodmFyIG49ZTtuO249bi5wYXJlbnROb2RlKXt2YXIgcj13LmdldChuKTtpZihyKWZvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXt2YXIgaT1yW29dLGE9aS5vcHRpb25zO2lmKG49PT1lfHxhLnN1YnRyZWUpe3ZhciBzPXQoYSk7cyYmaS5lbnF1ZXVlKHMpfX19fWZ1bmN0aW9uIGEoZSl7dGhpcy5jYWxsYmFja189ZSx0aGlzLm5vZGVzXz1bXSx0aGlzLnJlY29yZHNfPVtdLHRoaXMudWlkXz0rK0V9ZnVuY3Rpb24gcyhlLHQpe3RoaXMudHlwZT1lLHRoaXMudGFyZ2V0PXQsdGhpcy5hZGRlZE5vZGVzPVtdLHRoaXMucmVtb3ZlZE5vZGVzPVtdLHRoaXMucHJldmlvdXNTaWJsaW5nPW51bGwsdGhpcy5uZXh0U2libGluZz1udWxsLHRoaXMuYXR0cmlidXRlTmFtZT1udWxsLHRoaXMuYXR0cmlidXRlTmFtZXNwYWNlPW51bGwsdGhpcy5vbGRWYWx1ZT1udWxsfWZ1bmN0aW9uIGMoZSl7dmFyIHQ9bmV3IHMoZS50eXBlLGUudGFyZ2V0KTtyZXR1cm4gdC5hZGRlZE5vZGVzPWUuYWRkZWROb2Rlcy5zbGljZSgpLHQucmVtb3ZlZE5vZGVzPWUucmVtb3ZlZE5vZGVzLnNsaWNlKCksdC5wcmV2aW91c1NpYmxpbmc9ZS5wcmV2aW91c1NpYmxpbmcsdC5uZXh0U2libGluZz1lLm5leHRTaWJsaW5nLHQuYXR0cmlidXRlTmFtZT1lLmF0dHJpYnV0ZU5hbWUsdC5hdHRyaWJ1dGVOYW1lc3BhY2U9ZS5hdHRyaWJ1dGVOYW1lc3BhY2UsdC5vbGRWYWx1ZT1lLm9sZFZhbHVlLHR9ZnVuY3Rpb24gbChlLHQpe3JldHVybiBfPW5ldyBzKGUsdCl9ZnVuY3Rpb24gdShlKXtyZXR1cm4gUz9TOihTPWMoXyksUy5vbGRWYWx1ZT1lLFMpfWZ1bmN0aW9uIGQoKXtfPVM9dm9pZCAwfWZ1bmN0aW9uIHAoZSl7cmV0dXJuIGU9PT1TfHxlPT09X31mdW5jdGlvbiBoKGUsdCl7cmV0dXJuIGU9PT10P2U6UyYmcChlKT9TOm51bGx9ZnVuY3Rpb24gZihlLHQsbil7dGhpcy5vYnNlcnZlcj1lLHRoaXMudGFyZ2V0PXQsdGhpcy5vcHRpb25zPW4sdGhpcy50cmFuc2llbnRPYnNlcnZlZE5vZGVzPVtdfXZhciBtLHc9bmV3IFdlYWtNYXA7aWYoL1RyaWRlbnR8RWRnZS8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSltPXNldFRpbWVvdXQ7ZWxzZSBpZih3aW5kb3cuc2V0SW1tZWRpYXRlKW09d2luZG93LnNldEltbWVkaWF0ZTtlbHNle3ZhciB2PVtdLGc9U3RyaW5nKE1hdGgucmFuZG9tKCkpO3dpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwibWVzc2FnZVwiLGZ1bmN0aW9uKGUpe2lmKGUuZGF0YT09PWcpe3ZhciB0PXY7dj1bXSx0LmZvckVhY2goZnVuY3Rpb24oZSl7ZSgpfSl9fSksbT1mdW5jdGlvbihlKXt2LnB1c2goZSksd2luZG93LnBvc3RNZXNzYWdlKGcsXCIqXCIpfX12YXIgYj0hMSx5PVtdLEU9MDthLnByb3RvdHlwZT17b2JzZXJ2ZTpmdW5jdGlvbihlLHQpe2lmKGU9bihlKSwhdC5jaGlsZExpc3QmJiF0LmF0dHJpYnV0ZXMmJiF0LmNoYXJhY3RlckRhdGF8fHQuYXR0cmlidXRlT2xkVmFsdWUmJiF0LmF0dHJpYnV0ZXN8fHQuYXR0cmlidXRlRmlsdGVyJiZ0LmF0dHJpYnV0ZUZpbHRlci5sZW5ndGgmJiF0LmF0dHJpYnV0ZXN8fHQuY2hhcmFjdGVyRGF0YU9sZFZhbHVlJiYhdC5jaGFyYWN0ZXJEYXRhKXRocm93IG5ldyBTeW50YXhFcnJvcjt2YXIgcj13LmdldChlKTtyfHx3LnNldChlLHI9W10pO2Zvcih2YXIgbyxpPTA7aTxyLmxlbmd0aDtpKyspaWYocltpXS5vYnNlcnZlcj09PXRoaXMpe289cltpXSxvLnJlbW92ZUxpc3RlbmVycygpLG8ub3B0aW9ucz10O2JyZWFrfW98fChvPW5ldyBmKHRoaXMsZSx0KSxyLnB1c2gobyksdGhpcy5ub2Rlc18ucHVzaChlKSksby5hZGRMaXN0ZW5lcnMoKX0sZGlzY29ubmVjdDpmdW5jdGlvbigpe3RoaXMubm9kZXNfLmZvckVhY2goZnVuY3Rpb24oZSl7Zm9yKHZhciB0PXcuZ2V0KGUpLG49MDtuPHQubGVuZ3RoO24rKyl7dmFyIHI9dFtuXTtpZihyLm9ic2VydmVyPT09dGhpcyl7ci5yZW1vdmVMaXN0ZW5lcnMoKSx0LnNwbGljZShuLDEpO2JyZWFrfX19LHRoaXMpLHRoaXMucmVjb3Jkc189W119LHRha2VSZWNvcmRzOmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5yZWNvcmRzXztyZXR1cm4gdGhpcy5yZWNvcmRzXz1bXSxlfX07dmFyIF8sUztmLnByb3RvdHlwZT17ZW5xdWV1ZTpmdW5jdGlvbihlKXt2YXIgbj10aGlzLm9ic2VydmVyLnJlY29yZHNfLHI9bi5sZW5ndGg7aWYobi5sZW5ndGg+MCl7dmFyIG89bltyLTFdLGk9aChvLGUpO2lmKGkpcmV0dXJuIHZvaWQobltyLTFdPWkpfWVsc2UgdCh0aGlzLm9ic2VydmVyKTtuW3JdPWV9LGFkZExpc3RlbmVyczpmdW5jdGlvbigpe3RoaXMuYWRkTGlzdGVuZXJzXyh0aGlzLnRhcmdldCl9LGFkZExpc3RlbmVyc186ZnVuY3Rpb24oZSl7dmFyIHQ9dGhpcy5vcHRpb25zO3QuYXR0cmlidXRlcyYmZS5hZGRFdmVudExpc3RlbmVyKFwiRE9NQXR0ck1vZGlmaWVkXCIsdGhpcywhMCksdC5jaGFyYWN0ZXJEYXRhJiZlLmFkZEV2ZW50TGlzdGVuZXIoXCJET01DaGFyYWN0ZXJEYXRhTW9kaWZpZWRcIix0aGlzLCEwKSx0LmNoaWxkTGlzdCYmZS5hZGRFdmVudExpc3RlbmVyKFwiRE9NTm9kZUluc2VydGVkXCIsdGhpcywhMCksKHQuY2hpbGRMaXN0fHx0LnN1YnRyZWUpJiZlLmFkZEV2ZW50TGlzdGVuZXIoXCJET01Ob2RlUmVtb3ZlZFwiLHRoaXMsITApfSxyZW1vdmVMaXN0ZW5lcnM6ZnVuY3Rpb24oKXt0aGlzLnJlbW92ZUxpc3RlbmVyc18odGhpcy50YXJnZXQpfSxyZW1vdmVMaXN0ZW5lcnNfOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMub3B0aW9uczt0LmF0dHJpYnV0ZXMmJmUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIkRPTUF0dHJNb2RpZmllZFwiLHRoaXMsITApLHQuY2hhcmFjdGVyRGF0YSYmZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiRE9NQ2hhcmFjdGVyRGF0YU1vZGlmaWVkXCIsdGhpcywhMCksdC5jaGlsZExpc3QmJmUucmVtb3ZlRXZlbnRMaXN0ZW5lcihcIkRPTU5vZGVJbnNlcnRlZFwiLHRoaXMsITApLCh0LmNoaWxkTGlzdHx8dC5zdWJ0cmVlKSYmZS5yZW1vdmVFdmVudExpc3RlbmVyKFwiRE9NTm9kZVJlbW92ZWRcIix0aGlzLCEwKX0sYWRkVHJhbnNpZW50T2JzZXJ2ZXI6ZnVuY3Rpb24oZSl7aWYoZSE9PXRoaXMudGFyZ2V0KXt0aGlzLmFkZExpc3RlbmVyc18oZSksdGhpcy50cmFuc2llbnRPYnNlcnZlZE5vZGVzLnB1c2goZSk7dmFyIHQ9dy5nZXQoZSk7dHx8dy5zZXQoZSx0PVtdKSx0LnB1c2godGhpcyl9fSxyZW1vdmVUcmFuc2llbnRPYnNlcnZlcnM6ZnVuY3Rpb24oKXt2YXIgZT10aGlzLnRyYW5zaWVudE9ic2VydmVkTm9kZXM7dGhpcy50cmFuc2llbnRPYnNlcnZlZE5vZGVzPVtdLGUuZm9yRWFjaChmdW5jdGlvbihlKXt0aGlzLnJlbW92ZUxpc3RlbmVyc18oZSk7Zm9yKHZhciB0PXcuZ2V0KGUpLG49MDtuPHQubGVuZ3RoO24rKylpZih0W25dPT09dGhpcyl7dC5zcGxpY2UobiwxKTticmVha319LHRoaXMpfSxoYW5kbGVFdmVudDpmdW5jdGlvbihlKXtzd2l0Y2goZS5zdG9wSW1tZWRpYXRlUHJvcGFnYXRpb24oKSxlLnR5cGUpe2Nhc2VcIkRPTUF0dHJNb2RpZmllZFwiOnZhciB0PWUuYXR0ck5hbWUsbj1lLnJlbGF0ZWROb2RlLm5hbWVzcGFjZVVSSSxyPWUudGFyZ2V0LG89bmV3IGwoXCJhdHRyaWJ1dGVzXCIscik7by5hdHRyaWJ1dGVOYW1lPXQsby5hdHRyaWJ1dGVOYW1lc3BhY2U9bjt2YXIgYT1lLmF0dHJDaGFuZ2U9PT1NdXRhdGlvbkV2ZW50LkFERElUSU9OP251bGw6ZS5wcmV2VmFsdWU7aShyLGZ1bmN0aW9uKGUpe3JldHVybiFlLmF0dHJpYnV0ZXN8fGUuYXR0cmlidXRlRmlsdGVyJiZlLmF0dHJpYnV0ZUZpbHRlci5sZW5ndGgmJi0xPT09ZS5hdHRyaWJ1dGVGaWx0ZXIuaW5kZXhPZih0KSYmLTE9PT1lLmF0dHJpYnV0ZUZpbHRlci5pbmRleE9mKG4pP3ZvaWQgMDplLmF0dHJpYnV0ZU9sZFZhbHVlP3UoYSk6b30pO2JyZWFrO2Nhc2VcIkRPTUNoYXJhY3RlckRhdGFNb2RpZmllZFwiOnZhciByPWUudGFyZ2V0LG89bChcImNoYXJhY3RlckRhdGFcIixyKSxhPWUucHJldlZhbHVlO2kocixmdW5jdGlvbihlKXtyZXR1cm4gZS5jaGFyYWN0ZXJEYXRhP2UuY2hhcmFjdGVyRGF0YU9sZFZhbHVlP3UoYSk6bzp2b2lkIDB9KTticmVhaztjYXNlXCJET01Ob2RlUmVtb3ZlZFwiOnRoaXMuYWRkVHJhbnNpZW50T2JzZXJ2ZXIoZS50YXJnZXQpO2Nhc2VcIkRPTU5vZGVJbnNlcnRlZFwiOnZhciBzLGMscD1lLnRhcmdldDtcIkRPTU5vZGVJbnNlcnRlZFwiPT09ZS50eXBlPyhzPVtwXSxjPVtdKToocz1bXSxjPVtwXSk7dmFyIGg9cC5wcmV2aW91c1NpYmxpbmcsZj1wLm5leHRTaWJsaW5nLG89bChcImNoaWxkTGlzdFwiLGUudGFyZ2V0LnBhcmVudE5vZGUpO28uYWRkZWROb2Rlcz1zLG8ucmVtb3ZlZE5vZGVzPWMsby5wcmV2aW91c1NpYmxpbmc9aCxvLm5leHRTaWJsaW5nPWYsaShlLnJlbGF0ZWROb2RlLGZ1bmN0aW9uKGUpe3JldHVybiBlLmNoaWxkTGlzdD9vOnZvaWQgMH0pfWQoKX19LGUuSnNNdXRhdGlvbk9ic2VydmVyPWEsZS5NdXRhdGlvbk9ic2VydmVyfHwoZS5NdXRhdGlvbk9ic2VydmVyPWEpfShzZWxmKSx3aW5kb3cuSFRNTEltcG9ydHM9d2luZG93LkhUTUxJbXBvcnRzfHx7ZmxhZ3M6e319LGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoZSx0KXt0PXR8fGYscihmdW5jdGlvbigpe2koZSx0KX0sdCl9ZnVuY3Rpb24gbihlKXtyZXR1cm5cImNvbXBsZXRlXCI9PT1lLnJlYWR5U3RhdGV8fGUucmVhZHlTdGF0ZT09PXZ9ZnVuY3Rpb24gcihlLHQpe2lmKG4odCkpZSYmZSgpO2Vsc2V7dmFyIG89ZnVuY3Rpb24oKXsoXCJjb21wbGV0ZVwiPT09dC5yZWFkeVN0YXRlfHx0LnJlYWR5U3RhdGU9PT12KSYmKHQucmVtb3ZlRXZlbnRMaXN0ZW5lcihnLG8pLHIoZSx0KSl9O3QuYWRkRXZlbnRMaXN0ZW5lcihnLG8pfX1mdW5jdGlvbiBvKGUpe2UudGFyZ2V0Ll9fbG9hZGVkPSEwfWZ1bmN0aW9uIGkoZSx0KXtmdW5jdGlvbiBuKCl7Yz09bCYmZSYmZSh7YWxsSW1wb3J0czpzLGxvYWRlZEltcG9ydHM6dSxlcnJvckltcG9ydHM6ZH0pfWZ1bmN0aW9uIHIoZSl7byhlKSx1LnB1c2godGhpcyksYysrLG4oKX1mdW5jdGlvbiBpKGUpe2QucHVzaCh0aGlzKSxjKyssbigpfXZhciBzPXQucXVlcnlTZWxlY3RvckFsbChcImxpbmtbcmVsPWltcG9ydF1cIiksYz0wLGw9cy5sZW5ndGgsdT1bXSxkPVtdO2lmKGwpZm9yKHZhciBwLGg9MDtsPmgmJihwPXNbaF0pO2grKylhKHApPyhjKyssbigpKToocC5hZGRFdmVudExpc3RlbmVyKFwibG9hZFwiLHIpLHAuYWRkRXZlbnRMaXN0ZW5lcihcImVycm9yXCIsaSkpO2Vsc2UgbigpfWZ1bmN0aW9uIGEoZSl7cmV0dXJuIGQ/ZS5fX2xvYWRlZHx8ZVtcImltcG9ydFwiXSYmXCJsb2FkaW5nXCIhPT1lW1wiaW1wb3J0XCJdLnJlYWR5U3RhdGU6ZS5fX2ltcG9ydFBhcnNlZH1mdW5jdGlvbiBzKGUpe2Zvcih2YXIgdCxuPTAscj1lLmxlbmd0aDtyPm4mJih0PWVbbl0pO24rKyljKHQpJiZsKHQpfWZ1bmN0aW9uIGMoZSl7cmV0dXJuXCJsaW5rXCI9PT1lLmxvY2FsTmFtZSYmXCJpbXBvcnRcIj09PWUucmVsfWZ1bmN0aW9uIGwoZSl7dmFyIHQ9ZVtcImltcG9ydFwiXTt0P28oe3RhcmdldDplfSk6KGUuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIixvKSxlLmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLG8pKX12YXIgdT1cImltcG9ydFwiLGQ9Qm9vbGVhbih1IGluIGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJsaW5rXCIpKSxwPUJvb2xlYW4od2luZG93LlNoYWRvd0RPTVBvbHlmaWxsKSxoPWZ1bmN0aW9uKGUpe3JldHVybiBwP3dpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbC53cmFwSWZOZWVkZWQoZSk6ZX0sZj1oKGRvY3VtZW50KSxtPXtnZXQ6ZnVuY3Rpb24oKXt2YXIgZT13aW5kb3cuSFRNTEltcG9ydHMuY3VycmVudFNjcmlwdHx8ZG9jdW1lbnQuY3VycmVudFNjcmlwdHx8KFwiY29tcGxldGVcIiE9PWRvY3VtZW50LnJlYWR5U3RhdGU/ZG9jdW1lbnQuc2NyaXB0c1tkb2N1bWVudC5zY3JpcHRzLmxlbmd0aC0xXTpudWxsKTtyZXR1cm4gaChlKX0sY29uZmlndXJhYmxlOiEwfTtPYmplY3QuZGVmaW5lUHJvcGVydHkoZG9jdW1lbnQsXCJfY3VycmVudFNjcmlwdFwiLG0pLE9iamVjdC5kZWZpbmVQcm9wZXJ0eShmLFwiX2N1cnJlbnRTY3JpcHRcIixtKTt2YXIgdz0vVHJpZGVudC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KSx2PXc/XCJjb21wbGV0ZVwiOlwiaW50ZXJhY3RpdmVcIixnPVwicmVhZHlzdGF0ZWNoYW5nZVwiO2QmJihuZXcgTXV0YXRpb25PYnNlcnZlcihmdW5jdGlvbihlKXtmb3IodmFyIHQsbj0wLHI9ZS5sZW5ndGg7cj5uJiYodD1lW25dKTtuKyspdC5hZGRlZE5vZGVzJiZzKHQuYWRkZWROb2Rlcyl9KS5vYnNlcnZlKGRvY3VtZW50LmhlYWQse2NoaWxkTGlzdDohMH0pLGZ1bmN0aW9uKCl7aWYoXCJsb2FkaW5nXCI9PT1kb2N1bWVudC5yZWFkeVN0YXRlKWZvcih2YXIgZSx0PWRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCJsaW5rW3JlbD1pbXBvcnRdXCIpLG49MCxyPXQubGVuZ3RoO3I+biYmKGU9dFtuXSk7bisrKWwoZSl9KCkpLHQoZnVuY3Rpb24oZSl7d2luZG93LkhUTUxJbXBvcnRzLnJlYWR5PSEwLHdpbmRvdy5IVE1MSW1wb3J0cy5yZWFkeVRpbWU9KG5ldyBEYXRlKS5nZXRUaW1lKCk7dmFyIHQ9Zi5jcmVhdGVFdmVudChcIkN1c3RvbUV2ZW50XCIpO3QuaW5pdEN1c3RvbUV2ZW50KFwiSFRNTEltcG9ydHNMb2FkZWRcIiwhMCwhMCxlKSxmLmRpc3BhdGNoRXZlbnQodCl9KSxlLklNUE9SVF9MSU5LX1RZUEU9dSxlLnVzZU5hdGl2ZT1kLGUucm9vdERvY3VtZW50PWYsZS53aGVuUmVhZHk9dCxlLmlzSUU9d30od2luZG93LkhUTUxJbXBvcnRzKSxmdW5jdGlvbihlKXt2YXIgdD1bXSxuPWZ1bmN0aW9uKGUpe3QucHVzaChlKX0scj1mdW5jdGlvbigpe3QuZm9yRWFjaChmdW5jdGlvbih0KXt0KGUpfSl9O2UuYWRkTW9kdWxlPW4sZS5pbml0aWFsaXplTW9kdWxlcz1yfSh3aW5kb3cuSFRNTEltcG9ydHMpLHdpbmRvdy5IVE1MSW1wb3J0cy5hZGRNb2R1bGUoZnVuY3Rpb24oZSl7dmFyIHQ9Lyh1cmxcXCgpKFteKV0qKShcXCkpL2csbj0vKEBpbXBvcnRbXFxzXSsoPyF1cmxcXCgpKShbXjtdKikoOykvZyxyPXtyZXNvbHZlVXJsc0luU3R5bGU6ZnVuY3Rpb24oZSx0KXt2YXIgbj1lLm93bmVyRG9jdW1lbnQscj1uLmNyZWF0ZUVsZW1lbnQoXCJhXCIpO3JldHVybiBlLnRleHRDb250ZW50PXRoaXMucmVzb2x2ZVVybHNJbkNzc1RleHQoZS50ZXh0Q29udGVudCx0LHIpLGV9LHJlc29sdmVVcmxzSW5Dc3NUZXh0OmZ1bmN0aW9uKGUscixvKXt2YXIgaT10aGlzLnJlcGxhY2VVcmxzKGUsbyxyLHQpO3JldHVybiBpPXRoaXMucmVwbGFjZVVybHMoaSxvLHIsbil9LHJlcGxhY2VVcmxzOmZ1bmN0aW9uKGUsdCxuLHIpe3JldHVybiBlLnJlcGxhY2UocixmdW5jdGlvbihlLHIsbyxpKXt2YXIgYT1vLnJlcGxhY2UoL1tcIiddL2csXCJcIik7cmV0dXJuIG4mJihhPW5ldyBVUkwoYSxuKS5ocmVmKSx0LmhyZWY9YSxhPXQuaHJlZixyK1wiJ1wiK2ErXCInXCIraX0pfX07ZS5wYXRoPXJ9KSx3aW5kb3cuSFRNTEltcG9ydHMuYWRkTW9kdWxlKGZ1bmN0aW9uKGUpe1xudmFyIHQ9e2FzeW5jOiEwLG9rOmZ1bmN0aW9uKGUpe3JldHVybiBlLnN0YXR1cz49MjAwJiZlLnN0YXR1czwzMDB8fDMwND09PWUuc3RhdHVzfHwwPT09ZS5zdGF0dXN9LGxvYWQ6ZnVuY3Rpb24obixyLG8pe3ZhciBpPW5ldyBYTUxIdHRwUmVxdWVzdDtyZXR1cm4oZS5mbGFncy5kZWJ1Z3x8ZS5mbGFncy5idXN0KSYmKG4rPVwiP1wiK01hdGgucmFuZG9tKCkpLGkub3BlbihcIkdFVFwiLG4sdC5hc3luYyksaS5hZGRFdmVudExpc3RlbmVyKFwicmVhZHlzdGF0ZWNoYW5nZVwiLGZ1bmN0aW9uKGUpe2lmKDQ9PT1pLnJlYWR5U3RhdGUpe3ZhciBuPWkuZ2V0UmVzcG9uc2VIZWFkZXIoXCJMb2NhdGlvblwiKSxhPW51bGw7aWYobil2YXIgYT1cIi9cIj09PW4uc3Vic3RyKDAsMSk/bG9jYXRpb24ub3JpZ2luK246bjtyLmNhbGwobywhdC5vayhpKSYmaSxpLnJlc3BvbnNlfHxpLnJlc3BvbnNlVGV4dCxhKX19KSxpLnNlbmQoKSxpfSxsb2FkRG9jdW1lbnQ6ZnVuY3Rpb24oZSx0LG4pe3RoaXMubG9hZChlLHQsbikucmVzcG9uc2VUeXBlPVwiZG9jdW1lbnRcIn19O2UueGhyPXR9KSx3aW5kb3cuSFRNTEltcG9ydHMuYWRkTW9kdWxlKGZ1bmN0aW9uKGUpe3ZhciB0PWUueGhyLG49ZS5mbGFncyxyPWZ1bmN0aW9uKGUsdCl7dGhpcy5jYWNoZT17fSx0aGlzLm9ubG9hZD1lLHRoaXMub25jb21wbGV0ZT10LHRoaXMuaW5mbGlnaHQ9MCx0aGlzLnBlbmRpbmc9e319O3IucHJvdG90eXBlPXthZGROb2RlczpmdW5jdGlvbihlKXt0aGlzLmluZmxpZ2h0Kz1lLmxlbmd0aDtmb3IodmFyIHQsbj0wLHI9ZS5sZW5ndGg7cj5uJiYodD1lW25dKTtuKyspdGhpcy5yZXF1aXJlKHQpO3RoaXMuY2hlY2tEb25lKCl9LGFkZE5vZGU6ZnVuY3Rpb24oZSl7dGhpcy5pbmZsaWdodCsrLHRoaXMucmVxdWlyZShlKSx0aGlzLmNoZWNrRG9uZSgpfSxyZXF1aXJlOmZ1bmN0aW9uKGUpe3ZhciB0PWUuc3JjfHxlLmhyZWY7ZS5fX25vZGVVcmw9dCx0aGlzLmRlZHVwZSh0LGUpfHx0aGlzLmZldGNoKHQsZSl9LGRlZHVwZTpmdW5jdGlvbihlLHQpe2lmKHRoaXMucGVuZGluZ1tlXSlyZXR1cm4gdGhpcy5wZW5kaW5nW2VdLnB1c2godCksITA7cmV0dXJuIHRoaXMuY2FjaGVbZV0/KHRoaXMub25sb2FkKGUsdCx0aGlzLmNhY2hlW2VdKSx0aGlzLnRhaWwoKSwhMCk6KHRoaXMucGVuZGluZ1tlXT1bdF0sITEpfSxmZXRjaDpmdW5jdGlvbihlLHIpe2lmKG4ubG9hZCYmY29uc29sZS5sb2coXCJmZXRjaFwiLGUsciksZSlpZihlLm1hdGNoKC9eZGF0YTovKSl7dmFyIG89ZS5zcGxpdChcIixcIiksaT1vWzBdLGE9b1sxXTthPWkuaW5kZXhPZihcIjtiYXNlNjRcIik+LTE/YXRvYihhKTpkZWNvZGVVUklDb21wb25lbnQoYSksc2V0VGltZW91dChmdW5jdGlvbigpe3RoaXMucmVjZWl2ZShlLHIsbnVsbCxhKX0uYmluZCh0aGlzKSwwKX1lbHNle3ZhciBzPWZ1bmN0aW9uKHQsbixvKXt0aGlzLnJlY2VpdmUoZSxyLHQsbixvKX0uYmluZCh0aGlzKTt0LmxvYWQoZSxzKX1lbHNlIHNldFRpbWVvdXQoZnVuY3Rpb24oKXt0aGlzLnJlY2VpdmUoZSxyLHtlcnJvcjpcImhyZWYgbXVzdCBiZSBzcGVjaWZpZWRcIn0sbnVsbCl9LmJpbmQodGhpcyksMCl9LHJlY2VpdmU6ZnVuY3Rpb24oZSx0LG4scixvKXt0aGlzLmNhY2hlW2VdPXI7Zm9yKHZhciBpLGE9dGhpcy5wZW5kaW5nW2VdLHM9MCxjPWEubGVuZ3RoO2M+cyYmKGk9YVtzXSk7cysrKXRoaXMub25sb2FkKGUsaSxyLG4sbyksdGhpcy50YWlsKCk7dGhpcy5wZW5kaW5nW2VdPW51bGx9LHRhaWw6ZnVuY3Rpb24oKXstLXRoaXMuaW5mbGlnaHQsdGhpcy5jaGVja0RvbmUoKX0sY2hlY2tEb25lOmZ1bmN0aW9uKCl7dGhpcy5pbmZsaWdodHx8dGhpcy5vbmNvbXBsZXRlKCl9fSxlLkxvYWRlcj1yfSksd2luZG93LkhUTUxJbXBvcnRzLmFkZE1vZHVsZShmdW5jdGlvbihlKXt2YXIgdD1mdW5jdGlvbihlKXt0aGlzLmFkZENhbGxiYWNrPWUsdGhpcy5tbz1uZXcgTXV0YXRpb25PYnNlcnZlcih0aGlzLmhhbmRsZXIuYmluZCh0aGlzKSl9O3QucHJvdG90eXBlPXtoYW5kbGVyOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdCxuPTAscj1lLmxlbmd0aDtyPm4mJih0PWVbbl0pO24rKylcImNoaWxkTGlzdFwiPT09dC50eXBlJiZ0LmFkZGVkTm9kZXMubGVuZ3RoJiZ0aGlzLmFkZGVkTm9kZXModC5hZGRlZE5vZGVzKX0sYWRkZWROb2RlczpmdW5jdGlvbihlKXt0aGlzLmFkZENhbGxiYWNrJiZ0aGlzLmFkZENhbGxiYWNrKGUpO2Zvcih2YXIgdCxuPTAscj1lLmxlbmd0aDtyPm4mJih0PWVbbl0pO24rKyl0LmNoaWxkcmVuJiZ0LmNoaWxkcmVuLmxlbmd0aCYmdGhpcy5hZGRlZE5vZGVzKHQuY2hpbGRyZW4pfSxvYnNlcnZlOmZ1bmN0aW9uKGUpe3RoaXMubW8ub2JzZXJ2ZShlLHtjaGlsZExpc3Q6ITAsc3VidHJlZTohMH0pfX0sZS5PYnNlcnZlcj10fSksd2luZG93LkhUTUxJbXBvcnRzLmFkZE1vZHVsZShmdW5jdGlvbihlKXtmdW5jdGlvbiB0KGUpe3JldHVyblwibGlua1wiPT09ZS5sb2NhbE5hbWUmJmUucmVsPT09dX1mdW5jdGlvbiBuKGUpe3ZhciB0PXIoZSk7cmV0dXJuXCJkYXRhOnRleHQvamF2YXNjcmlwdDtjaGFyc2V0PXV0Zi04LFwiK2VuY29kZVVSSUNvbXBvbmVudCh0KX1mdW5jdGlvbiByKGUpe3JldHVybiBlLnRleHRDb250ZW50K28oZSl9ZnVuY3Rpb24gbyhlKXt2YXIgdD1lLm93bmVyRG9jdW1lbnQ7dC5fX2ltcG9ydGVkU2NyaXB0cz10Ll9faW1wb3J0ZWRTY3JpcHRzfHwwO3ZhciBuPWUub3duZXJEb2N1bWVudC5iYXNlVVJJLHI9dC5fX2ltcG9ydGVkU2NyaXB0cz9cIi1cIit0Ll9faW1wb3J0ZWRTY3JpcHRzOlwiXCI7cmV0dXJuIHQuX19pbXBvcnRlZFNjcmlwdHMrKyxcIlxcbi8vIyBzb3VyY2VVUkw9XCIrbityK1wiLmpzXFxuXCJ9ZnVuY3Rpb24gaShlKXt2YXIgdD1lLm93bmVyRG9jdW1lbnQuY3JlYXRlRWxlbWVudChcInN0eWxlXCIpO3JldHVybiB0LnRleHRDb250ZW50PWUudGV4dENvbnRlbnQsYS5yZXNvbHZlVXJsc0luU3R5bGUodCksdH12YXIgYT1lLnBhdGgscz1lLnJvb3REb2N1bWVudCxjPWUuZmxhZ3MsbD1lLmlzSUUsdT1lLklNUE9SVF9MSU5LX1RZUEUsZD1cImxpbmtbcmVsPVwiK3UrXCJdXCIscD17ZG9jdW1lbnRTZWxlY3RvcnM6ZCxpbXBvcnRzU2VsZWN0b3JzOltkLFwibGlua1tyZWw9c3R5bGVzaGVldF06bm90KFt0eXBlXSlcIixcInN0eWxlOm5vdChbdHlwZV0pXCIsXCJzY3JpcHQ6bm90KFt0eXBlXSlcIiwnc2NyaXB0W3R5cGU9XCJhcHBsaWNhdGlvbi9qYXZhc2NyaXB0XCJdJywnc2NyaXB0W3R5cGU9XCJ0ZXh0L2phdmFzY3JpcHRcIl0nXS5qb2luKFwiLFwiKSxtYXA6e2xpbms6XCJwYXJzZUxpbmtcIixzY3JpcHQ6XCJwYXJzZVNjcmlwdFwiLHN0eWxlOlwicGFyc2VTdHlsZVwifSxkeW5hbWljRWxlbWVudHM6W10scGFyc2VOZXh0OmZ1bmN0aW9uKCl7dmFyIGU9dGhpcy5uZXh0VG9QYXJzZSgpO2UmJnRoaXMucGFyc2UoZSl9LHBhcnNlOmZ1bmN0aW9uKGUpe2lmKHRoaXMuaXNQYXJzZWQoZSkpcmV0dXJuIHZvaWQoYy5wYXJzZSYmY29uc29sZS5sb2coXCJbJXNdIGlzIGFscmVhZHkgcGFyc2VkXCIsZS5sb2NhbE5hbWUpKTt2YXIgdD10aGlzW3RoaXMubWFwW2UubG9jYWxOYW1lXV07dCYmKHRoaXMubWFya1BhcnNpbmcoZSksdC5jYWxsKHRoaXMsZSkpfSxwYXJzZUR5bmFtaWM6ZnVuY3Rpb24oZSx0KXt0aGlzLmR5bmFtaWNFbGVtZW50cy5wdXNoKGUpLHR8fHRoaXMucGFyc2VOZXh0KCl9LG1hcmtQYXJzaW5nOmZ1bmN0aW9uKGUpe2MucGFyc2UmJmNvbnNvbGUubG9nKFwicGFyc2luZ1wiLGUpLHRoaXMucGFyc2luZ0VsZW1lbnQ9ZX0sbWFya1BhcnNpbmdDb21wbGV0ZTpmdW5jdGlvbihlKXtlLl9faW1wb3J0UGFyc2VkPSEwLHRoaXMubWFya0R5bmFtaWNQYXJzaW5nQ29tcGxldGUoZSksZS5fX2ltcG9ydEVsZW1lbnQmJihlLl9faW1wb3J0RWxlbWVudC5fX2ltcG9ydFBhcnNlZD0hMCx0aGlzLm1hcmtEeW5hbWljUGFyc2luZ0NvbXBsZXRlKGUuX19pbXBvcnRFbGVtZW50KSksdGhpcy5wYXJzaW5nRWxlbWVudD1udWxsLGMucGFyc2UmJmNvbnNvbGUubG9nKFwiY29tcGxldGVkXCIsZSl9LG1hcmtEeW5hbWljUGFyc2luZ0NvbXBsZXRlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMuZHluYW1pY0VsZW1lbnRzLmluZGV4T2YoZSk7dD49MCYmdGhpcy5keW5hbWljRWxlbWVudHMuc3BsaWNlKHQsMSl9LHBhcnNlSW1wb3J0OmZ1bmN0aW9uKGUpe2lmKGVbXCJpbXBvcnRcIl09ZS5fX2RvYyx3aW5kb3cuSFRNTEltcG9ydHMuX19pbXBvcnRzUGFyc2luZ0hvb2smJndpbmRvdy5IVE1MSW1wb3J0cy5fX2ltcG9ydHNQYXJzaW5nSG9vayhlKSxlW1wiaW1wb3J0XCJdJiYoZVtcImltcG9ydFwiXS5fX2ltcG9ydFBhcnNlZD0hMCksdGhpcy5tYXJrUGFyc2luZ0NvbXBsZXRlKGUpLGUuX19yZXNvdXJjZSYmIWUuX19lcnJvcj9lLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwibG9hZFwiLHtidWJibGVzOiExfSkpOmUuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJlcnJvclwiLHtidWJibGVzOiExfSkpLGUuX19wZW5kaW5nKWZvcih2YXIgdDtlLl9fcGVuZGluZy5sZW5ndGg7KXQ9ZS5fX3BlbmRpbmcuc2hpZnQoKSx0JiZ0KHt0YXJnZXQ6ZX0pO3RoaXMucGFyc2VOZXh0KCl9LHBhcnNlTGluazpmdW5jdGlvbihlKXt0KGUpP3RoaXMucGFyc2VJbXBvcnQoZSk6KGUuaHJlZj1lLmhyZWYsdGhpcy5wYXJzZUdlbmVyaWMoZSkpfSxwYXJzZVN0eWxlOmZ1bmN0aW9uKGUpe3ZhciB0PWU7ZT1pKGUpLHQuX19hcHBsaWVkRWxlbWVudD1lLGUuX19pbXBvcnRFbGVtZW50PXQsdGhpcy5wYXJzZUdlbmVyaWMoZSl9LHBhcnNlR2VuZXJpYzpmdW5jdGlvbihlKXt0aGlzLnRyYWNrRWxlbWVudChlKSx0aGlzLmFkZEVsZW1lbnRUb0RvY3VtZW50KGUpfSxyb290SW1wb3J0Rm9yRWxlbWVudDpmdW5jdGlvbihlKXtmb3IodmFyIHQ9ZTt0Lm93bmVyRG9jdW1lbnQuX19pbXBvcnRMaW5rOyl0PXQub3duZXJEb2N1bWVudC5fX2ltcG9ydExpbms7cmV0dXJuIHR9LGFkZEVsZW1lbnRUb0RvY3VtZW50OmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMucm9vdEltcG9ydEZvckVsZW1lbnQoZS5fX2ltcG9ydEVsZW1lbnR8fGUpO3QucGFyZW50Tm9kZS5pbnNlcnRCZWZvcmUoZSx0KX0sdHJhY2tFbGVtZW50OmZ1bmN0aW9uKGUsdCl7dmFyIG49dGhpcyxyPWZ1bmN0aW9uKG8pe2UucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImxvYWRcIixyKSxlLnJlbW92ZUV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLHIpLHQmJnQobyksbi5tYXJrUGFyc2luZ0NvbXBsZXRlKGUpLG4ucGFyc2VOZXh0KCl9O2lmKGUuYWRkRXZlbnRMaXN0ZW5lcihcImxvYWRcIixyKSxlLmFkZEV2ZW50TGlzdGVuZXIoXCJlcnJvclwiLHIpLGwmJlwic3R5bGVcIj09PWUubG9jYWxOYW1lKXt2YXIgbz0hMTtpZigtMT09ZS50ZXh0Q29udGVudC5pbmRleE9mKFwiQGltcG9ydFwiKSlvPSEwO2Vsc2UgaWYoZS5zaGVldCl7bz0hMDtmb3IodmFyIGksYT1lLnNoZWV0LmNzc1J1bGVzLHM9YT9hLmxlbmd0aDowLGM9MDtzPmMmJihpPWFbY10pO2MrKylpLnR5cGU9PT1DU1NSdWxlLklNUE9SVF9SVUxFJiYobz1vJiZCb29sZWFuKGkuc3R5bGVTaGVldCkpfW8mJnNldFRpbWVvdXQoZnVuY3Rpb24oKXtlLmRpc3BhdGNoRXZlbnQobmV3IEN1c3RvbUV2ZW50KFwibG9hZFwiLHtidWJibGVzOiExfSkpfSl9fSxwYXJzZVNjcmlwdDpmdW5jdGlvbih0KXt2YXIgcj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic2NyaXB0XCIpO3IuX19pbXBvcnRFbGVtZW50PXQsci5zcmM9dC5zcmM/dC5zcmM6bih0KSxlLmN1cnJlbnRTY3JpcHQ9dCx0aGlzLnRyYWNrRWxlbWVudChyLGZ1bmN0aW9uKHQpe3IucGFyZW50Tm9kZSYmci5wYXJlbnROb2RlLnJlbW92ZUNoaWxkKHIpLGUuY3VycmVudFNjcmlwdD1udWxsfSksdGhpcy5hZGRFbGVtZW50VG9Eb2N1bWVudChyKX0sbmV4dFRvUGFyc2U6ZnVuY3Rpb24oKXtyZXR1cm4gdGhpcy5fbWF5UGFyc2U9W10sIXRoaXMucGFyc2luZ0VsZW1lbnQmJih0aGlzLm5leHRUb1BhcnNlSW5Eb2Mocyl8fHRoaXMubmV4dFRvUGFyc2VEeW5hbWljKCkpfSxuZXh0VG9QYXJzZUluRG9jOmZ1bmN0aW9uKGUsbil7aWYoZSYmdGhpcy5fbWF5UGFyc2UuaW5kZXhPZihlKTwwKXt0aGlzLl9tYXlQYXJzZS5wdXNoKGUpO2Zvcih2YXIgcixvPWUucXVlcnlTZWxlY3RvckFsbCh0aGlzLnBhcnNlU2VsZWN0b3JzRm9yTm9kZShlKSksaT0wLGE9by5sZW5ndGg7YT5pJiYocj1vW2ldKTtpKyspaWYoIXRoaXMuaXNQYXJzZWQocikpcmV0dXJuIHRoaXMuaGFzUmVzb3VyY2Uocik/dChyKT90aGlzLm5leHRUb1BhcnNlSW5Eb2Moci5fX2RvYyxyKTpyOnZvaWQgMH1yZXR1cm4gbn0sbmV4dFRvUGFyc2VEeW5hbWljOmZ1bmN0aW9uKCl7cmV0dXJuIHRoaXMuZHluYW1pY0VsZW1lbnRzWzBdfSxwYXJzZVNlbGVjdG9yc0Zvck5vZGU6ZnVuY3Rpb24oZSl7dmFyIHQ9ZS5vd25lckRvY3VtZW50fHxlO3JldHVybiB0PT09cz90aGlzLmRvY3VtZW50U2VsZWN0b3JzOnRoaXMuaW1wb3J0c1NlbGVjdG9yc30saXNQYXJzZWQ6ZnVuY3Rpb24oZSl7cmV0dXJuIGUuX19pbXBvcnRQYXJzZWR9LG5lZWRzRHluYW1pY1BhcnNpbmc6ZnVuY3Rpb24oZSl7cmV0dXJuIHRoaXMuZHluYW1pY0VsZW1lbnRzLmluZGV4T2YoZSk+PTB9LGhhc1Jlc291cmNlOmZ1bmN0aW9uKGUpe3JldHVybiB0KGUpJiZ2b2lkIDA9PT1lLl9fZG9jPyExOiEwfX07ZS5wYXJzZXI9cCxlLklNUE9SVF9TRUxFQ1RPUj1kfSksd2luZG93LkhUTUxJbXBvcnRzLmFkZE1vZHVsZShmdW5jdGlvbihlKXtmdW5jdGlvbiB0KGUpe3JldHVybiBuKGUsYSl9ZnVuY3Rpb24gbihlLHQpe3JldHVyblwibGlua1wiPT09ZS5sb2NhbE5hbWUmJmUuZ2V0QXR0cmlidXRlKFwicmVsXCIpPT09dH1mdW5jdGlvbiByKGUpe3JldHVybiEhT2JqZWN0LmdldE93blByb3BlcnR5RGVzY3JpcHRvcihlLFwiYmFzZVVSSVwiKX1mdW5jdGlvbiBvKGUsdCl7dmFyIG49ZG9jdW1lbnQuaW1wbGVtZW50YXRpb24uY3JlYXRlSFRNTERvY3VtZW50KGEpO24uX1VSTD10O3ZhciBvPW4uY3JlYXRlRWxlbWVudChcImJhc2VcIik7by5zZXRBdHRyaWJ1dGUoXCJocmVmXCIsdCksbi5iYXNlVVJJfHxyKG4pfHxPYmplY3QuZGVmaW5lUHJvcGVydHkobixcImJhc2VVUklcIix7dmFsdWU6dH0pO3ZhciBpPW4uY3JlYXRlRWxlbWVudChcIm1ldGFcIik7cmV0dXJuIGkuc2V0QXR0cmlidXRlKFwiY2hhcnNldFwiLFwidXRmLThcIiksbi5oZWFkLmFwcGVuZENoaWxkKGkpLG4uaGVhZC5hcHBlbmRDaGlsZChvKSxuLmJvZHkuaW5uZXJIVE1MPWUsd2luZG93LkhUTUxUZW1wbGF0ZUVsZW1lbnQmJkhUTUxUZW1wbGF0ZUVsZW1lbnQuYm9vdHN0cmFwJiZIVE1MVGVtcGxhdGVFbGVtZW50LmJvb3RzdHJhcChuKSxufXZhciBpPWUuZmxhZ3MsYT1lLklNUE9SVF9MSU5LX1RZUEUscz1lLklNUE9SVF9TRUxFQ1RPUixjPWUucm9vdERvY3VtZW50LGw9ZS5Mb2FkZXIsdT1lLk9ic2VydmVyLGQ9ZS5wYXJzZXIscD17ZG9jdW1lbnRzOnt9LGRvY3VtZW50UHJlbG9hZFNlbGVjdG9yczpzLGltcG9ydHNQcmVsb2FkU2VsZWN0b3JzOltzXS5qb2luKFwiLFwiKSxsb2FkTm9kZTpmdW5jdGlvbihlKXtoLmFkZE5vZGUoZSl9LGxvYWRTdWJ0cmVlOmZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMubWFyc2hhbE5vZGVzKGUpO2guYWRkTm9kZXModCl9LG1hcnNoYWxOb2RlczpmdW5jdGlvbihlKXtyZXR1cm4gZS5xdWVyeVNlbGVjdG9yQWxsKHRoaXMubG9hZFNlbGVjdG9yc0Zvck5vZGUoZSkpfSxsb2FkU2VsZWN0b3JzRm9yTm9kZTpmdW5jdGlvbihlKXt2YXIgdD1lLm93bmVyRG9jdW1lbnR8fGU7cmV0dXJuIHQ9PT1jP3RoaXMuZG9jdW1lbnRQcmVsb2FkU2VsZWN0b3JzOnRoaXMuaW1wb3J0c1ByZWxvYWRTZWxlY3RvcnN9LGxvYWRlZDpmdW5jdGlvbihlLG4scixhLHMpe2lmKGkubG9hZCYmY29uc29sZS5sb2coXCJsb2FkZWRcIixlLG4pLG4uX19yZXNvdXJjZT1yLG4uX19lcnJvcj1hLHQobikpe3ZhciBjPXRoaXMuZG9jdW1lbnRzW2VdO3ZvaWQgMD09PWMmJihjPWE/bnVsbDpvKHIsc3x8ZSksYyYmKGMuX19pbXBvcnRMaW5rPW4sdGhpcy5ib290RG9jdW1lbnQoYykpLHRoaXMuZG9jdW1lbnRzW2VdPWMpLG4uX19kb2M9Y31kLnBhcnNlTmV4dCgpfSxib290RG9jdW1lbnQ6ZnVuY3Rpb24oZSl7dGhpcy5sb2FkU3VidHJlZShlKSx0aGlzLm9ic2VydmVyLm9ic2VydmUoZSksZC5wYXJzZU5leHQoKX0sbG9hZGVkQWxsOmZ1bmN0aW9uKCl7ZC5wYXJzZU5leHQoKX19LGg9bmV3IGwocC5sb2FkZWQuYmluZChwKSxwLmxvYWRlZEFsbC5iaW5kKHApKTtpZihwLm9ic2VydmVyPW5ldyB1LCFkb2N1bWVudC5iYXNlVVJJKXt2YXIgZj17Z2V0OmZ1bmN0aW9uKCl7dmFyIGU9ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImJhc2VcIik7cmV0dXJuIGU/ZS5ocmVmOndpbmRvdy5sb2NhdGlvbi5ocmVmfSxjb25maWd1cmFibGU6ITB9O09iamVjdC5kZWZpbmVQcm9wZXJ0eShkb2N1bWVudCxcImJhc2VVUklcIixmKSxPYmplY3QuZGVmaW5lUHJvcGVydHkoYyxcImJhc2VVUklcIixmKX1lLmltcG9ydGVyPXAsZS5pbXBvcnRMb2FkZXI9aH0pLHdpbmRvdy5IVE1MSW1wb3J0cy5hZGRNb2R1bGUoZnVuY3Rpb24oZSl7dmFyIHQ9ZS5wYXJzZXIsbj1lLmltcG9ydGVyLHI9e2FkZGVkOmZ1bmN0aW9uKGUpe2Zvcih2YXIgcixvLGksYSxzPTAsYz1lLmxlbmd0aDtjPnMmJihhPWVbc10pO3MrKylyfHwocj1hLm93bmVyRG9jdW1lbnQsbz10LmlzUGFyc2VkKHIpKSxpPXRoaXMuc2hvdWxkTG9hZE5vZGUoYSksaSYmbi5sb2FkTm9kZShhKSx0aGlzLnNob3VsZFBhcnNlTm9kZShhKSYmbyYmdC5wYXJzZUR5bmFtaWMoYSxpKX0sc2hvdWxkTG9hZE5vZGU6ZnVuY3Rpb24oZSl7cmV0dXJuIDE9PT1lLm5vZGVUeXBlJiZvLmNhbGwoZSxuLmxvYWRTZWxlY3RvcnNGb3JOb2RlKGUpKX0sc2hvdWxkUGFyc2VOb2RlOmZ1bmN0aW9uKGUpe3JldHVybiAxPT09ZS5ub2RlVHlwZSYmby5jYWxsKGUsdC5wYXJzZVNlbGVjdG9yc0Zvck5vZGUoZSkpfX07bi5vYnNlcnZlci5hZGRDYWxsYmFjaz1yLmFkZGVkLmJpbmQocik7dmFyIG89SFRNTEVsZW1lbnQucHJvdG90eXBlLm1hdGNoZXN8fEhUTUxFbGVtZW50LnByb3RvdHlwZS5tYXRjaGVzU2VsZWN0b3J8fEhUTUxFbGVtZW50LnByb3RvdHlwZS53ZWJraXRNYXRjaGVzU2VsZWN0b3J8fEhUTUxFbGVtZW50LnByb3RvdHlwZS5tb3pNYXRjaGVzU2VsZWN0b3J8fEhUTUxFbGVtZW50LnByb3RvdHlwZS5tc01hdGNoZXNTZWxlY3Rvcn0pLGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoKXt3aW5kb3cuSFRNTEltcG9ydHMuaW1wb3J0ZXIuYm9vdERvY3VtZW50KG8pfXZhciBuPWUuaW5pdGlhbGl6ZU1vZHVsZXMscj1lLmlzSUU7aWYoIWUudXNlTmF0aXZlKXtyJiZcImZ1bmN0aW9uXCIhPXR5cGVvZiB3aW5kb3cuQ3VzdG9tRXZlbnQmJih3aW5kb3cuQ3VzdG9tRXZlbnQ9ZnVuY3Rpb24oZSx0KXt0PXR8fHt9O3ZhciBuPWRvY3VtZW50LmNyZWF0ZUV2ZW50KFwiQ3VzdG9tRXZlbnRcIik7cmV0dXJuIG4uaW5pdEN1c3RvbUV2ZW50KGUsQm9vbGVhbih0LmJ1YmJsZXMpLEJvb2xlYW4odC5jYW5jZWxhYmxlKSx0LmRldGFpbCksbi5wcmV2ZW50RGVmYXVsdD1mdW5jdGlvbigpe09iamVjdC5kZWZpbmVQcm9wZXJ0eSh0aGlzLFwiZGVmYXVsdFByZXZlbnRlZFwiLHtnZXQ6ZnVuY3Rpb24oKXtyZXR1cm4hMH19KX0sbn0sd2luZG93LkN1c3RvbUV2ZW50LnByb3RvdHlwZT13aW5kb3cuRXZlbnQucHJvdG90eXBlKSxuKCk7dmFyIG89ZS5yb290RG9jdW1lbnQ7XCJjb21wbGV0ZVwiPT09ZG9jdW1lbnQucmVhZHlTdGF0ZXx8XCJpbnRlcmFjdGl2ZVwiPT09ZG9jdW1lbnQucmVhZHlTdGF0ZSYmIXdpbmRvdy5hdHRhY2hFdmVudD90KCk6ZG9jdW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIkRPTUNvbnRlbnRMb2FkZWRcIix0KX19KHdpbmRvdy5IVE1MSW1wb3J0cyksd2luZG93LkN1c3RvbUVsZW1lbnRzPXdpbmRvdy5DdXN0b21FbGVtZW50c3x8e2ZsYWdzOnt9fSxmdW5jdGlvbihlKXt2YXIgdD1lLmZsYWdzLG49W10scj1mdW5jdGlvbihlKXtuLnB1c2goZSl9LG89ZnVuY3Rpb24oKXtuLmZvckVhY2goZnVuY3Rpb24odCl7dChlKX0pfTtlLmFkZE1vZHVsZT1yLGUuaW5pdGlhbGl6ZU1vZHVsZXM9byxlLmhhc05hdGl2ZT1Cb29sZWFuKGRvY3VtZW50LnJlZ2lzdGVyRWxlbWVudCksZS5pc0lFPS9UcmlkZW50Ly50ZXN0KG5hdmlnYXRvci51c2VyQWdlbnQpLGUudXNlTmF0aXZlPSF0LnJlZ2lzdGVyJiZlLmhhc05hdGl2ZSYmIXdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbCYmKCF3aW5kb3cuSFRNTEltcG9ydHN8fHdpbmRvdy5IVE1MSW1wb3J0cy51c2VOYXRpdmUpfSh3aW5kb3cuQ3VzdG9tRWxlbWVudHMpLHdpbmRvdy5DdXN0b21FbGVtZW50cy5hZGRNb2R1bGUoZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlLHQpe24oZSxmdW5jdGlvbihlKXtyZXR1cm4gdChlKT8hMDp2b2lkIHIoZSx0KX0pLHIoZSx0KX1mdW5jdGlvbiBuKGUsdCxyKXt2YXIgbz1lLmZpcnN0RWxlbWVudENoaWxkO2lmKCFvKWZvcihvPWUuZmlyc3RDaGlsZDtvJiZvLm5vZGVUeXBlIT09Tm9kZS5FTEVNRU5UX05PREU7KW89by5uZXh0U2libGluZztmb3IoO287KXQobyxyKSE9PSEwJiZuKG8sdCxyKSxvPW8ubmV4dEVsZW1lbnRTaWJsaW5nO3JldHVybiBudWxsfWZ1bmN0aW9uIHIoZSxuKXtmb3IodmFyIHI9ZS5zaGFkb3dSb290O3I7KXQocixuKSxyPXIub2xkZXJTaGFkb3dSb290fWZ1bmN0aW9uIG8oZSx0KXtpKGUsdCxbXSl9ZnVuY3Rpb24gaShlLHQsbil7aWYoZT13aW5kb3cud3JhcChlKSwhKG4uaW5kZXhPZihlKT49MCkpe24ucHVzaChlKTtmb3IodmFyIHIsbz1lLnF1ZXJ5U2VsZWN0b3JBbGwoXCJsaW5rW3JlbD1cIithK1wiXVwiKSxzPTAsYz1vLmxlbmd0aDtjPnMmJihyPW9bc10pO3MrKylyW1wiaW1wb3J0XCJdJiZpKHJbXCJpbXBvcnRcIl0sdCxuKTt0KGUpfX12YXIgYT13aW5kb3cuSFRNTEltcG9ydHM/d2luZG93LkhUTUxJbXBvcnRzLklNUE9SVF9MSU5LX1RZUEU6XCJub25lXCI7ZS5mb3JEb2N1bWVudFRyZWU9byxlLmZvclN1YnRyZWU9dH0pLHdpbmRvdy5DdXN0b21FbGVtZW50cy5hZGRNb2R1bGUoZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdChlLHQpe3JldHVybiBuKGUsdCl8fHIoZSx0KX1mdW5jdGlvbiBuKHQsbil7cmV0dXJuIGUudXBncmFkZSh0LG4pPyEwOnZvaWQobiYmYSh0KSl9ZnVuY3Rpb24gcihlLHQpe2IoZSxmdW5jdGlvbihlKXtyZXR1cm4gbihlLHQpPyEwOnZvaWQgMH0pfWZ1bmN0aW9uIG8oZSl7Uy5wdXNoKGUpLF98fChfPSEwLHNldFRpbWVvdXQoaSkpfWZ1bmN0aW9uIGkoKXtfPSExO2Zvcih2YXIgZSx0PVMsbj0wLHI9dC5sZW5ndGg7cj5uJiYoZT10W25dKTtuKyspZSgpO1M9W119ZnVuY3Rpb24gYShlKXtFP28oZnVuY3Rpb24oKXtzKGUpfSk6cyhlKX1mdW5jdGlvbiBzKGUpe2UuX191cGdyYWRlZF9fJiYhZS5fX2F0dGFjaGVkJiYoZS5fX2F0dGFjaGVkPSEwLGUuYXR0YWNoZWRDYWxsYmFjayYmZS5hdHRhY2hlZENhbGxiYWNrKCkpfWZ1bmN0aW9uIGMoZSl7bChlKSxiKGUsZnVuY3Rpb24oZSl7bChlKX0pfWZ1bmN0aW9uIGwoZSl7RT9vKGZ1bmN0aW9uKCl7dShlKX0pOnUoZSl9ZnVuY3Rpb24gdShlKXtlLl9fdXBncmFkZWRfXyYmZS5fX2F0dGFjaGVkJiYoZS5fX2F0dGFjaGVkPSExLGUuZGV0YWNoZWRDYWxsYmFjayYmZS5kZXRhY2hlZENhbGxiYWNrKCkpfWZ1bmN0aW9uIGQoZSl7Zm9yKHZhciB0PWUsbj13aW5kb3cud3JhcChkb2N1bWVudCk7dDspe2lmKHQ9PW4pcmV0dXJuITA7dD10LnBhcmVudE5vZGV8fHQubm9kZVR5cGU9PT1Ob2RlLkRPQ1VNRU5UX0ZSQUdNRU5UX05PREUmJnQuaG9zdH19ZnVuY3Rpb24gcChlKXtpZihlLnNoYWRvd1Jvb3QmJiFlLnNoYWRvd1Jvb3QuX193YXRjaGVkKXtnLmRvbSYmY29uc29sZS5sb2coXCJ3YXRjaGluZyBzaGFkb3ctcm9vdCBmb3I6IFwiLGUubG9jYWxOYW1lKTtmb3IodmFyIHQ9ZS5zaGFkb3dSb290O3Q7KW0odCksdD10Lm9sZGVyU2hhZG93Um9vdH19ZnVuY3Rpb24gaChlLG4pe2lmKGcuZG9tKXt2YXIgcj1uWzBdO2lmKHImJlwiY2hpbGRMaXN0XCI9PT1yLnR5cGUmJnIuYWRkZWROb2RlcyYmci5hZGRlZE5vZGVzKXtmb3IodmFyIG89ci5hZGRlZE5vZGVzWzBdO28mJm8hPT1kb2N1bWVudCYmIW8uaG9zdDspbz1vLnBhcmVudE5vZGU7dmFyIGk9byYmKG8uVVJMfHxvLl9VUkx8fG8uaG9zdCYmby5ob3N0LmxvY2FsTmFtZSl8fFwiXCI7aT1pLnNwbGl0KFwiLz9cIikuc2hpZnQoKS5zcGxpdChcIi9cIikucG9wKCl9Y29uc29sZS5ncm91cChcIm11dGF0aW9ucyAoJWQpIFslc11cIixuLmxlbmd0aCxpfHxcIlwiKX12YXIgYT1kKGUpO24uZm9yRWFjaChmdW5jdGlvbihlKXtcImNoaWxkTGlzdFwiPT09ZS50eXBlJiYoVChlLmFkZGVkTm9kZXMsZnVuY3Rpb24oZSl7ZS5sb2NhbE5hbWUmJnQoZSxhKX0pLFQoZS5yZW1vdmVkTm9kZXMsZnVuY3Rpb24oZSl7ZS5sb2NhbE5hbWUmJmMoZSl9KSl9KSxnLmRvbSYmY29uc29sZS5ncm91cEVuZCgpfWZ1bmN0aW9uIGYoZSl7Zm9yKGU9d2luZG93LndyYXAoZSksZXx8KGU9d2luZG93LndyYXAoZG9jdW1lbnQpKTtlLnBhcmVudE5vZGU7KWU9ZS5wYXJlbnROb2RlO3ZhciB0PWUuX19vYnNlcnZlcjt0JiYoaChlLHQudGFrZVJlY29yZHMoKSksaSgpKX1mdW5jdGlvbiBtKGUpe2lmKCFlLl9fb2JzZXJ2ZXIpe3ZhciB0PW5ldyBNdXRhdGlvbk9ic2VydmVyKGguYmluZCh0aGlzLGUpKTt0Lm9ic2VydmUoZSx7Y2hpbGRMaXN0OiEwLHN1YnRyZWU6ITB9KSxlLl9fb2JzZXJ2ZXI9dH19ZnVuY3Rpb24gdyhlKXtlPXdpbmRvdy53cmFwKGUpLGcuZG9tJiZjb25zb2xlLmdyb3VwKFwidXBncmFkZURvY3VtZW50OiBcIixlLmJhc2VVUkkuc3BsaXQoXCIvXCIpLnBvcCgpKTt2YXIgbj1lPT09d2luZG93LndyYXAoZG9jdW1lbnQpO3QoZSxuKSxtKGUpLGcuZG9tJiZjb25zb2xlLmdyb3VwRW5kKCl9ZnVuY3Rpb24gdihlKXt5KGUsdyl9dmFyIGc9ZS5mbGFncyxiPWUuZm9yU3VidHJlZSx5PWUuZm9yRG9jdW1lbnRUcmVlLEU9IXdpbmRvdy5NdXRhdGlvbk9ic2VydmVyfHx3aW5kb3cuTXV0YXRpb25PYnNlcnZlcj09PXdpbmRvdy5Kc011dGF0aW9uT2JzZXJ2ZXI7ZS5oYXNQb2x5ZmlsbE11dGF0aW9ucz1FO3ZhciBfPSExLFM9W10sVD1BcnJheS5wcm90b3R5cGUuZm9yRWFjaC5jYWxsLmJpbmQoQXJyYXkucHJvdG90eXBlLmZvckVhY2gpLE09RWxlbWVudC5wcm90b3R5cGUuY3JlYXRlU2hhZG93Um9vdDtNJiYoRWxlbWVudC5wcm90b3R5cGUuY3JlYXRlU2hhZG93Um9vdD1mdW5jdGlvbigpe3ZhciBlPU0uY2FsbCh0aGlzKTtyZXR1cm4gd2luZG93LkN1c3RvbUVsZW1lbnRzLndhdGNoU2hhZG93KHRoaXMpLGV9KSxlLndhdGNoU2hhZG93PXAsZS51cGdyYWRlRG9jdW1lbnRUcmVlPXYsZS51cGdyYWRlRG9jdW1lbnQ9dyxlLnVwZ3JhZGVTdWJ0cmVlPXIsZS51cGdyYWRlQWxsPXQsZS5hdHRhY2hlZD1hLGUudGFrZVJlY29yZHM9Zn0pLHdpbmRvdy5DdXN0b21FbGVtZW50cy5hZGRNb2R1bGUoZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCh0LHIpe2lmKCF0Ll9fdXBncmFkZWRfXyYmdC5ub2RlVHlwZT09PU5vZGUuRUxFTUVOVF9OT0RFKXt2YXIgbz10LmdldEF0dHJpYnV0ZShcImlzXCIpLGk9ZS5nZXRSZWdpc3RlcmVkRGVmaW5pdGlvbih0LmxvY2FsTmFtZSl8fGUuZ2V0UmVnaXN0ZXJlZERlZmluaXRpb24obyk7aWYoaSYmKG8mJmkudGFnPT10LmxvY2FsTmFtZXx8IW8mJiFpW1wiZXh0ZW5kc1wiXSkpcmV0dXJuIG4odCxpLHIpfX1mdW5jdGlvbiBuKHQsbixvKXtyZXR1cm4gYS51cGdyYWRlJiZjb25zb2xlLmdyb3VwKFwidXBncmFkZTpcIix0LmxvY2FsTmFtZSksbi5pcyYmdC5zZXRBdHRyaWJ1dGUoXCJpc1wiLG4uaXMpLHIodCxuKSx0Ll9fdXBncmFkZWRfXz0hMCxpKHQpLG8mJmUuYXR0YWNoZWQodCksZS51cGdyYWRlU3VidHJlZSh0LG8pLGEudXBncmFkZSYmY29uc29sZS5ncm91cEVuZCgpLHR9ZnVuY3Rpb24gcihlLHQpe09iamVjdC5fX3Byb3RvX18/ZS5fX3Byb3RvX189dC5wcm90b3R5cGU6KG8oZSx0LnByb3RvdHlwZSx0W1wibmF0aXZlXCJdKSxlLl9fcHJvdG9fXz10LnByb3RvdHlwZSl9ZnVuY3Rpb24gbyhlLHQsbil7Zm9yKHZhciByPXt9LG89dDtvIT09biYmbyE9PUhUTUxFbGVtZW50LnByb3RvdHlwZTspe2Zvcih2YXIgaSxhPU9iamVjdC5nZXRPd25Qcm9wZXJ0eU5hbWVzKG8pLHM9MDtpPWFbc107cysrKXJbaV18fChPYmplY3QuZGVmaW5lUHJvcGVydHkoZSxpLE9iamVjdC5nZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IobyxpKSkscltpXT0xKTtvPU9iamVjdC5nZXRQcm90b3R5cGVPZihvKX19ZnVuY3Rpb24gaShlKXtlLmNyZWF0ZWRDYWxsYmFjayYmZS5jcmVhdGVkQ2FsbGJhY2soKX12YXIgYT1lLmZsYWdzO2UudXBncmFkZT10LGUudXBncmFkZVdpdGhEZWZpbml0aW9uPW4sZS5pbXBsZW1lbnRQcm90b3R5cGU9cn0pLHdpbmRvdy5DdXN0b21FbGVtZW50cy5hZGRNb2R1bGUoZnVuY3Rpb24oZSl7ZnVuY3Rpb24gdCh0LHIpe3ZhciBjPXJ8fHt9O2lmKCF0KXRocm93IG5ldyBFcnJvcihcImRvY3VtZW50LnJlZ2lzdGVyRWxlbWVudDogZmlyc3QgYXJndW1lbnQgYG5hbWVgIG11c3Qgbm90IGJlIGVtcHR5XCIpO2lmKHQuaW5kZXhPZihcIi1cIik8MCl0aHJvdyBuZXcgRXJyb3IoXCJkb2N1bWVudC5yZWdpc3RlckVsZW1lbnQ6IGZpcnN0IGFyZ3VtZW50ICgnbmFtZScpIG11c3QgY29udGFpbiBhIGRhc2ggKCctJykuIEFyZ3VtZW50IHByb3ZpZGVkIHdhcyAnXCIrU3RyaW5nKHQpK1wiJy5cIik7aWYobyh0KSl0aHJvdyBuZXcgRXJyb3IoXCJGYWlsZWQgdG8gZXhlY3V0ZSAncmVnaXN0ZXJFbGVtZW50JyBvbiAnRG9jdW1lbnQnOiBSZWdpc3RyYXRpb24gZmFpbGVkIGZvciB0eXBlICdcIitTdHJpbmcodCkrXCInLiBUaGUgdHlwZSBuYW1lIGlzIGludmFsaWQuXCIpO2lmKGwodCkpdGhyb3cgbmV3IEVycm9yKFwiRHVwbGljYXRlRGVmaW5pdGlvbkVycm9yOiBhIHR5cGUgd2l0aCBuYW1lICdcIitTdHJpbmcodCkrXCInIGlzIGFscmVhZHkgcmVnaXN0ZXJlZFwiKTtyZXR1cm4gYy5wcm90b3R5cGV8fChjLnByb3RvdHlwZT1PYmplY3QuY3JlYXRlKEhUTUxFbGVtZW50LnByb3RvdHlwZSkpLGMuX19uYW1lPXQudG9Mb3dlckNhc2UoKSxjLmxpZmVjeWNsZT1jLmxpZmVjeWNsZXx8e30sYy5hbmNlc3RyeT1pKGNbXCJleHRlbmRzXCJdKSxhKGMpLHMoYyksbihjLnByb3RvdHlwZSksdShjLl9fbmFtZSxjKSxjLmN0b3I9ZChjKSxjLmN0b3IucHJvdG90eXBlPWMucHJvdG90eXBlLGMucHJvdG90eXBlLmNvbnN0cnVjdG9yPWMuY3RvcixlLnJlYWR5JiZ2KGRvY3VtZW50KSxjLmN0b3J9ZnVuY3Rpb24gbihlKXtpZighZS5zZXRBdHRyaWJ1dGUuX3BvbHlmaWxsZWQpe3ZhciB0PWUuc2V0QXR0cmlidXRlO2Uuc2V0QXR0cmlidXRlPWZ1bmN0aW9uKGUsbil7ci5jYWxsKHRoaXMsZSxuLHQpfTt2YXIgbj1lLnJlbW92ZUF0dHJpYnV0ZTtlLnJlbW92ZUF0dHJpYnV0ZT1mdW5jdGlvbihlKXtyLmNhbGwodGhpcyxlLG51bGwsbil9LGUuc2V0QXR0cmlidXRlLl9wb2x5ZmlsbGVkPSEwfX1mdW5jdGlvbiByKGUsdCxuKXtlPWUudG9Mb3dlckNhc2UoKTt2YXIgcj10aGlzLmdldEF0dHJpYnV0ZShlKTtuLmFwcGx5KHRoaXMsYXJndW1lbnRzKTt2YXIgbz10aGlzLmdldEF0dHJpYnV0ZShlKTt0aGlzLmF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayYmbyE9PXImJnRoaXMuYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrKGUscixvKX1mdW5jdGlvbiBvKGUpe2Zvcih2YXIgdD0wO3Q8Xy5sZW5ndGg7dCsrKWlmKGU9PT1fW3RdKXJldHVybiEwfWZ1bmN0aW9uIGkoZSl7dmFyIHQ9bChlKTtyZXR1cm4gdD9pKHRbXCJleHRlbmRzXCJdKS5jb25jYXQoW3RdKTpbXX1mdW5jdGlvbiBhKGUpe2Zvcih2YXIgdCxuPWVbXCJleHRlbmRzXCJdLHI9MDt0PWUuYW5jZXN0cnlbcl07cisrKW49dC5pcyYmdC50YWc7ZS50YWc9bnx8ZS5fX25hbWUsbiYmKGUuaXM9ZS5fX25hbWUpfWZ1bmN0aW9uIHMoZSl7aWYoIU9iamVjdC5fX3Byb3RvX18pe3ZhciB0PUhUTUxFbGVtZW50LnByb3RvdHlwZTtpZihlLmlzKXt2YXIgbj1kb2N1bWVudC5jcmVhdGVFbGVtZW50KGUudGFnKTt0PU9iamVjdC5nZXRQcm90b3R5cGVPZihuKX1mb3IodmFyIHIsbz1lLnByb3RvdHlwZSxpPSExO287KW89PXQmJihpPSEwKSxyPU9iamVjdC5nZXRQcm90b3R5cGVPZihvKSxyJiYoby5fX3Byb3RvX189ciksbz1yO2l8fGNvbnNvbGUud2FybihlLnRhZytcIiBwcm90b3R5cGUgbm90IGZvdW5kIGluIHByb3RvdHlwZSBjaGFpbiBmb3IgXCIrZS5pcyksZVtcIm5hdGl2ZVwiXT10fX1mdW5jdGlvbiBjKGUpe3JldHVybiBiKE0oZS50YWcpLGUpfWZ1bmN0aW9uIGwoZSl7cmV0dXJuIGU/U1tlLnRvTG93ZXJDYXNlKCldOnZvaWQgMH1mdW5jdGlvbiB1KGUsdCl7U1tlXT10fWZ1bmN0aW9uIGQoZSl7cmV0dXJuIGZ1bmN0aW9uKCl7cmV0dXJuIGMoZSl9fWZ1bmN0aW9uIHAoZSx0LG4pe3JldHVybiBlPT09VD9oKHQsbik6TyhlLHQpfWZ1bmN0aW9uIGgoZSx0KXtlJiYoZT1lLnRvTG93ZXJDYXNlKCkpLHQmJih0PXQudG9Mb3dlckNhc2UoKSk7dmFyIG49bCh0fHxlKTtpZihuKXtpZihlPT1uLnRhZyYmdD09bi5pcylyZXR1cm4gbmV3IG4uY3RvcjtpZighdCYmIW4uaXMpcmV0dXJuIG5ldyBuLmN0b3J9dmFyIHI7cmV0dXJuIHQ/KHI9aChlKSxyLnNldEF0dHJpYnV0ZShcImlzXCIsdCkscik6KHI9TShlKSxlLmluZGV4T2YoXCItXCIpPj0wJiZ5KHIsSFRNTEVsZW1lbnQpLHIpfWZ1bmN0aW9uIGYoZSx0KXt2YXIgbj1lW3RdO2VbdF09ZnVuY3Rpb24oKXt2YXIgZT1uLmFwcGx5KHRoaXMsYXJndW1lbnRzKTtyZXR1cm4gZyhlKSxlfX12YXIgbSx3PWUuaXNJRSx2PWUudXBncmFkZURvY3VtZW50VHJlZSxnPWUudXBncmFkZUFsbCxiPWUudXBncmFkZVdpdGhEZWZpbml0aW9uLHk9ZS5pbXBsZW1lbnRQcm90b3R5cGUsRT1lLnVzZU5hdGl2ZSxfPVtcImFubm90YXRpb24teG1sXCIsXCJjb2xvci1wcm9maWxlXCIsXCJmb250LWZhY2VcIixcImZvbnQtZmFjZS1zcmNcIixcImZvbnQtZmFjZS11cmlcIixcImZvbnQtZmFjZS1mb3JtYXRcIixcImZvbnQtZmFjZS1uYW1lXCIsXCJtaXNzaW5nLWdseXBoXCJdLFM9e30sVD1cImh0dHA6Ly93d3cudzMub3JnLzE5OTkveGh0bWxcIixNPWRvY3VtZW50LmNyZWF0ZUVsZW1lbnQuYmluZChkb2N1bWVudCksTz1kb2N1bWVudC5jcmVhdGVFbGVtZW50TlMuYmluZChkb2N1bWVudCk7bT1PYmplY3QuX19wcm90b19ffHxFP2Z1bmN0aW9uKGUsdCl7cmV0dXJuIGUgaW5zdGFuY2VvZiB0fTpmdW5jdGlvbihlLHQpe2lmKGUgaW5zdGFuY2VvZiB0KXJldHVybiEwO2Zvcih2YXIgbj1lO247KXtpZihuPT09dC5wcm90b3R5cGUpcmV0dXJuITA7bj1uLl9fcHJvdG9fX31yZXR1cm4hMX0sZihOb2RlLnByb3RvdHlwZSxcImNsb25lTm9kZVwiKSxmKGRvY3VtZW50LFwiaW1wb3J0Tm9kZVwiKSx3JiYhZnVuY3Rpb24oKXt2YXIgZT1kb2N1bWVudC5pbXBvcnROb2RlO2RvY3VtZW50LmltcG9ydE5vZGU9ZnVuY3Rpb24oKXt2YXIgdD1lLmFwcGx5KGRvY3VtZW50LGFyZ3VtZW50cyk7aWYodC5ub2RlVHlwZT09dC5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFKXt2YXIgbj1kb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7cmV0dXJuIG4uYXBwZW5kQ2hpbGQodCksbn1yZXR1cm4gdH19KCksZG9jdW1lbnQucmVnaXN0ZXJFbGVtZW50PXQsZG9jdW1lbnQuY3JlYXRlRWxlbWVudD1oLGRvY3VtZW50LmNyZWF0ZUVsZW1lbnROUz1wLGUucmVnaXN0cnk9UyxlW1wiaW5zdGFuY2VvZlwiXT1tLGUucmVzZXJ2ZWRUYWdMaXN0PV8sZS5nZXRSZWdpc3RlcmVkRGVmaW5pdGlvbj1sLGRvY3VtZW50LnJlZ2lzdGVyPWRvY3VtZW50LnJlZ2lzdGVyRWxlbWVudH0pLGZ1bmN0aW9uKGUpe2Z1bmN0aW9uIHQoKXthKHdpbmRvdy53cmFwKGRvY3VtZW50KSksd2luZG93LkN1c3RvbUVsZW1lbnRzLnJlYWR5PSEwO3ZhciBlPXdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWV8fGZ1bmN0aW9uKGUpe3NldFRpbWVvdXQoZSwxNil9O2UoZnVuY3Rpb24oKXtzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7d2luZG93LkN1c3RvbUVsZW1lbnRzLnJlYWR5VGltZT1EYXRlLm5vdygpLHdpbmRvdy5IVE1MSW1wb3J0cyYmKHdpbmRvdy5DdXN0b21FbGVtZW50cy5lbGFwc2VkPXdpbmRvdy5DdXN0b21FbGVtZW50cy5yZWFkeVRpbWUtd2luZG93LkhUTUxJbXBvcnRzLnJlYWR5VGltZSksZG9jdW1lbnQuZGlzcGF0Y2hFdmVudChuZXcgQ3VzdG9tRXZlbnQoXCJXZWJDb21wb25lbnRzUmVhZHlcIix7YnViYmxlczohMH0pKX0pfSl9dmFyIG49ZS51c2VOYXRpdmUscj1lLmluaXRpYWxpemVNb2R1bGVzLG89ZS5pc0lFO2lmKG4pe3ZhciBpPWZ1bmN0aW9uKCl7fTtlLndhdGNoU2hhZG93PWksZS51cGdyYWRlPWksZS51cGdyYWRlQWxsPWksZS51cGdyYWRlRG9jdW1lbnRUcmVlPWksZS51cGdyYWRlU3VidHJlZT1pLGUudGFrZVJlY29yZHM9aSxlW1wiaW5zdGFuY2VvZlwiXT1mdW5jdGlvbihlLHQpe3JldHVybiBlIGluc3RhbmNlb2YgdH19ZWxzZSByKCk7dmFyIGE9ZS51cGdyYWRlRG9jdW1lbnRUcmVlLHM9ZS51cGdyYWRlRG9jdW1lbnQ7aWYod2luZG93LndyYXB8fCh3aW5kb3cuU2hhZG93RE9NUG9seWZpbGw/KHdpbmRvdy53cmFwPXdpbmRvdy5TaGFkb3dET01Qb2x5ZmlsbC53cmFwSWZOZWVkZWQsd2luZG93LnVud3JhcD13aW5kb3cuU2hhZG93RE9NUG9seWZpbGwudW53cmFwSWZOZWVkZWQpOndpbmRvdy53cmFwPXdpbmRvdy51bndyYXA9ZnVuY3Rpb24oZSl7cmV0dXJuIGV9KSx3aW5kb3cuSFRNTEltcG9ydHMmJih3aW5kb3cuSFRNTEltcG9ydHMuX19pbXBvcnRzUGFyc2luZ0hvb2s9ZnVuY3Rpb24oZSl7ZVtcImltcG9ydFwiXSYmcyh3cmFwKGVbXCJpbXBvcnRcIl0pKX0pLG8mJlwiZnVuY3Rpb25cIiE9dHlwZW9mIHdpbmRvdy5DdXN0b21FdmVudCYmKHdpbmRvdy5DdXN0b21FdmVudD1mdW5jdGlvbihlLHQpe3Q9dHx8e307dmFyIG49ZG9jdW1lbnQuY3JlYXRlRXZlbnQoXCJDdXN0b21FdmVudFwiKTtyZXR1cm4gbi5pbml0Q3VzdG9tRXZlbnQoZSxCb29sZWFuKHQuYnViYmxlcyksQm9vbGVhbih0LmNhbmNlbGFibGUpLHQuZGV0YWlsKSxuLnByZXZlbnREZWZhdWx0PWZ1bmN0aW9uKCl7T2JqZWN0LmRlZmluZVByb3BlcnR5KHRoaXMsXCJkZWZhdWx0UHJldmVudGVkXCIse2dldDpmdW5jdGlvbigpe3JldHVybiEwfX0pfSxufSx3aW5kb3cuQ3VzdG9tRXZlbnQucHJvdG90eXBlPXdpbmRvdy5FdmVudC5wcm90b3R5cGUpLFwiY29tcGxldGVcIj09PWRvY3VtZW50LnJlYWR5U3RhdGV8fGUuZmxhZ3MuZWFnZXIpdCgpO2Vsc2UgaWYoXCJpbnRlcmFjdGl2ZVwiIT09ZG9jdW1lbnQucmVhZHlTdGF0ZXx8d2luZG93LmF0dGFjaEV2ZW50fHx3aW5kb3cuSFRNTEltcG9ydHMmJiF3aW5kb3cuSFRNTEltcG9ydHMucmVhZHkpe3ZhciBjPXdpbmRvdy5IVE1MSW1wb3J0cyYmIXdpbmRvdy5IVE1MSW1wb3J0cy5yZWFkeT9cIkhUTUxJbXBvcnRzTG9hZGVkXCI6XCJET01Db250ZW50TG9hZGVkXCI7d2luZG93LmFkZEV2ZW50TGlzdGVuZXIoYyx0KX1lbHNlIHQoKX0od2luZG93LkN1c3RvbUVsZW1lbnRzKSxmdW5jdGlvbihlKXtGdW5jdGlvbi5wcm90b3R5cGUuYmluZHx8KEZ1bmN0aW9uLnByb3RvdHlwZS5iaW5kPWZ1bmN0aW9uKGUpe3ZhciB0PXRoaXMsbj1BcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmd1bWVudHMsMSk7cmV0dXJuIGZ1bmN0aW9uKCl7dmFyIHI9bi5zbGljZSgpO3JldHVybiByLnB1c2guYXBwbHkocixhcmd1bWVudHMpLHQuYXBwbHkoZSxyKX19KX0od2luZG93LldlYkNvbXBvbmVudHMpLGZ1bmN0aW9uKGUpe1widXNlIHN0cmljdFwiO2lmKCF3aW5kb3cucGVyZm9ybWFuY2Upe3ZhciB0PURhdGUubm93KCk7d2luZG93LnBlcmZvcm1hbmNlPXtub3c6ZnVuY3Rpb24oKXtyZXR1cm4gRGF0ZS5ub3coKS10fX19d2luZG93LnJlcXVlc3RBbmltYXRpb25GcmFtZXx8KHdpbmRvdy5yZXF1ZXN0QW5pbWF0aW9uRnJhbWU9ZnVuY3Rpb24oKXt2YXIgZT13aW5kb3cud2Via2l0UmVxdWVzdEFuaW1hdGlvbkZyYW1lfHx3aW5kb3cubW96UmVxdWVzdEFuaW1hdGlvbkZyYW1lO3JldHVybiBlP2Z1bmN0aW9uKHQpe3JldHVybiBlKGZ1bmN0aW9uKCl7dChwZXJmb3JtYW5jZS5ub3coKSl9KX06ZnVuY3Rpb24oZSl7cmV0dXJuIHdpbmRvdy5zZXRUaW1lb3V0KGUsMWUzLzYwKX19KCkpLHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZXx8KHdpbmRvdy5jYW5jZWxBbmltYXRpb25GcmFtZT1mdW5jdGlvbigpe3JldHVybiB3aW5kb3cud2Via2l0Q2FuY2VsQW5pbWF0aW9uRnJhbWV8fHdpbmRvdy5tb3pDYW5jZWxBbmltYXRpb25GcmFtZXx8ZnVuY3Rpb24oZSl7Y2xlYXJUaW1lb3V0KGUpfX0oKSl9KHdpbmRvdy5XZWJDb21wb25lbnRzKSxmdW5jdGlvbihlKXt2YXIgdD1kb2N1bWVudC5jcmVhdGVFbGVtZW50KFwic3R5bGVcIik7dC50ZXh0Q29udGVudD1cImJvZHkge3RyYW5zaXRpb246IG9wYWNpdHkgZWFzZS1pbiAwLjJzOyB9IFxcbmJvZHlbdW5yZXNvbHZlZF0ge29wYWNpdHk6IDA7IGRpc3BsYXk6IGJsb2NrOyBvdmVyZmxvdzogaGlkZGVuOyBwb3NpdGlvbjogcmVsYXRpdmU7IH0gXFxuXCI7dmFyIG49ZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcImhlYWRcIik7bi5pbnNlcnRCZWZvcmUodCxuLmZpcnN0Q2hpbGQpfSh3aW5kb3cuV2ViQ29tcG9uZW50cyksZnVuY3Rpb24oZSl7d2luZG93LlBsYXRmb3JtPWV9KHdpbmRvdy5XZWJDb21wb25lbnRzKTsiLCJ2YXIgUEVORElORyAgID0ge30sXG4gICAgUkVTT0xWRUQgID0ge30sXG4gICAgUkVKRUNURUQgID0ge30sXG4gICAgRlVMRklMTEVEID0ge307XG5cbnZhciBWb3cgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgdm93ID0ge307XG4gICAgdmFyIF9wcm9taXNlID0gUHJvbWlzZU9iaigpO1xuXG4gICAgdm93LnJlc29sdmUgPSBfcHJvbWlzZS5yZXNvbHZlO1xuICAgIHZvdy5yZWplY3QgID0gX3Byb21pc2UucmVqZWN0O1xuICAgIHZvdy5wcm9taXNlID0ge1xuICAgICAgICB0aGVuOiBfcHJvbWlzZS50aGVuLFxuICAgICAgICBjYXRjaDogX3Byb21pc2UuY2F0Y2gsXG4gICAgICAgIGRvbmU6IF9wcm9taXNlLmRvbmVcbiAgICB9O1xuXG4gICAgcmV0dXJuIHZvdztcblxuICAgIGZ1bmN0aW9uIFByb21pc2VPYmooKSB7XG4gICAgICAgIHZhciBzdGF0ZSA9IFBFTkRJTkc7XG4gICAgICAgIHZhciB2YWx1ZSwgb25SZXNvbHZlZCwgb25SZWplY3RlZCwgb25GdWxsZmlsbGVkLCByZXR1cm5Qcm9taXNlO1xuXG4gICAgICAgIHZhciByZXQgPSB7XG5cbiAgICAgICAgICAgIHJlc29sdmU6IGZ1bmN0aW9uICh2YWwpIHtcbiAgICAgICAgICAgICAgICB2YWx1ZSA9IHZhbDtcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IFJFU09MVkVEO1xuXG4gICAgICAgICAgICAgICAgaWYgKG9uUmVzb2x2ZWQpIHtcbiAgICAgICAgICAgICAgICAgICAgaGFuZGxlUmVzb2x2ZShvblJlc29sdmVkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG9uRnVsbGZpbGxlZCkge1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGVEb25lKG9uRnVsbGZpbGxlZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgcmVqZWN0OiBmdW5jdGlvbiAoZXJyKSB7XG4gICAgICAgICAgICAgICAgdmFsdWUgPSBlcnI7XG4gICAgICAgICAgICAgICAgc3RhdGUgPSBSRUpFQ1RFRDtcblxuICAgICAgICAgICAgICAgIGlmIChvblJlamVjdGVkKSB7XG4gICAgICAgICAgICAgICAgICAgIGhhbmRsZVJlamVjdChvblJlamVjdGVkKTtcbiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG9uRnVsbGZpbGxlZCkge1xuICAgICAgICAgICAgICAgICAgICBoYW5kbGVEb25lKG9uRnVsbGZpbGxlZCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcblxuICAgICAgICAgICAgdGhlbjogZnVuY3Rpb24gKHN1Y2Nlc3NDYWxsYmFjaykge1xuICAgICAgICAgICAgICAgIHJldHVyblByb21pc2UgPSBQcm9taXNlT2JqKCk7XG4gICAgICAgICAgICAgICAgaGFuZGxlUmVzb2x2ZShzdWNjZXNzQ2FsbGJhY2spO1xuXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICAgICAgdGhlbjogcmV0dXJuUHJvbWlzZS50aGVuLFxuICAgICAgICAgICAgICAgICAgICBjYXRjaDogcmV0dXJuUHJvbWlzZS5jYXRjaCxcbiAgICAgICAgICAgICAgICAgICAgZG9uZTogcmV0dXJuUHJvbWlzZS5kb25lXG4gICAgICAgICAgICAgICAgfTtcbiAgICAgICAgICAgIH0sXG5cbiAgICAgICAgICAgIGNhdGNoOiBmdW5jdGlvbiAoZmFpbENhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuUHJvbWlzZSA9IFByb21pc2VPYmooKTtcbiAgICAgICAgICAgICAgICBoYW5kbGVSZWplY3QoZmFpbENhbGxiYWNrKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiB7XG4gICAgICAgICAgICAgICAgICAgIHRoZW46IHJldHVyblByb21pc2UudGhlbixcbiAgICAgICAgICAgICAgICAgICAgY2F0Y2g6IHJldHVyblByb21pc2UuY2F0Y2gsXG4gICAgICAgICAgICAgICAgICAgIGRvbmU6IHJldHVyblByb21pc2UuZG9uZVxuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICB9LFxuXG4gICAgICAgICAgICBkb25lOiBmdW5jdGlvbiAoZmluYWxseUNhbGxiYWNrKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlRG9uZShmaW5hbGx5Q2FsbGJhY2spO1xuICAgICAgICAgICAgfVxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiByZXQ7XG5cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlRG9uZShmbikge1xuICAgICAgICAgICAgaWYgKHN0YXRlID09PSBQRU5ESU5HKSB7XG4gICAgICAgICAgICAgICAgb25GdWxsZmlsbGVkID0gZm4gfHwgJ2RvbmUnO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHN0YXRlID09PSBSRVNPTFZFRCAmJiB0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IEZVTEZJTExFRDtcbiAgICAgICAgICAgICAgICByZXR1cm4gZm4uY2FsbCh0aGlzLCB2YWx1ZSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gUkVKRUNURUQpIHtcbiAgICAgICAgICAgICAgICBzdGF0ZSA9IEZVTEZJTExFRDtcbiAgICAgICAgICAgICAgICB0aHJvdyB2YWx1ZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZVJlc29sdmUoZm4pIHtcbiAgICAgICAgICAgIHZhciBlcnJvcjtcbiAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gUEVORElORykge1xuICAgICAgICAgICAgICAgIG9uUmVzb2x2ZWQgPSBmbjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHN0YXRlID09PSBSRVNPTFZFRCkge1xuICAgICAgICAgICAgICAgIGlmICh2YWx1ZSAmJiB0eXBlb2YgdmFsdWUudGhlbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZS50aGVuKHJldC5yZXNvbHZlKTtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZm4uY2FsbCh0aGlzLCB2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICAgICAgICAgICAgICAgIHZhbHVlID0gZXJyO1xuICAgICAgICAgICAgICAgICAgICBlcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHJldHVyblByb21pc2UpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuUHJvbWlzZS5yZXNvbHZlKHZhbHVlKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICByZXR1cm5Qcm9taXNlLnJlamVjdCh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlUmVqZWN0KGZuKSB7XG4gICAgICAgICAgICB2YXIgZXJyb3I7XG4gICAgICAgICAgICBpZiAoc3RhdGUgPT09IFBFTkRJTkcpIHtcbiAgICAgICAgICAgICAgICBvblJlamVjdGVkID0gZm47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmIChzdGF0ZSA9PT0gUkVKRUNURUQpIHtcbiAgICAgICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGZuLmNhbGwodGhpcywgdmFsdWUpO1xuICAgICAgICAgICAgICAgIH0gY2F0Y2ggKGVycikge1xuICAgICAgICAgICAgICAgICAgICB2YWx1ZSA9IGVycjtcbiAgICAgICAgICAgICAgICAgICAgZXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIGlmIChyZXR1cm5Qcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmICghZXJyb3IpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVyblByb21pc2UucmVzb2x2ZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuUHJvbWlzZS5yZWplY3QodmFsdWUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKHN0YXRlID09PSBSRVNPTFZFRCkge1xuICAgICAgICAgICAgICAgIGlmIChyZXR1cm5Qcm9taXNlKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldHVyblByb21pc2UucmVzb2x2ZSh2YWx1ZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxufTtcbiIsIi8vIEdsb2JhbCBPYmplY3QgdG8gY2FjaGUgYWxsIGluc3RhbmNlcyBvZiBTaWduYWxzXG52YXIgU0lHTkFMU19TVE9SQUdFID0ge307XG5cbnZhciBTaWduYWwgPSBmdW5jdGlvbih1dWlkLCBvcmlnaW4pIHtcbiAgICB0aGlzLnN0b3JhZ2UgICAgICAgICAgPSB7fTtcbiAgICB0aGlzLmhhbmRsZUFsbCAgICAgICAgPSBudWxsO1xuICAgIHRoaXMuY29ubmVjdG9ycyAgICAgICA9IHt9O1xuICAgIHRoaXMub3JpZ2luICAgICAgICAgICA9IG9yaWdpbjtcbiAgICB0aGlzLnV1aWQgICAgICAgICAgICAgPSB1dWlkO1xuICAgIFNJR05BTFNfU1RPUkFHRVt1dWlkXSA9IHRoaXM7XG4gICAgb3JpZ2luLm9uICAgICAgICAgICAgID0gdGhpcy5vbi5iaW5kKHRoaXMpO1xuICAgIG9yaWdpbi5vZmYgICAgICAgICAgICA9IHRoaXMub2ZmLmJpbmQodGhpcyk7XG4gICAgb3JpZ2luLmVtaXQgICAgICAgICAgID0gdGhpcy5lbWl0LmJpbmQodGhpcyk7XG4gICAgb3JpZ2luLmJyb2FkY2FzdCAgICAgID0gdGhpcy5icm9hZGNhc3QuYmluZCh0aGlzKTtcbiAgICBvcmlnaW4ucmVzZXQgICAgICAgICAgPSB0aGlzLnJlc2V0LmJpbmQodGhpcyk7XG4gICAgb3JpZ2luLmNvbm5lY3QgICAgICAgID0gdGhpcy5jb25uZWN0LmJpbmQodGhpcyk7XG4gICAgb3JpZ2luLmRpc2Nvbm5lY3QgICAgID0gdGhpcy5kaXNjb25uZWN0LmJpbmQodGhpcyk7XG59O1xuXG5TaWduYWwucHJvdG90eXBlLm9uID0gZnVuY3Rpb24ocHVsc2VUeXBlLCBmdW5jKSB7XG4gICAgaWYgKHR5cGVvZiBwdWxzZVR5cGUgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgdGhpcy5oYW5kbGVBbGwgPSBwdWxzZVR5cGU7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAoIXRoaXMuc3RvcmFnZVtwdWxzZVR5cGVdKSB7XG4gICAgICAgIHRoaXMuc3RvcmFnZVtwdWxzZVR5cGVdID0gW107XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBmdW5jICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTWlzc2luZyBjYWxsYmFjayBmdW5jdGlvbiBvbiAnICsgcHVsc2VUeXBlICsgJy4nKTtcbiAgICB9XG4gICAgXG4gICAgdGhpcy5zdG9yYWdlW3B1bHNlVHlwZV0ucHVzaChmdW5jKTtcbn07XG5cblNpZ25hbC5wcm90b3R5cGUub2ZmID0gZnVuY3Rpb24ocHVsc2VUeXBlLCBmdW5jKSB7XG4gICAgdmFyIGJ1Y2tldCA9IHRoaXMuc3RvcmFnZVtwdWxzZVR5cGVdIHx8IFtdO1xuXG4gICAgYnVja2V0LmZvckVhY2goZnVuY3Rpb24oZm4sIGkpIHtcbiAgICAgICAgaWYoZm4gPT09IGZ1bmMpIHtcbiAgICAgICAgICAgIGJ1Y2tldC5zcGxpY2UoaSwgMSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cbiAgICB9KTtcbn07XG5cblNpZ25hbC5wcm90b3R5cGUuZW1pdCA9IGZ1bmN0aW9uKHB1bHNlVHlwZSwgZGV0YWlsKSB7XG4gICAgdmFyIHB1bHNlLCBjb25uZWN0b3I7XG5cbiAgICBpZiAodHlwZW9mIHB1bHNlVHlwZSA9PT0gJ29iamVjdCcgJiYgcHVsc2VUeXBlLnR5cGUpIHtcbiAgICAgICAgcHVsc2UgPSBwdWxzZVR5cGU7XG4gICAgfSBlbHNlIGlmICh0eXBlb2YgcHVsc2VUeXBlID09PSAnc3RyaW5nJykge1xuICAgICAgICBwdWxzZSA9IE1ha2VQdWxzZShwdWxzZVR5cGUsIGRldGFpbCwgdGhpcy5vcmlnaW4pO1xuICAgIH1cblxuICAgIGZvciAodmFyIGlkIGluIHRoaXMuY29ubmVjdG9ycykge1xuICAgICAgICBjb25uZWN0b3IgPSB0aGlzLmNvbm5lY3RvcnNbaWRdO1xuICAgICAgICBjb25uZWN0b3IudHJpZ2dlcihwdWxzZSk7XG4gICAgfVxufTtcblxuU2lnbmFsLnByb3RvdHlwZS5icm9hZGNhc3QgPSBmdW5jdGlvbihwdWxzZVR5cGUsIGRldGFpbCkge1xuICAgIHZhciBwdWxzZSA9IE1ha2VQdWxzZShwdWxzZVR5cGUsIGRldGFpbCwgdGhpcy5vcmlnaW4pLFxuICAgICAgICBzaWduYWw7XG5cbiAgICBmb3IgKHZhciBpZCBpbiBTSUdOQUxTX1NUT1JBR0UpIHtcbiAgICAgICAgc2lnbmFsID0gU0lHTkFMU19TVE9SQUdFW2lkXTtcbiAgICAgICAgc2lnbmFsLnRyaWdnZXIocHVsc2UpO1xuICAgIH1cbn07XG5cblNpZ25hbC5wcm90b3R5cGUudHJpZ2dlciA9IGZ1bmN0aW9uKHB1bHNlKSB7XG4gICAgaWYgKCFwdWxzZS50eXBlKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignRXhwZWN0IHBhcmFtZXRlciB0byBiZSBhIHB1bHNlJyk7XG4gICAgfVxuXG4gICAgdmFyIGJ1Y2tldCA9IHRoaXMuc3RvcmFnZVtwdWxzZS50eXBlXSB8fCBbXTtcbiAgICBmb3IgKHZhciBpID0gMDsgaSA8IGJ1Y2tldC5sZW5ndGg7IGkrKykge1xuICAgICAgICBidWNrZXRbaV0ocHVsc2UpO1xuICAgIH1cbiAgICBpZiAodGhpcy5oYW5kbGVBbGwpIHtcbiAgICAgICAgdGhpcy5oYW5kbGVBbGwocHVsc2UpO1xuICAgIH1cbn07XG5cblNpZ25hbC5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbihuYW1lKSB7XG4gICAgaWYgKG5hbWUpIHtcbiAgICAgICAgdGhpcy5zdG9yYWdlW25hbWVdID0gW107XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhpcy5zdG9yYWdlID0ge307XG4gICAgICAgIGZvciAodmFyIGNvbm5lY3RvcklkIGluIHRoaXMuY29ubmVjdG9ycykge1xuICAgICAgICAgICAgdGhpcy5kaXNjb25uZWN0KGNvbm5lY3RvcklkKTtcbiAgICAgICAgfVxuICAgIH1cbn07XG5cblNpZ25hbC5wcm90b3R5cGUuYWRkQ29ubmVjdG9yID0gZnVuY3Rpb24oY29ubmVjdG9ySWQpIHtcbiAgICB2YXIgY29ubmVjdG9yID0gU0lHTkFMU19TVE9SQUdFW2Nvbm5lY3RvcklkXTtcbiAgICBpZiAoY29ubmVjdG9yKSB7XG4gICAgICAgIHRoaXMuY29ubmVjdG9yc1tjb25uZWN0b3JJZF0gPSBjb25uZWN0b3I7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgZmluZCBjb25uZWN0b3IgJyArIGNvbm5lY3RvcklkICsgJy4nKTtcbiAgICB9XG59O1xuXG5TaWduYWwucHJvdG90eXBlLnJlbW92ZUNvbm5lY3RvciA9IGZ1bmN0aW9uKGNvbm5lY3RvcklkKSB7XG4gICAgaWYgKHRoaXMuY29ubmVjdG9yc1tjb25uZWN0b3JJZF0pIHtcbiAgICAgICAgZGVsZXRlIHRoaXMuY29ubmVjdG9yc1tjb25uZWN0b3JJZF07XG4gICAgfSBlbHNlIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgZmluZCBjb25uZWN0b3IgJyArIGNvbm5lY3RvcklkICsgJy4nKTtcbiAgICB9XG59O1xuXG5TaWduYWwucHJvdG90eXBlLmNvbm5lY3QgPSBmdW5jdGlvbihjb25uZWN0b3JJZCkge1xuICAgIHZhciBjb25uZWN0b3IgPSBTSUdOQUxTX1NUT1JBR0VbY29ubmVjdG9ySWRdO1xuICAgIHRoaXMuYWRkQ29ubmVjdG9yKGNvbm5lY3RvcklkKTtcbiAgICBjb25uZWN0b3IuYWRkQ29ubmVjdG9yKHRoaXMudXVpZCk7XG59O1xuXG5TaWduYWwucHJvdG90eXBlLmRpc2Nvbm5lY3QgPSBmdW5jdGlvbihjb25uZWN0b3JJZCkge1xuICAgIHZhciBjb25uZWN0b3IgPSBTSUdOQUxTX1NUT1JBR0VbY29ubmVjdG9ySWRdO1xuICAgIHRoaXMucmVtb3ZlQ29ubmVjdG9yKGNvbm5lY3RvcklkKTtcbiAgICBjb25uZWN0b3IucmVtb3ZlQ29ubmVjdG9yKHRoaXMudXVpZCk7XG59O1xuXG5mdW5jdGlvbiBNYWtlUHVsc2UodHlwZSwgZGV0YWlsLCBvcmlnaW4pIHtcbiAgICB2YXIgcHVsc2UgPSB7XG4gICAgICAgIHR5cGU6IHR5cGUsXG4gICAgICAgIGRldGFpbDogZGV0YWlsLFxuICAgICAgICBvcmlnaW46IG9yaWdpblxuICAgIH07XG5cbiAgICByZXR1cm4gcHVsc2U7XG59XG4iLCJ2YXIgRmFjdG9yeSA9IHt9O1xudmFyIGZhY3RvcnlJZEdlbmVyYXRvciA9IGlkR2VuZXJhdG9yKCdmYWN0b3J5Jyk7XG5cbkZhY3RvcnkuX2NvbnN0cnVjdG9yID0gZnVuY3Rpb24ob3B0cykge1xuICAgIHRoaXMuYXR0cmlidXRlcyA9IHt9O1xuICAgIHRoaXMudXVpZCAgICAgICA9IGZhY3RvcnlJZEdlbmVyYXRvcigpO1xuICAgIHRoaXMucmVzb3VyY2VzICA9IHt9O1xuICAgIG5ldyBTaWduYWwodGhpcy51dWlkLCB0aGlzKTtcblxuICAgIHRoaXMuaW5pdGlhbGl6ZShvcHRzKTtcbn07XG5cbkZhY3RvcnkuX2NvbnN0cnVjdG9yLnByb3RvdHlwZS5pbml0aWFsaXplID0gZnVuY3Rpb24oKSB7fTtcblxuLyoqXG4gKiBTeW5jIGZhY3Rvcnkgd2l0aCByZXNvdXJjZU5hbWUsIGFuZCBjb25uZWN0IHdpdGggcmVzb3VyY2UncyBzaWduYWwuXG4gKiBNYXAgY2FsbGJhY2sgd2lsbCBiZSBpbnZva2VkIHdpdGggdGhlIHJlc291cmNlIG9iamVjdCBwYXNzZWQgaW4gb24gZmlyc3Qgc3luYywgXG4gKiBhbmQgZXZlcnkgdGltZSByZXNvdXJjZSBpcyB1cGRhdGVkLlxuICovXG5GYWN0b3J5Ll9jb25zdHJ1Y3Rvci5wcm90b3R5cGUuc3luYyA9IGZ1bmN0aW9uKHJlc291cmNlTmFtZSwgbWFwKSB7XG4gICAgdmFyIHJlc291cmNlID0gUkVTT1VSQ0VfU1RPUkVbcmVzb3VyY2VOYW1lXTtcblxuICAgIGlmICghcmVzb3VyY2UpIHRocm93IG5ldyBFcnJvcignUmVzb3VyY2UgJyArIHJlc291cmNlTmFtZSArICcgZG9lcyBub3QgZXhpc3QuJyk7XG5cbiAgICB0aGlzLnJlc291cmNlc1tyZXNvdXJjZU5hbWVdID0gcmVzb3VyY2U7XG4gICAgdGhpcy5jb25uZWN0KHJlc291cmNlLnV1aWQpO1xuICAgIG1hcC5jYWxsKHRoaXMsIHJlc291cmNlKTtcbiAgICB0aGlzLm9uKCd1cGRhdGU6JyArIHJlc291cmNlLnV1aWQsIG1hcC5iaW5kKHRoaXMsIHJlc291cmNlKSk7XG5cbn07XG5cbkZhY3RvcnkuZXh0ZW5kID0gZXh0ZW5kO1xuIiwidmFyIHNlcnZpY2VJZEdlbmVyYXRvciA9IGlkR2VuZXJhdG9yKCdzZXJ2aWNlJyk7XG5cbnZhciBTZXJ2aWNlID0ge307XG5cblNlcnZpY2UuX2NvbnN0cnVjdG9yID0gZnVuY3Rpb24ob3B0cykge1xuICAgIHRoaXMudXVpZCA9IHNlcnZpY2VJZEdlbmVyYXRvcigpO1xuICAgIG5ldyBTaWduYWwodGhpcy51dWlkLCB0aGlzKTtcbiAgICB0aGlzLm9uUmVhZHkob3B0cyk7XG59O1xuXG5TZXJ2aWNlLl9jb25zdHJ1Y3Rvci5wcm90b3R5cGUub25SZWFkeSA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIFRvIGJlIGltcGxlbWVudGVkIGJ5IGluc3RhbmNlXG59O1xuXG5TZXJ2aWNlLl9jb25zdHJ1Y3Rvci5wcm90b3R5cGUub25TdGFydCA9IGZ1bmN0aW9uKCkge1xuICAgIC8vIFRvIGJlIGltcGxlbWVudGVkIGJ5IGluc3RhbmNlXG59O1xuXG5TZXJ2aWNlLl9jb25zdHJ1Y3Rvci5wcm90b3R5cGUub25TdG9wID0gZnVuY3Rpb24oKSB7XG4gICAgLy8gVG8gYmUgaW1wbGVtZW50ZWQgYnkgaW5zdGFuY2Vcbn07XG5cblNlcnZpY2UuX2NvbnN0cnVjdG9yLnByb3RvdHlwZS5zdGFydCA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICB0aGlzLm9uU3RhcnQob3B0cyk7XG4gICAgdGhpcy5vbih0aGlzLmVtaXQuYmluZCh0aGlzKSk7XG59O1xuXG5TZXJ2aWNlLl9jb25zdHJ1Y3Rvci5wcm90b3R5cGUuc3RvcCA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICB0aGlzLm9uU3RvcChvcHRzKTtcbiAgICB0aGlzLnJlc2V0KCk7XG59O1xuXG5TZXJ2aWNlLl9jb25zdHJ1Y3Rvci5wcm90b3R5cGUuaW1wbGVtZW50ID0gZnVuY3Rpb24oaW5zdCkge1xuICAgIGlmIChpbnN0ICYmIGluc3QudXVpZCkge1xuICAgICAgICB0aGlzLmNvbm5lY3QoaW5zdC51dWlkKTtcbiAgICB9IGVsc2Uge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0V4cGVjdCBwYXJhbWV0ZXIgdG8gY29udGFpbnMgcHJvcGVydHkgdXVpZC4nKTtcbiAgICB9XG59O1xuXG5TZXJ2aWNlLmV4dGVuZCA9IGV4dGVuZDtcbiIsInZhciBjb21wb25lbnRJZEdlbmVyYXRvciA9IGlkR2VuZXJhdG9yKCdjb21wb25lbnQnKTtcbnZhciBDT01QT05FTlRfU1RPUkUgPSB7fTtcbnZhciBDT01QT05FTlRfREFUQVNUT1JFID0ge307XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8gQ09NUE9ORU5UIE1BTkFHRVIgLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxudmFyIENvbXBvbmVudE1hbmFnZXIgPSB7fTtcblxuQ29tcG9uZW50TWFuYWdlci5yZWdpc3RlciA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICBpZiAoQ09NUE9ORU5UX1NUT1JFW29wdHMudGFnTmFtZV0pIHtcbiAgICAgICAgcmV0dXJuIENPTVBPTkVOVF9TVE9SRVtvcHRzLnRhZ05hbWVdO1xuICAgIH1cblxuICAgIHZhciBjb21wb25lbnQgPSBuZXcgQ29tcG9uZW50KG9wdHMpO1xuICAgIENPTVBPTkVOVF9TVE9SRVtvcHRzLnRhZ05hbWVdID0gY29tcG9uZW50O1xuICAgIHJldHVybiBjb21wb25lbnQ7XG59O1xuXG5Db21wb25lbnRNYW5hZ2VyLmdldCA9IGZ1bmN0aW9uKHRhZ05hbWUpIHtcbiAgICByZXR1cm4gQ09NUE9ORU5UX1NUT1JFW3RhZ05hbWVdO1xufTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8gQ09NUE9ORU5UIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG52YXIgQ29tcG9uZW50ID0gZnVuY3Rpb24ob3B0cykge1xuICAgIHRoaXMudGFnTmFtZSA9IG9wdHMudGFnTmFtZTtcbiAgICB0aGlzLnJlZ2lzdGVyRWxlbWVudChvcHRzKTtcbiAgICB0aGlzLmRhdGFLZXlnZW4gPSBpZEdlbmVyYXRvcih0aGlzLnRhZ05hbWUpO1xufTtcblxuQ29tcG9uZW50LnByb3RvdHlwZS5zZXREYXRhID0gZnVuY3Rpb24oZGF0YSkge1xuICAgIHZhciBkYXRhS2V5ID0gdGhpcy5kYXRhS2V5Z2VuKCk7XG4gICAgQ09NUE9ORU5UX0RBVEFTVE9SRVtkYXRhS2V5XSA9IGRhdGE7XG4gICAgcmV0dXJuIGRhdGFLZXk7XG59O1xuXG5Db21wb25lbnQucHJvdG90eXBlLmdldERhdGEgPSBmdW5jdGlvbihkYXRhS2V5KSB7XG4gICAgcmV0dXJuIENPTVBPTkVOVF9EQVRBU1RPUkVbZGF0YUtleV07XG59O1xuXG4vKipcbiAqIFJlbmRlciBIZWxwZXIgTWV0aG9kXG4gKiAxLiBJZiB0aGVyZSBpcyBkYXRhLCBzYXZlIGl0IGluIENPTVBPTkVOVF9EQVRBU1RPUkUsIGdldCBkYXRhS2V5XG4gKiAyLiBSZW5kZXIgPGN1c3RvbS1lbGVtZW50IGRhdGEta2V5PSdkYXRhS2V5Jz48L2N1c3RvbS1lbGVtZW50PlxuICovXG5Db21wb25lbnQucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICB2YXIgZGF0YUtleSwgaHRtbDtcbiAgICB2YXIgdGVtcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2RpdicpO1xuXG4gICAgaWYgKGRhdGEpIHtcbiAgICAgICAgZGF0YUtleSA9IHRoaXMuc2V0RGF0YShkYXRhKTtcbiAgICAgICAgaHRtbCA9ICc8JyArIHRoaXMudGFnTmFtZSArICcgZGF0YS1rZXk9XCInICsgZGF0YUtleSArICdcIj48LycgKyB0aGlzLnRhZ05hbWUgKyAnPic7XG4gICAgfSBlbHNlIHtcbiAgICAgICAgaHRtbCA9ICc8JyArIHRoaXMudGFnTmFtZSArICc+PC8nICsgdGhpcy50YWdOYW1lICsgJz4nO1xuICAgIH1cblxuICAgIHRlbXAuaW5uZXJIVE1MID0gaHRtbDtcbiAgICByZXR1cm4gdGVtcC5xdWVyeVNlbGVjdG9yKHRoaXMudGFnTmFtZSk7XG59O1xuXG4vKipcbiAqIFJlZ2lzdGVyIEN1c3RvbSBFbGVtZW50IHVzaW5nIEhUTUw1IEFQSVxuICovXG5Db21wb25lbnQucHJvdG90eXBlLnJlZ2lzdGVyRWxlbWVudCA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICAvLyBTZXQgUHJvdG90eXBlIG9mIGN1c3RvbSBlbGVtZW50XG4gICAgdmFyIHByb3RvID0gT2JqZWN0LmNyZWF0ZShIVE1MRWxlbWVudC5wcm90b3R5cGUpO1xuICAgIHZhciB0bXBsICAgPSBvcHRzLnRlbXBsYXRlIHx8IHt9O1xuXG4gICAgcHJvdG8uY3JlYXRlZENhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHZhciBzaGFkb3csIGRhdGFLZXksIGRhdGE7XG4gICAgICAgIFxuICAgICAgICBpZiAoIXRtcGwucmVuZGVyIHx8ICF0bXBsLnBhdGNoKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ1RyaW8uVGVtcGxhdGUgaW5zdGFuY2Ugbm90IGZvdW5kLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ3JlYXRlIHNoYWRvdyByb290XG4gICAgICAgIHNoYWRvdyA9IHRoaXMuY3JlYXRlU2hhZG93Um9vdCgpO1xuXG4gICAgICAgIC8vIEdyYWIgZGF0YSBmcm9tIENPTVBPTkVOVFxuICAgICAgICBkYXRhS2V5ID0gdGhpcy5nZXRBdHRyaWJ1dGUoJ2RhdGEta2V5Jyk7XG4gICAgICAgIGRhdGEgPSBDT01QT05FTlRfREFUQVNUT1JFW2RhdGFLZXldO1xuXG4gICAgICAgIC8vIEFwcGVuZCByZW5kZXJlZCBmcmFnbWVudHMgaW50byBzaGFkb3dSb290XG4gICAgICAgIHNoYWRvdy5hcHBlbmRDaGlsZChvcHRzLnRlbXBsYXRlLnJlbmRlcihkYXRhKSk7XG5cbiAgICAgICAgZGVsZXRlIENPTVBPTkVOVF9EQVRBU1RPUkVbZGF0YUtleV07XG5cbiAgICAgICAgLy8gU2V0IFRyaW8gdXVpZCBhbmQgc2lnbmFsXG4gICAgICAgIHRoaXMudXVpZCA9IGNvbXBvbmVudElkR2VuZXJhdG9yKCk7XG4gICAgICAgIG5ldyBTaWduYWwodGhpcy51dWlkLCB0aGlzKTtcblxuICAgICAgICAvLyBDcmVhdGUgcGF0Y2ggbWV0aG9kXG4gICAgICAgIHRoaXMucGF0Y2ggPSBmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICB0bXBsLnBhdGNoKHNoYWRvdywgZGF0YSk7XG4gICAgICAgIH07XG5cbiAgICAgICAgLy8gRXh0ZW5kIG9wdHMgaW50byBlbGVtZW50IGNvbnRleHRcbiAgICAgICAgX2V4dGVuZCh0aGlzLCBvcHRzKTtcblxuICAgICAgICBpZiAob3B0cy5vbkNyZWF0ZSkge1xuICAgICAgICAgICAgb3B0cy5vbkNyZWF0ZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gX2V4dGVuZChvYmosIGV4dGVuZGVkT2JqZWN0KSB7XG4gICAgICAgICAgICB2YXIgYmxhY2tsaXN0ID0ge1xuICAgICAgICAgICAgICAgIG9uQ2hhbmdlOiB0cnVlLFxuICAgICAgICAgICAgICAgIG9uQXR0YWNoOiB0cnVlLFxuICAgICAgICAgICAgICAgIG9uRGV0YWNoOiB0cnVlLFxuICAgICAgICAgICAgICAgIG9uQ3JlYXRlOiB0cnVlLFxuICAgICAgICAgICAgICAgIGNyZWF0ZWRDYWxsYmFjazogdHJ1ZSxcbiAgICAgICAgICAgICAgICBhdHRhY2hlZENhbGxiYWNrOiB0cnVlLFxuICAgICAgICAgICAgICAgIGRldGFjaGVkQ2FsbGJhY2s6IHRydWUsXG4gICAgICAgICAgICAgICAgYXR0cmlidXRlQ2hhbmdlZENhbGxiYWNrOiB0cnVlLFxuICAgICAgICAgICAgICAgIHRhZ05hbWU6IHRydWVcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgIGZvciAodmFyIGtleSBpbiBleHRlbmRlZE9iamVjdCkge1xuICAgICAgICAgICAgICAgIGlmICghYmxhY2tsaXN0W2tleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgb2JqW2tleV0gPSBleHRlbmRlZE9iamVjdFtrZXldO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH07XG5cbiAgICBwcm90by5hdHRhY2hlZENhbGxiYWNrID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIGlmIChvcHRzLm9uQXR0YWNoKSB7XG4gICAgICAgICAgICBvcHRzLm9uQXR0YWNoLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cbiAgICB9O1xuXG4gICAgcHJvdG8uZGV0YWNoZWRDYWxsYmFjayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAob3B0cy5vbkRldGFjaCkge1xuICAgICAgICAgICAgb3B0cy5vbkRldGFjaC5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIHByb3RvLmF0dHJpYnV0ZUNoYW5nZWRDYWxsYmFjayA9IGZ1bmN0aW9uKCkge1xuICAgICAgICBpZiAob3B0cy5vbkNoYW5nZSkge1xuICAgICAgICAgICAgb3B0cy5vbkNoYW5nZS5hcHBseSh0aGlzLCBhcmd1bWVudHMpO1xuICAgICAgICB9XG4gICAgfTtcblxuICAgIGRvY3VtZW50LnJlZ2lzdGVyRWxlbWVudChvcHRzLnRhZ05hbWUsIHtcbiAgICAgICAgcHJvdG90eXBlOiBwcm90b1xuICAgIH0pO1xufTtcbiIsInZhciBtaXhpbnMgPSB7fTtcbnZhciB2YXJpYWJsZXMgPSB7fTtcblxuLy8gQWxsIHZlbmRvcnMgcHJlZml4ZXMgbmVlZGVkXG52YXIgX0FMTFZFTkRPUlMgPSBbJy13ZWJraXQtJywgJy1tb3otJywgJy1tcy0nLCAnLW8tJ107XG4vLyBDU1MgUHJvcGVydGllcy9BdHRyaWJ1dGVzIHRoYXQgbmVlZHMgcHJlZml4ZXMuIFRoaXMgbGlzdCB3aWxsIGdyb3cuXG52YXIgQVRUUklCVVRFU19UT19QUkVGSVggPSBbJ2ZsZXgnLCAndHJhbnNpdGlvbicsICd0cmFuc2Zvcm0nLCAnY2FsYycsICdhbGlnbi1zZWxmJywgJ2ZsZXgtZmxvdycsICdsaW5lYXItZ3JhZGllbnQnXTtcbi8vIFJlZ2V4IHRvIG1hdGNoIGFueSBzdHJpbmcgdGhhdCBjb250YWlucyB3b3JkcyBuZWVkIHByZWZpeGVzXG52YXIgSVNfUFJFRklYQUJMRSA9IG5ldyBSZWdFeHAoQVRUUklCVVRFU19UT19QUkVGSVguam9pbignfCcpKTtcbi8vIEtleS1wYWlyIGZvciBjb2xvciB0byBoZXhcbnZhciBDT0xPUl9NQVAgPSB7XG4gICAgJ2JsYWNrJzogJyMwMDAwMDAnLFxuICAgICd3aGl0ZSc6ICcjZmZmZmZmJyxcbiAgICAnYmx1ZSc6ICcjMDAwMGZmJyxcbiAgICAneWVsbG93JzogJyNmZmZmMDAnLFxuICAgICdsaWdodC1ncmF5JzogJyNjY2NjY2MnLFxuICAgICdkYXJrLWdyYXknOiAnIzMzMzMzMycsXG4gICAgJ2dyYXknOiAnIzY2NjY2NicsXG4gICAgJ29yYW5nZSc6ICcjZmZhNTAwJyxcbiAgICAncHVycGxlJzogJyM4YTJiZTInXG59O1xuXG52YXIgU3R5bGl6ZXIgPSBmdW5jdGlvbigpIHt9O1xuXG5TdHlsaXplci5wcm90b3R5cGUuY3JlYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBDU1NUZW1wbGF0ZSgpO1xufTtcblxuU3R5bGl6ZXIucHJvdG90eXBlLnJlZ2lzdGVyTWl4aW4gPSBmdW5jdGlvbihrZXksIGZ1bmMpIHtcbiAgICBtaXhpbnNba2V5XSA9IGZ1bmM7XG59O1xuXG5TdHlsaXplci5wcm90b3R5cGUucmVnaXN0ZXJWYXJpYWJsZSA9IGZ1bmN0aW9uKGtleSwgdmFsKSB7XG4gICAgdmFyaWFibGVzW2tleV0gPSB2YWw7XG59O1xuXG5TdHlsaXplci5wcm90b3R5cGUuZ2V0VmFyaWFibGUgPSBmdW5jdGlvbihrZXkpIHtcbiAgICBpZiAoIXZhcmlhYmxlc1trZXldKSB7XG4gICAgICAgIGNvbnNvbGUuZXJyb3IoJ1ZhcmlhYmxlICcgKyBrZXkgKyAnIGRvZXMgbm90IGV4aXN0LicpO1xuICAgICAgICByZXR1cm47XG4gICAgfVxuICAgIHJldHVybiB2YXJpYWJsZXNba2V5XTtcbn07XG5cblN0eWxpemVyLnByb3RvdHlwZS5nZXRNaXhpbiA9IGZ1bmN0aW9uKGtleSkge1xuICAgIGlmICghbWl4aW5zW2tleV0pIHtcbiAgICAgICAgY29uc29sZS5lcnJvcignTWl4aW4gJyArIGtleSArICcgZG9lcyBub3QgZXhpc3QuJyk7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG4gICAgcmV0dXJuIG1peGluc1trZXldO1xufTtcblxudmFyIENTU1RlbXBsYXRlID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5zdHlsZSA9IHt9O1xuICAgIHRoaXMuX2NvbnRleHQgPSBudWxsO1xufTtcblxuQ1NTVGVtcGxhdGUucHJvdG90eXBlLnNlbGVjdCA9IGZ1bmN0aW9uKHNlbGVjdG9yKSB7XG4gICAgaWYgKCF0aGlzLnN0eWxlW3NlbGVjdG9yXSkge1xuICAgICAgICB0aGlzLnN0eWxlW3NlbGVjdG9yXSA9IHt9O1xuICAgIH1cbiAgICB0aGlzLl9jb250ZXh0ID0gdGhpcy5zdHlsZVtzZWxlY3Rvcl07XG4gICAgcmV0dXJuIHRoaXM7XG59O1xuXG5DU1NUZW1wbGF0ZS5wcm90b3R5cGUuY3NzID0gZnVuY3Rpb24oa2V5LCBhdHRyKSB7XG4gICAgaWYgKCF0aGlzLl9jb250ZXh0KSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignQ1NTIFNlbGVjdG9yIG5vdCBwcmVzZW50LicpO1xuICAgIH1cblxuICAgIGlmICh0eXBlb2Yga2V5ID09PSAnc3RyaW5nJykge1xuICAgICAgICBhZGRPbmVTdHlsZShrZXksIGF0dHIsIHRoaXMuX2NvbnRleHQpO1xuICAgIH0gZWxzZSBpZiAodHlwZW9mIGtleSA9PT0gJ29iamVjdCcpIHtcbiAgICAgICAgZm9yICh2YXIgayBpbiBrZXkpIHtcbiAgICAgICAgICAgIGFkZE9uZVN0eWxlKGssIGtleVtrXSwgdGhpcy5fY29udGV4dCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICByZXR1cm4gdGhpcztcblxuICAgIGZ1bmN0aW9uIGFkZE9uZVN0eWxlKGtleSwgYXR0ciwgb2JqKSB7XG4gICAgICAgIG9ialtrZXldID0gYXR0cjtcbiAgICB9XG59O1xuXG5DU1NUZW1wbGF0ZS5wcm90b3R5cGUudG9DU1MgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgcmV0ID0gJyc7XG5cbiAgICBmb3IgKHZhciBzZWxlY3RvciBpbiB0aGlzLnN0eWxlKSB7XG4gICAgICAgIC8vIEVycm9yIGZvciB3aGVuIHN0eWxlIGlzIG5vdCBhIHR3by1sYXllcnMgb2JqZWN0XG4gICAgICAgIC8vIEV4YW1wbGU6XG4gICAgICAgIC8vIGNzc1NlbGVjdG9yIDoge1xuICAgICAgICAvLyAgICAgY3NzUHJvcGVydGllczogY3NzQXR0cmlidXRlc1xuICAgICAgICAvLyB9XG4gICAgICAgIGlmICh0eXBlb2Ygc2VsZWN0b3IgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ0ludmFsaWQgU3R5bGUgT2JqZWN0Jyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0ICs9IHNlbGVjdG9yICsgJ3snO1xuICAgICAgICB2YXIgcHJvcGVydGllcyA9IHRoaXMuc3R5bGVbc2VsZWN0b3JdO1xuICAgICAgICBmb3IgKHZhciBwcm9wIGluIHByb3BlcnRpZXMpIHtcbiAgICAgICAgICAgIHZhciBzZXR0aW5nID0gcHJvcGVydGllc1twcm9wXTtcbiAgICAgICAgICAgICAgICBzZXR0aW5nID0gcmVwbGFjZVZhcmlhYmxlLmNhbGwodGhpcywgc2V0dGluZyk7XG4gICAgICAgICAgICByZXQgKz0gYXV0b1ByZWZpeChwcm9wLCBzZXR0aW5nKTtcbiAgICAgICAgfVxuICAgICAgICByZXQgPSByZXQuc3Vic3RyaW5nKDAsIHJldC5sZW5ndGggLSAxKTtcbiAgICAgICAgcmV0ICs9ICd9JztcbiAgICB9XG5cbiAgICByZXR1cm4gcmV0O1xuXG4gICAgLy8gSGVscGVyIG1ldGhvZCB0aGF0IHJldHVybiBjc3Mgc3RyaW5nIHdpdGggcHJlZml4ZXMgaWYgbmVjZXNzYXJ5XG4gICAgZnVuY3Rpb24gYXV0b1ByZWZpeChwcm9wLCBzZXR0aW5nKSB7XG4gICAgICAgIHZhciBwcmVmaXhlZFN0cmluZyA9ICcnICsgcHJvcCArICc6JyArIHNldHRpbmcgKyAnOyc7XG5cbiAgICAgICAgaWYgKHByb3AubWF0Y2goSVNfUFJFRklYQUJMRSkpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgX0FMTFZFTkRPUlMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBwcmVmaXhlZFN0cmluZyArPSBfQUxMVkVORE9SU1tpXSArIHByb3AgKyAnOicgKyBzZXR0aW5nICsgJzsnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKHNldHRpbmcubWF0Y2goSVNfUFJFRklYQUJMRSkpIHtcbiAgICAgICAgICAgIGZvciAodmFyIGogPSAwOyBqIDwgX0FMTFZFTkRPUlMubGVuZ3RoOyBqKyspIHtcbiAgICAgICAgICAgICAgICBwcmVmaXhlZFN0cmluZyArPSBwcm9wICsgJzonICsgX0FMTFZFTkRPUlNbal0gKyBzZXR0aW5nICsgJzsnO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHByZWZpeGVkU3RyaW5nO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlcGxhY2VWYXJpYWJsZShzZXR0aW5nKSB7XG4gICAgICAgIHZhciByZ2JzID0gc2V0dGluZy5tYXRjaCgvKChyZ2J8cmdiYSlcXChbXildKlxcKSkvZ2kpO1xuICAgICAgICB2YXIgcmdiLCBuZXdSZ2I7XG4gICAgICAgIHZhciBrZXksIHZhbDtcblxuICAgICAgICBpZiAocmdicykge1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCByZ2JzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgcmdiID0gcmdic1tqXTtcbiAgICAgICAgICAgICAgICBuZXdSZ2IgPSByZXBsYWNlQ29sb3IuY2FsbCh0aGlzLCByZ2IpO1xuICAgICAgICAgICAgICAgIHNldHRpbmcgPSBzZXR0aW5nLnJlcGxhY2UocmdiLCBuZXdSZ2IpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgdmFyIHZhcmlhYmxlcyA9IHNldHRpbmcubWF0Y2goL1xcJChbXlxcJF1bXlxcc1xcZFxcLFxcKFxcKV0rKS9naSk7XG5cbiAgICAgICAgaWYgKHZhcmlhYmxlcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB2YXJpYWJsZXMubGVuZ3RoOyBpKyspIHtcbiAgICAgICAgICAgICAgICBrZXkgPSB2YXJpYWJsZXNbaV0uc2xpY2UoMSk7XG4gICAgICAgICAgICAgICAgdmFsID0gU3R5bGl6ZXIucHJvdG90eXBlLmdldFZhcmlhYmxlLmNhbGwodGhpcywga2V5KTtcbiAgICAgICAgICAgICAgICBzZXR0aW5nID0gc2V0dGluZy5yZXBsYWNlKHZhcmlhYmxlc1tpXSwgdmFsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIHJldHVybiBzZXR0aW5nO1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJlcGxhY2VDb2xvcihyZ2IpIHtcbiAgICAgICAgdmFyIGNvbG9ycyA9IHJnYi5tYXRjaCgvXFwkKFteXFwkXVteXFxzXFxkXFwsXFwoXFwpXSspL2dpKTtcbiAgICAgICAgdmFyIGtleSwgdmFsO1xuXG4gICAgICAgIGlmIChjb2xvcnMpIHtcbiAgICAgICAgICAgIGtleSA9IGNvbG9yc1swXS5zbGljZSgxKTtcbiAgICAgICAgICAgIHZhbCA9IFN0eWxpemVyLnByb3RvdHlwZS5nZXRWYXJpYWJsZS5jYWxsKHRoaXMsIGtleSk7XG4gICAgICAgICAgICB2YWwgPSB0b1JHQih2YWwpO1xuICAgICAgICAgICAgcmdiID0gcmdiLnJlcGxhY2UoY29sb3JzWzBdLCB2YWwpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiByZ2I7XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gdG9SR0IoY29sb3IpIHtcbiAgICAgICAgaWYgKENPTE9SX01BUFtjb2xvcl0pIHtcbiAgICAgICAgICAgIGNvbG9yID0gQ09MT1JfTUFQW2NvbG9yXTtcbiAgICAgICAgfVxuXG4gICAgICAgIHZhciBpc0hleCA9IC9eIz8oW2EtZlxcZF17Mn0pKFthLWZcXGRdezJ9KShbYS1mXFxkXXsyfSkkL2kuZXhlYyhjb2xvcik7XG4gICAgICAgIHZhciBpc1JHQiA9IC8oKHJnYnxyZ2JhKVxcKFteKV0qXFwpKS9pLmV4ZWMoY29sb3IpO1xuXG4gICAgICAgIGlmIChpc0hleCkge1xuICAgICAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgICAgICBwYXJzZUludChpc0hleFsxXSwgMTYpLFxuICAgICAgICAgICAgICAgIHBhcnNlSW50KGlzSGV4WzJdLCAxNiksXG4gICAgICAgICAgICAgICAgcGFyc2VJbnQoaXNIZXhbM10sIDE2KVxuICAgICAgICAgICAgXS5qb2luKCcsJyk7XG4gICAgICAgIH0gXG5cbiAgICAgICAgaWYgKGlzUkdCKSB7XG4gICAgICAgICAgICByZXR1cm4gY29sb3IucmVwbGFjZSgvW2Etel18XFwofFxcKS9naSwgJycpXG4gICAgICAgICAgICAgICAgLnNwbGl0KCcsJylcbiAgICAgICAgICAgICAgICAuc2xpY2UoMCwgMylcbiAgICAgICAgICAgICAgICAuam9pbignLCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdJbnZhbGlkIGNvbG9yIHN0cmluZy4nKTtcbiAgICB9XG59O1xuXG5DU1NUZW1wbGF0ZS5wcm90b3R5cGUudG9IZXggPSBmdW5jdGlvbihyZ2IpIHtcbiAgICByZ2IgPSByZ2IucmVwbGFjZSgnICcsICcnKS5zcGxpdCgnLCcpO1xuICAgIHJldHVybiBcIiNcIiArIGNvbXBvbmVudFRvSGV4KHJnYlswXSkgKyBjb21wb25lbnRUb0hleChyZ2JbMV0pICsgY29tcG9uZW50VG9IZXgocmdiWzJdKTtcblxuICAgIGZ1bmN0aW9uIGNvbXBvbmVudFRvSGV4KGMpIHtcbiAgICAgICAgdmFyIGhleCA9ICgrYykudG9TdHJpbmcoMTYpO1xuICAgICAgICByZXR1cm4gaGV4Lmxlbmd0aCA9PSAxID8gXCIwXCIgKyBoZXggOiBoZXg7XG4gICAgfVxufTtcbiIsInZhciBtb2R1bGVTdG9yZSA9IHt9O1xuXG52YXIgTW9kdWxlID0gZnVuY3Rpb24oKSB7fTtcblxuTW9kdWxlLnByb3RvdHlwZS5leHBvcnQgPSBmdW5jdGlvbihrZXksIGZ1bmMpIHtcbiAgICBpZiAodHlwZW9mIGtleSAhPT0gJ3N0cmluZycpIHtcbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdNb2R1bGUgbmFtZSBpcyBub3QgYSBzdHJpbmcuJyk7XG4gICAgfVxuXG4gICAgaWYgKHR5cGVvZiBmdW5jICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignTW9kdWxlIGlzIG5vdCBhIGZ1bmN0aW9uLicpO1xuICAgIH1cbiAgICBtb2R1bGVTdG9yZVtrZXldID0gZnVuY3Rpb24oZG9uZSkge1xuICAgICAgICBkb25lKGZ1bmMoKSk7XG4gICAgfTtcbn07XG5cbk1vZHVsZS5wcm90b3R5cGUuaW1wb3J0ID0gZnVuY3Rpb24obW9kdWxlcykge1xuICAgIHZhciBsb2FkZWQgPSAwO1xuICAgIHZhciBjb3VudCAgPSBPYmplY3Qua2V5cyhtb2R1bGVzKTtcbiAgICB2YXIgdm93ID0gVm93KCk7XG4gICAgdmFyIHJldCA9IHt9O1xuICAgIHZhciB1cmw7XG5cbiAgICBfaW1wb3J0KGNvdW50LnBvcCgpLCB2b3cpO1xuXG4gICAgdm93LnByb21pc2UuYW5kID0ge307XG4gICAgdm93LnByb21pc2UuYW5kLmV4cG9ydCA9IGZ1bmN0aW9uKGtleSwgZnVuYykge1xuICAgICAgICBtb2R1bGVTdG9yZVtrZXldID0gZnVuY3Rpb24oZG9uZSkge1xuICAgICAgICAgICAgdm93LnByb21pc2VcbiAgICAgICAgICAgICAgICAudGhlbihmdW5jdGlvbihyZXQpIHtcbiAgICAgICAgICAgICAgICAgICAgbW9kdWxlU3RvcmVba2V5XSA9IGZ1bmMuYmluZCh0aGlzLCByZXQpO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZnVuYy5jYWxsKHRoaXMsIHJldCk7XG4gICAgICAgICAgICAgICAgfS5iaW5kKHRoaXMpKVxuICAgICAgICAgICAgICAgIC5kb25lKGRvbmUpO1xuICAgICAgICB9O1xuICAgIH0uYmluZCh0aGlzKTtcblxuICAgIHZvdy5wcm9taXNlLmFuZC5pbXBvcnQgPSBmdW5jdGlvbihtb2R1bGVzKSB7XG4gICAgICAgIHJldHVybiB2b3cucHJvbWlzZS50aGVuKHRoaXMuaW1wb3J0LmJpbmQodGhpcywgbW9kdWxlcykpO1xuICAgIH0uYmluZCh0aGlzKTtcblxuICAgIHJldHVybiB2b3cucHJvbWlzZTtcblxuICAgIGZ1bmN0aW9uIF9pbXBvcnQoa2V5LCBwcm9taXNlKSB7XG4gICAgICAgIHZhciB1cmwgPSBtb2R1bGVzW2tleV07XG5cbiAgICAgICAgaWYgKHR5cGVvZiBrZXkgIT09ICdzdHJpbmcnKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ01vZHVsZSBuYW1lIGlzIG5vdCBhIHN0cmluZy4nKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmICh0eXBlb2YgdXJsICE9PSAnc3RyaW5nJykge1xuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdVUkwgaXMgbm90IGEgc3RyaW5nLicpO1xuICAgICAgICB9XG5cbiAgICAgICAgdmFyIG1vZHVsZSA9IG1vZHVsZVN0b3JlW2tleV07XG4gICAgICAgIFxuICAgICAgICBpZiAoIW1vZHVsZSkge1xuICAgICAgICAgICAgdmFyIHNjcmlwdCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NjcmlwdCcpO1xuXG4gICAgICAgICAgICBzY3JpcHQudHlwZSA9IFwidGV4dC9qYXZhc2NyaXB0XCI7XG4gICAgICAgICAgICBzY3JpcHQuc3JjID0gdXJsO1xuICAgICAgICAgICAgc2NyaXB0Lm9ubG9hZCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZhciBkZWZlciA9IFZvdygpO1xuXG4gICAgICAgICAgICAgICAgY29uc29sZS5sb2coJ0xvYWRpbmcgJyArIGtleSArICcuLi4nKTtcblxuICAgICAgICAgICAgICAgIGRlZmVyLnByb21pc2UudGhlbihmdW5jdGlvbihkYXRhKSB7XG4gICAgICAgICAgICAgICAgICAgIHJldFtrZXldID0gZGF0YTtcbiAgICAgICAgICAgICAgICAgICAgbG9hZGVkKys7XG4gICAgICAgICAgICAgICAgICAgIGlmIChjb3VudC5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHByb21pc2UucmVzb2x2ZShyZXQpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgX2ltcG9ydChjb3VudC5wb3AoKSwgcHJvbWlzZSk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIHNjcmlwdC5yZW1vdmUoKTtcbiAgICAgICAgICAgICAgICBtb2R1bGVTdG9yZVtrZXldKGRlZmVyLnJlc29sdmUpO1xuICAgICAgICAgICAgfS5iaW5kKHRoaXMsIGtleSk7XG5cbiAgICAgICAgICAgIGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQoc2NyaXB0KTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHByb21pc2UucmVzb2x2ZShtb2R1bGUoKSk7XG4gICAgICAgIH1cbiAgICB9XG59O1xuIiwidmFyIHJlc291cmNlSWRHZW5lcmF0b3IgPSBpZEdlbmVyYXRvcigncmVzb3VyY2UnKTtcblxuLy8gR2xvYWJsIFJlc291cmNlcyBTdG9yYWdlXG52YXIgUkVTT1VSQ0VfU1RPUkUgPSB7fTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8gUmVzb3VyY2UgTWFuYWdlciBDbGFzcyAvLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xudmFyIFJlc291cmNlTWFuYWdlciA9IGZ1bmN0aW9uKCkge307XG5cblJlc291cmNlTWFuYWdlci5wcm90b3R5cGUucmVnaXN0ZXIgPSBmdW5jdGlvbihvcHRzKSB7XG4gICAgaWYgKCFvcHRzLm5hbWUpIHRocm93IG5ldyBFcnJvcignRXhwZWN0IHBhcmFtZXRlciB0byBoYXZlIHByb3BlcnR5OiBuYW1lLicpO1xuICAgIHZhciBSZXMgPSBSZXNvdXJjZS5leHRlbmQob3B0cyk7XG4gICAgUkVTT1VSQ0VfU1RPUkVbb3B0cy5uYW1lXSA9IG5ldyBSZXMob3B0cyk7XG59O1xuXG5SZXNvdXJjZU1hbmFnZXIucHJvdG90eXBlLmdldCA9IGZ1bmN0aW9uKG5hbWUpIHtcbiAgICB2YXIgcmVzb3VyY2UgPSBSRVNPVVJDRV9TVE9SRVtuYW1lXTtcbiAgICBpZiAoIXJlc291cmNlKSB0aHJvdyBuZXcgRXJyb3IoJ1Jlc291cmNlICcgKyBuYW1lICsgJyBub3QgZm91bmQuJyk7XG4gICAgcmV0dXJuIHJlc291cmNlO1xufTtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vIFJlc291cmNlIENsYXNzIC8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xudmFyIFJlc291cmNlID0ge307XG5cblJlc291cmNlLl9jb25zdHJ1Y3RvciA9IGZ1bmN0aW9uKG9wdHMpIHtcbiAgICB2YXIgY2FjaGUgPSBuZXcgTHJ1Q2FjaGUob3B0cy5jYWNoZVNpemUpO1xuICAgIHRoaXMudXVpZCA9IHJlc291cmNlSWRHZW5lcmF0b3IoKTtcbiAgICBuZXcgU2lnbmFsKHRoaXMudXVpZCwgdGhpcyk7XG5cbiAgICB0aGlzLnNldCA9IGNhY2hlLnNldC5iaW5kKHRoaXMpO1xuICAgIHRoaXMuZ2V0ID0gY2FjaGUuZ2V0LmJpbmQodGhpcyk7XG59O1xuXG4vLyBEZWNvcmF0ZWQgYWpheCBmdW5jdGlvblxuUmVzb3VyY2UuX2NvbnN0cnVjdG9yLnByb3RvdHlwZS5zZW5kUmVxdWVzdCA9IGZ1bmN0aW9uIChvcHRzLCBjYWxsYmFjaykge1xuICAgIHZhciByZXF1ZXN0ID0gbmV3IEFqYXgoe1xuICAgICAgICB0eXBlOiBvcHRzLnR5cGUsXG4gICAgICAgIHVybDogb3B0cy51cmwsXG4gICAgICAgIG9ubG9hZDogZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAgICAgICAgIGNhbGxiYWNrKHRoaXMuaW50ZXJjZXB0UmVzcG9uc2UocmVzcG9uc2UpKTtcbiAgICAgICAgfS5iaW5kKHRoaXMpXG4gICAgfSk7XG5cbiAgICB0aGlzLmludGVyY2VwdFJlcXVlc3QocmVxdWVzdCk7XG4gICAgcmVxdWVzdC5zZW5kKG9wdHMucGF5bG9hZCk7XG59O1xuXG5SZXNvdXJjZS5fY29uc3RydWN0b3IucHJvdG90eXBlLmludGVyY2VwdFJlc3BvbnNlID0gZnVuY3Rpb24ocmVzKSB7IHJldHVybiByZXM7IH07XG5SZXNvdXJjZS5fY29uc3RydWN0b3IucHJvdG90eXBlLmludGVyY2VwdFJlcXVlc3QgPSBmdW5jdGlvbihyZXEpIHsgcmV0dXJuIHJlcTsgfTtcblxuUmVzb3VyY2UuX2NvbnN0cnVjdG9yLnByb3RvdHlwZS5lbmNvZGVVcmxQYXJhbSA9IGZ1bmN0aW9uKHBhcmFtKSB7XG4gICAgdmFyIGVuY29kZWRTdHJpbmcgPSAnJztcbiAgICBmb3IgKHZhciBwcm9wIGluIHBhcmFtKSB7XG4gICAgICAgIGlmIChwYXJhbS5oYXNPd25Qcm9wZXJ0eShwcm9wKSkge1xuICAgICAgICAgICAgaWYgKGVuY29kZWRTdHJpbmcubGVuZ3RoID4gMCkge1xuICAgICAgICAgICAgICAgIGVuY29kZWRTdHJpbmcgKz0gJyYnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZW5jb2RlZFN0cmluZyArPSBlbmNvZGVVUkkocHJvcCArICc9JyArIHBhcmFtW3Byb3BdKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICByZXR1cm4gZW5jb2RlZFN0cmluZztcbn07XG5cblJlc291cmNlLl9jb25zdHJ1Y3Rvci5wcm90b3R5cGUuaGFzQmVlblVwZGF0ZWQgPSBmdW5jdGlvbihrZXkpIHtcbiAgICB0aGlzLmVtaXQoJ3VwZGF0ZTonICsgdGhpcy51dWlkLCBudWxsKTtcbn07XG5cblJlc291cmNlLmV4dGVuZCA9IGV4dGVuZDtcblxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vIExSVSBDYWNoZSAvLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG52YXIgTHJ1Q2FjaGUgPSBmdW5jdGlvbihzaXplKSB7XG4gICAgdmFyIG1hcCA9IHt9O1xuICAgIHZhciBsaXN0ID0gbmV3IERibHlMaW5rZWRMaXN0KCk7XG4gICAgdmFyIG1heExlbmd0aCA9IHNpemUgfHwgMDtcbiAgICBcbiAgICB0aGlzLnNldCA9IGZ1bmN0aW9uKGtleSwgZGF0YSkge1xuICAgICAgICB2YXIgbm9kZSA9IG1hcFtrZXldO1xuICAgICAgICB2YXIgb2xkVGFpbDtcblxuICAgICAgICBpZiAobm9kZSkge1xuICAgICAgICAgICAgbGlzdC5wdXNoVG9IZWFkKG5vZGUpO1xuICAgICAgICAgICAgbm9kZS5kYXRhID0gZGF0YTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIGxpc3QuYWRkVG9IZWFkKGtleSwgZGF0YSk7XG4gICAgICAgICAgICBtYXBba2V5XSA9IGxpc3QuaGVhZDtcbiAgICAgICAgfVxuXG4gICAgICAgIGlmIChtYXhMZW5ndGggIT09IDAgJiYgbGlzdC5sZW5ndGggPiBtYXhMZW5ndGgpIHtcbiAgICAgICAgICAgIG9sZFRhaWwgPSBsaXN0LnRhaWw7XG4gICAgICAgICAgICBsaXN0LnJlbW92ZVRhaWwoKTtcbiAgICAgICAgICAgIGRlbGV0ZSBtYXBbb2xkVGFpbC5rZXldO1xuICAgICAgICB9XG5cbiAgICB9O1xuXG4gICAgdGhpcy5nZXQgPSBmdW5jdGlvbihrZXkpIHtcbiAgICAgICAgdmFyIG5vZGUgPSBtYXBba2V5XTtcblxuICAgICAgICBpZiAobm9kZSkge1xuICAgICAgICAgICAgbGlzdC5wdXNoVG9IZWFkKG5vZGUpO1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIG5vZGUgPyBub2RlLmRhdGEgOiBudWxsO1xuXG4gICAgfTtcblxufTtcblxudmFyIERibHlMaW5rZWRMaXN0ID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy5oZWFkID0gbnVsbDtcbiAgICB0aGlzLnRhaWwgPSBudWxsO1xuICAgIHRoaXMubGVuZ3RoID0gMDtcbn07XG5cbkRibHlMaW5rZWRMaXN0LnByb3RvdHlwZS5hZGRUb0hlYWQgPSBmdW5jdGlvbihrZXksIGRhdGEpIHtcbiAgICB2YXIgbm9kZSA9IG5ldyBEYmx5TGlua2VkTGlzdE5vZGUoa2V5LCBkYXRhKTtcbiAgICB2YXIgb2xkSGVhZDtcblxuICAgIGlmICghdGhpcy5oZWFkICYmICF0aGlzLnRhaWwpIHtcbiAgICAgICAgdGhpcy5oZWFkID0gbm9kZTtcbiAgICAgICAgdGhpcy50YWlsID0gbm9kZTtcbiAgICB9IGVsc2Uge1xuICAgICAgICBvbGRIZWFkID0gdGhpcy5oZWFkO1xuICAgICAgICBvbGRIZWFkLnByZXYgPSBub2RlO1xuICAgICAgICBub2RlLm5leHQgPSBvbGRIZWFkO1xuICAgICAgICB0aGlzLmhlYWQgPSBub2RlO1xuICAgIH1cblxuICAgIHRoaXMubGVuZ3RoKys7XG5cbn07XG5cbkRibHlMaW5rZWRMaXN0LnByb3RvdHlwZS5wdXNoVG9IZWFkID0gZnVuY3Rpb24obm9kZSkge1xuICAgIHZhciBvbGRIZWFkID0gdGhpcy5oZWFkO1xuICAgIHZhciBwcmV2Tm9kZSA9IG5vZGUucHJldjtcbiAgICB2YXIgbmV4dE5vZGUgPSBub2RlLm5leHQ7XG5cbiAgICBpZiAodGhpcy5oZWFkID09PSBub2RlKSB7XG4gICAgICAgIHJldHVybjtcbiAgICB9XG5cbiAgICBpZiAocHJldk5vZGUgJiYgbmV4dE5vZGUpIHtcbiAgICAgICAgLy8gQ29ubmVjdCBwcmV2IGFuZCBuZXh0IG5vZGVzXG4gICAgICAgIHByZXZOb2RlLm5leHQgPSBuZXh0Tm9kZTtcbiAgICAgICAgbmV4dE5vZGUucHJldiA9IHByZXZOb2RlO1xuICAgIH0gZWxzZSBpZiAoIW5leHROb2RlKSB7XG4gICAgICAgIC8vIFNldCBuZXcgdGFpbFxuICAgICAgICB0aGlzLnRhaWwgPSBwcmV2Tm9kZTtcbiAgICAgICAgdGhpcy50YWlsLm5leHQgPSBudWxsO1xuICAgIH1cblxuICAgIC8vIFB1c2ggbm9kZSB0byBoZWFkXG4gICAgdGhpcy5oZWFkID0gbm9kZTtcbiAgICBub2RlLm5leHQgPSBvbGRIZWFkO1xuICAgIG9sZEhlYWQucHJldiA9IG5vZGU7XG5cbn07XG5cbkRibHlMaW5rZWRMaXN0LnByb3RvdHlwZS5yZW1vdmVUYWlsID0gZnVuY3Rpb24oKSB7XG4gICAgdGhpcy50YWlsID0gdGhpcy50YWlsLnByZXY7XG4gICAgdGhpcy50YWlsLm5leHQgPSBudWxsO1xuICAgIHRoaXMubGVuZ3RoLS07XG59O1xuXG52YXIgRGJseUxpbmtlZExpc3ROb2RlID0gZnVuY3Rpb24oa2V5LCBkYXRhKSB7XG4gICAgdGhpcy5wcmV2ID0gbnVsbDtcbiAgICB0aGlzLm5leHQgPSBudWxsO1xuICAgIHRoaXMua2V5ICA9IGtleTtcbiAgICB0aGlzLmRhdGEgPSBkYXRhO1xufTtcblxuXG4iLCJ2YXIgUmVuZGVyZXIgPSBmdW5jdGlvbigpe307XG5cblJlbmRlcmVyLnByb3RvdHlwZS5jcmVhdGVUZW1wbGF0ZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgVGVtcGxhdGUoKTtcbn07XG5cbnZhciBUZW1wbGF0ZSA9IGZ1bmN0aW9uKCl7XG4gICAgdGhpcy5fcXVldWUgPSBbXTtcbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vIERPTSBUZW1wbGF0aW5nIG1ldGhvZHMgLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuLy8gRWFjaCBvZiB0aGUgbWV0aG9kcyBiZWxvdyBwdXNoIGEgY29tbWFuZCBvYmplY3QgdG8gYSBjb21tYW5kIHF1ZXVlLlxuLy8gVGhlIGNvbW1hbmQgcXVldWUgd2lsbCBiZSBleGVjdXRlZCBieSAucmVuZGVyIHRvIGNyZWF0ZSBET00gZnJhZ21lbnRzLlxuVGVtcGxhdGUucHJvdG90eXBlLm9wZW4gICAgICAgICA9IHF1ZXVlQ29tbWFuZCgnb3BlblRhZycpO1xuVGVtcGxhdGUucHJvdG90eXBlLmFkZENsYXNzICAgICA9IHF1ZXVlQ29tbWFuZCgnYWRkQ2xhc3MnKTtcblRlbXBsYXRlLnByb3RvdHlwZS50ZXh0ICAgICAgICAgPSBxdWV1ZUNvbW1hbmQoJ3RleHQnKTtcblRlbXBsYXRlLnByb3RvdHlwZS5hdHRyICAgICAgICAgPSBxdWV1ZUNvbW1hbmQoJ2F0dHJpYnV0ZScpO1xuVGVtcGxhdGUucHJvdG90eXBlLnN0eWxlICAgICAgICA9IHF1ZXVlQ29tbWFuZCgnc3R5bGUnKTtcblRlbXBsYXRlLnByb3RvdHlwZS5kYXRhICAgICAgICAgPSBxdWV1ZUNvbW1hbmQoJ2RhdGEnKTtcblRlbXBsYXRlLnByb3RvdHlwZS5jbG9zZSAgICAgICAgPSBxdWV1ZUNvbW1hbmQoJ2Nsb3NlVGFnJyk7XG5UZW1wbGF0ZS5wcm90b3R5cGUuaWYgICAgICAgICAgID0gcXVldWVDb21tYW5kKCdpZicpO1xuVGVtcGxhdGUucHJvdG90eXBlLmVsc2UgICAgICAgICA9IHF1ZXVlQ29tbWFuZCgnZWxzZScpO1xuVGVtcGxhdGUucHJvdG90eXBlLmVhY2ggICAgICAgICA9IHF1ZXVlQ29tbWFuZCgnbG9vcCcpO1xuVGVtcGxhdGUucHJvdG90eXBlLmRvbmUgICAgICAgICA9IHF1ZXVlQ29tbWFuZCgnZG9uZScpO1xuVGVtcGxhdGUucHJvdG90eXBlLnhpZiAgICAgICAgICA9IFRlbXBsYXRlLnByb3RvdHlwZS5kb25lOyBcblRlbXBsYXRlLnByb3RvdHlwZS54ZWFjaCAgICAgICAgPSBUZW1wbGF0ZS5wcm90b3R5cGUuZG9uZTtcblxuZnVuY3Rpb24gcXVldWVDb21tYW5kKGNvbW1hbmROYW1lKSB7XG4gICAgcmV0dXJuIGZ1bmN0aW9uKCkge1xuICAgICAgICB0aGlzLl9xdWV1ZS5wdXNoKHtcbiAgICAgICAgICAgIGFjdGlvbjogY29tbWFuZE5hbWUsXG4gICAgICAgICAgICBkZXRhaWw6IEFycmF5LnByb3RvdHlwZS5zbGljZS5jYWxsKGFyZ3VtZW50cylcbiAgICAgICAgfSk7XG4gICAgICAgIHJldHVybiB0aGlzO1xuICAgIH07XG59XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gUmVuZGVyIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuVGVtcGxhdGUucHJvdG90eXBlLnJlbmRlciA9IGZ1bmN0aW9uKGRhdGEpIHtcbiAgICAvLyBSb290IGVsZW1lbnQgdG8gc3RvcmUgRE9Nc1xuICAgIHZhciByb290ICAgICAgICAgICAgPSBkb2N1bWVudC5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCksXG4gICAgLy8gU3RhY2tzIHRvIHJlZmVyZW5jZSBjdXJyZW50IGNvbnRleHRcbiAgICAgICAgZWxlbWVudHMgICAgICAgID0gW10sXG4gICAgICAgIGNvbmRpdGlvbmFscyAgICA9IFtdLFxuICAgICAgICBsb29wcyAgICAgICAgICAgPSBbXSxcbiAgICAgICAgc3RhdGVzICAgICAgICAgID0gW10sXG4gICAgLy8gUmVmZXJlbmNlIGluZGV4IGZvciBjdXJyZW50IGV4ZWN1dGlvblxuICAgICAgICBleGVjSW5kZXggICAgICAgPSAwLFxuICAgICAgICBlbCwgY29uZGl0aW9uLCBsb29wO1xuXG4gICAgaGFuZGxlQ29tbWFuZC5jYWxsKHRoaXMsIHRoaXMuX3F1ZXVlW2V4ZWNJbmRleF0sIGRhdGEpO1xuXG4gICAgcmV0dXJuIHJvb3Q7XG5cbiAgICBmdW5jdGlvbiBoYW5kbGVDb21tYW5kKGNvbW1hbmQsIGV4ZWNEYXRhKSB7XG4gICAgICAgIC8vIEdyYWIgY3VycmVudCBzdGF0ZTogTE9PUCwgQ09ORElUSU9OQUwsIG9yIHVuZGVmaW5lZFxuICAgICAgICB2YXIgc3RhdGUgPSBnZXRMYXN0RnJvbShzdGF0ZXMpO1xuXG4gICAgICAgIC8vIEJhc2UgY2FzZTogZXhpdCBpZiBubyBjb21tYW5kXG4gICAgICAgIGlmICghY29tbWFuZCkge1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gQ2hhbmdlIGRhdGEgaW4gY3VycmVudCBleGVjdWF0aW9uIGlmIGluIGEgbG9vcFxuICAgICAgICAvLyBGcm9tIFt7YTogJ2EnfSwge2I6ICdiJ30sIHtjOiAnYyd9XSB0byB7YTogJ2EnfVxuICAgICAgICBpZiAoc3RhdGUgPT09ICdMT09QJykge1xuICAgICAgICAgICAgc2V0RGF0YUNvbnRleHQoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIC8vIEhhbmRsZSBJRiwgRUxTRSwgRUFDSCwgb3IgRE9ORVxuICAgICAgICAvLyBUaGVzZSBtZXRob2RzIGNoYW5nZSBzdGF0ZSBvZiByZW5kZXJpbmdcbiAgICAgICAgaGFuZGxlU3RhdGVBY3Rpb25zKCk7XG5cbiAgICAgICAgLy8gRXhpdCBpZiBjb25kaXRpb24gaXMgbm90IG1ldFxuICAgICAgICBpZiAoKHN0YXRlID09PSAnQ09ORElUSU9OQUwnICYmICFnZXRMYXN0RnJvbShjb25kaXRpb25hbHMpKSB8fCAoc3RhdGUgPT09ICdMT09QJyAmJiAhZXhlY0RhdGEpKSB7XG4gICAgICAgICAgICBoYW5kbGVDb21tYW5kLmNhbGwodGhpcywgdGhpcy5fcXVldWVbKytleGVjSW5kZXhdLCBleGVjRGF0YSk7XG4gICAgICAgICAgICByZXR1cm47XG4gICAgICAgIH1cblxuICAgICAgICAvLyBIYW5kbGUgQ1JFQVRFLCBBUFBFTkQsIFNUWUxFLCBBVFRSLCBURVhUXG4gICAgICAgIC8vIFRoZXNlIG1ldGhvZHMgYXJlIHB1cmVseSByZW5kZXJpbmcgYW5kIGRvIG5vdCBjaGFuZ2UgcmVuZGVyaW5nIHN0YXRlXG4gICAgICAgIGhhbmRsZUNvbW1vbkFjdGlvbnMoKTtcblxuICAgICAgICAvLyBJbmNyZW1lbnQgaW5kZXggZm9yIG5leHQgZXhlY3V0aW9uXG4gICAgICAgIGV4ZWNJbmRleCsrO1xuXG4gICAgICAgIC8vIEV4ZWN1dGUgbmV4dCBjb21tYW5kXG4gICAgICAgIGhhbmRsZUNvbW1hbmQuY2FsbCh0aGlzLCB0aGlzLl9xdWV1ZVtleGVjSW5kZXhdLCBleGVjRGF0YSk7XG4gICAgICAgIFxuICAgICAgICBmdW5jdGlvbiBzZXREYXRhQ29udGV4dCgpIHtcbiAgICAgICAgICAgIGxvb3AgPSBnZXRMYXN0RnJvbShsb29wcyk7XG4gICAgICAgICAgICBleGVjRGF0YSA9IGxvb3AuZGF0YVtsb29wLmluZGV4XTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGhhbmRsZVN0YXRlQWN0aW9ucygpIHtcbiAgICAgICAgICAgIGlmIChjb21tYW5kLmFjdGlvbiA9PT0gJ2xvb3AnKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlTG9vcCgpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAoY29tbWFuZC5hY3Rpb24gPT09ICdkb25lJykge1xuICAgICAgICAgICAgICAgIGhhbmRsZURvbmUoKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uID09PSAnaWYnKSB7XG4gICAgICAgICAgICAgICAgaGFuZGxlSWYoKTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgaWYgKGNvbW1hbmQuYWN0aW9uID09PSAnZWxzZScpIHtcbiAgICAgICAgICAgICAgICBoYW5kbGVFbHNlKCk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBoYW5kbGVMb29wKCkge1xuICAgICAgICAgICAgc3RhdGVzLnB1c2goJ0xPT1AnKTtcbiAgICAgICAgICAgIGxvb3BzLnB1c2goe1xuICAgICAgICAgICAgICAgIGRhdGE6IGV2YWx1YXRlKGV4ZWNEYXRhLCBjb21tYW5kLmRldGFpbFswXSksXG4gICAgICAgICAgICAgICAgaW5kZXg6IDAsXG4gICAgICAgICAgICAgICAgc3RhcnQ6IGV4ZWNJbmRleFxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBoYW5kbGVEb25lKCkge1xuICAgICAgICAgICAgc3RhdGVzLnBvcCgpO1xuICAgICAgICAgICAgaWYgKHN0YXRlID09PSAnQ09ORElUSU9OQUwnKSB7XG4gICAgICAgICAgICAgICAgY29uZGl0aW9uYWxzLnBvcCgpO1xuICAgICAgICAgICAgfSBlbHNlIGlmIChzdGF0ZSA9PT0gJ0xPT1AnKSB7XG4gICAgICAgICAgICAgICAgbG9vcCA9IGdldExhc3RGcm9tKGxvb3BzKTtcbiAgICAgICAgICAgICAgICBsb29wLmluZGV4ID0gbG9vcC5pbmRleCArIDE7XG4gICAgICAgICAgICAgICAgLy8gSWYgY3VycmVudCBsb29wIGlzIG5vdCBkb25lLCBzZXQgc3RhdGUgYmFjayB0byBsb29wXG4gICAgICAgICAgICAgICAgLy8gYW5kIHNldCBuZXh0IGV4ZWN1dGlvbiBhdCBzdGFydCBvZiBsb29wXG4gICAgICAgICAgICAgICAgaWYgKGxvb3AuaW5kZXggPCBsb29wLmRhdGEubGVuZ3RoKSB7XG4gICAgICAgICAgICAgICAgICAgIGV4ZWNJbmRleCA9IGxvb3Auc3RhcnQ7XG4gICAgICAgICAgICAgICAgICAgIHN0YXRlcy5wdXNoKCdMT09QJyk7XG4gICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgbG9vcHMucG9wKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlSWYoKSB7XG4gICAgICAgICAgICBzdGF0ZXMucHVzaCgnQ09ORElUSU9OQUwnKTtcbiAgICAgICAgICAgIGNvbmRpdGlvbiA9IGV2YWx1YXRlKGV4ZWNEYXRhLCBjb21tYW5kLmRldGFpbFswXSk7XG4gICAgICAgICAgICBjb25kaXRpb25hbHMucHVzaChjb25kaXRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlRWxzZSgpIHtcbiAgICAgICAgICAgIGNvbmRpdGlvbiA9ICFjb25kaXRpb25hbHMucG9wKCk7XG4gICAgICAgICAgICBjb25kaXRpb25hbHMucHVzaChjb25kaXRpb24pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaGFuZGxlQ29tbW9uQWN0aW9ucygpIHtcbiAgICAgICAgICAgIHN3aXRjaCAoY29tbWFuZC5hY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBjYXNlICdvcGVuVGFnJzpcbiAgICAgICAgICAgICAgICAgICAgZWxlbWVudHMucHVzaChjcmVhdGVUYWcuYXBwbHkobnVsbCwgY29tbWFuZC5kZXRhaWwpKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAnYWRkQ2xhc3MnOlxuICAgICAgICAgICAgICAgICAgICBlbCA9IGdldExhc3RGcm9tKGVsZW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgYWRkQ2xhc3MuYXBwbHkoZWwsIFtldmFsdWF0ZShleGVjRGF0YSwgY29tbWFuZC5kZXRhaWxbMF0pXSk7XG4gICAgICAgICAgICAgICAgICAgIGJyZWFrO1xuICAgICAgICAgICAgICAgIGNhc2UgJ3N0eWxlJzpcbiAgICAgICAgICAgICAgICAgICAgZWwgPSBnZXRMYXN0RnJvbShlbGVtZW50cyk7XG4gICAgICAgICAgICAgICAgICAgIGFkZFN0eWxlLmFwcGx5KGVsLCBbZXZhbHVhdGUoZXhlY0RhdGEsIGNvbW1hbmQuZGV0YWlsWzBdKSwgZXZhbHVhdGUoZXhlY0RhdGEsIGNvbW1hbmQuZGV0YWlsWzFdKV0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdhdHRyaWJ1dGUnOlxuICAgICAgICAgICAgICAgICAgICBlbCA9IGdldExhc3RGcm9tKGVsZW1lbnRzKTtcbiAgICAgICAgICAgICAgICAgICAgYWRkQXR0cmlidXRlLmFwcGx5KGVsLCBbZXZhbHVhdGUoZXhlY0RhdGEsIGNvbW1hbmQuZGV0YWlsWzBdKSwgZXZhbHVhdGUoZXhlY0RhdGEsIGNvbW1hbmQuZGV0YWlsWzFdKV0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdkYXRhJzpcbiAgICAgICAgICAgICAgICAgICAgZWwgPSBnZXRMYXN0RnJvbShlbGVtZW50cyk7XG4gICAgICAgICAgICAgICAgICAgIHBhdGNoRWxlbWVudC5hcHBseShlbCwgW2V2YWx1YXRlKGV4ZWNEYXRhLCBjb21tYW5kLmRldGFpbFswXSldKTtcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgY2FzZSAndGV4dCc6XG4gICAgICAgICAgICAgICAgICAgIGVsID0gZ2V0TGFzdEZyb20oZWxlbWVudHMpO1xuICAgICAgICAgICAgICAgICAgICBhZGRUZXh0LmFwcGx5KGVsLCBbZXZhbHVhdGUoZXhlY0RhdGEsIGNvbW1hbmQuZGV0YWlsWzBdKV0pO1xuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgICAgICBjYXNlICdjbG9zZVRhZyc6XG4gICAgICAgICAgICAgICAgICAgIGVsID0gZWxlbWVudHMucG9wKCk7XG4gICAgICAgICAgICAgICAgICAgIGlmIChlbGVtZW50cy5sZW5ndGggPT09IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHJvb3QuYXBwZW5kQ2hpbGQoZWwpO1xuICAgICAgICAgICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0TGFzdEZyb20oZWxlbWVudHMpLmFwcGVuZENoaWxkKGVsKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICBicmVhaztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8gUGF0Y2ggLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuVGVtcGxhdGUucHJvdG90eXBlLnBhdGNoID0gZnVuY3Rpb24ocm9vdCwgZGF0YSkge1xuICAgIHZhciBmcmFnID0gdGhpcy5yZW5kZXIoZGF0YSk7XG5cbiAgICBfcGF0Y2gocm9vdCwgZnJhZyk7XG5cbiAgICBmdW5jdGlvbiBfcGF0Y2goZnJvbSwgdG8pIHtcbiAgICAgICAgdmFyIGZyb21Ob2RlLCB0b05vZGU7XG4gICAgICAgIHZhciBsZW5ndGggPSBNYXRoLm1heChmcm9tLmNoaWxkTm9kZXMubGVuZ3RoLCB0by5jaGlsZE5vZGVzLmxlbmd0aCk7XG5cbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW5ndGg7IGkrKykge1xuICAgICAgICAgICAgZnJvbU5vZGUgPSBmcm9tLmNoaWxkTm9kZXNbaV07XG4gICAgICAgICAgICB0b05vZGUgICA9IHRvLmNoaWxkTm9kZXNbaV07XG5cbiAgICAgICAgICAgIGlmICghdG9Ob2RlICYmIGZyb21Ob2RlKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQWxsQWZ0ZXIoZnJvbSwgaSk7XG4gICAgICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgICAgfSBlbHNlIGlmICghZnJvbU5vZGUgJiYgdG9Ob2RlKSB7XG4gICAgICAgICAgICAgICAgZnJvbS5hcHBlbmRDaGlsZCh0b05vZGUuY2xvbmVOb2RlKHRydWUpKTtcbiAgICAgICAgICAgIH0gZWxzZSBpZiAoZnJvbU5vZGUudGFnTmFtZSAhPT0gdG9Ob2RlLnRhZ05hbWUpIHtcbiAgICAgICAgICAgICAgICBmcm9tLnJlcGxhY2VDaGlsZCh0b05vZGUuY2xvbmVOb2RlKHRydWUpLCBmcm9tTm9kZSk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIHBhdGNoTm9kZShmcm9tTm9kZSwgdG9Ob2RlKTtcbiAgICAgICAgICAgICAgICBfcGF0Y2goZnJvbU5vZGUsIHRvTm9kZSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiByZW1vdmVBbGxBZnRlcihub2RlLCBpbmRleCkge1xuICAgICAgICBmb3IgKHZhciBpID0gbm9kZS5jaGlsZE5vZGVzLmxlbmd0aCAtIDE7IGkgPj0gaW5kZXg7IGktLSkge1xuICAgICAgICAgICAgbm9kZS5jaGlsZE5vZGVzW2ldLnJlbW92ZSgpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgZnVuY3Rpb24gcGF0Y2hOb2RlKGZyb20sIHRvKSB7XG4gICAgICAgIHBhdGNoQ2xhc3MoZnJvbSwgdG8pO1xuICAgICAgICBwYXRjaFN0eWxlKGZyb20sIHRvKTtcbiAgICAgICAgcGF0Y2hBdHRyaWJ1dGVzKGZyb20sIHRvKTtcbiAgICAgICAgcGF0Y2hUZXh0KGZyb20sIHRvKTtcbiAgICAgICAgcGF0Y2hTaGFkb3dSb290KGZyb20sIHRvKTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXRjaENsYXNzKGZyb20sIHRvKSB7XG4gICAgICAgIHZhciBtYXA7XG4gICAgICAgIHZhciB0b0NsYXNzZXMgICA9IHRvICYmIHRvLmNsYXNzTmFtZSA/IHRvLmNsYXNzTmFtZS5zcGxpdCgnICcpIDogW107XG4gICAgICAgIHZhciBmcm9tQ2xhc3NlcyA9IGZyb20gJiYgZnJvbS5jbGFzc05hbWUgPyBmcm9tLmNsYXNzTmFtZS5zcGxpdCgnICcpIDogW107XG4gICAgICAgIFxuICAgICAgICBtYXAgPSB0b0NsYXNzZXMucmVkdWNlKGZ1bmN0aW9uKGFjY3VtdWxhdG9yLCBjbHMpIHtcbiAgICAgICAgICAgIGlmIChjbHMgPT09ICcnKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIGFjY3VtdWxhdG9yO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYWRkQ2xhc3MuY2FsbChmcm9tLCBjbHMpO1xuICAgICAgICAgICAgYWNjdW11bGF0b3JbY2xzXSA9IGNscztcbiAgICAgICAgICAgIHJldHVybiBhY2N1bXVsYXRvcjtcbiAgICAgICAgfSwge30pO1xuXG4gICAgICAgIGZyb21DbGFzc2VzLmZvckVhY2goZnVuY3Rpb24oY2xzKSB7XG4gICAgICAgICAgICBpZiAoIW1hcFtjbHNdKSB7XG4gICAgICAgICAgICAgICAgcmVtb3ZlQ2xhc3MuY2FsbChmcm9tLCBjbHMpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXRjaFRleHQoZnJvbSwgdG8pIHtcbiAgICAgICAgaWYgKGZyb20udGV4dENvbnRlbnQgIT09IHRvLnRleHRDb250ZW50KSB7XG4gICAgICAgICAgICBmcm9tLnRleHRDb250ZW50ID0gdG8udGV4dENvbnRlbnQ7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBwYXRjaFN0eWxlKGZyb20sIHRvKSB7XG4gICAgICAgIHZhciBtYXAgPSB7fTtcbiAgICAgICAgdmFyIHN0eWxlS2V5LCBzdHlsZVZhbCwgZnJvbUtleXM7XG5cbiAgICAgICAgaWYgKHRvLnN0eWxlKSB7XG4gICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHRvLnN0eWxlLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgc3R5bGVLZXkgPSB0by5zdHlsZVtpXTtcbiAgICAgICAgICAgICAgICBzdHlsZVZhbCA9IHRvLnN0eWxlW3RvLnN0eWxlW2ldXTtcbiAgICAgICAgICAgICAgICBhZGRTdHlsZS5jYWxsKGZyb20sIHN0eWxlS2V5LCBzdHlsZVZhbCk7XG4gICAgICAgICAgICAgICAgbWFwW3N0eWxlS2V5XSA9IHN0eWxlVmFsO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZyb20uc3R5bGUpIHtcbiAgICAgICAgICAgIGZyb21LZXlzID0gQXJyYXkucHJvdG90eXBlLnNsaWNlLmNhbGwoZnJvbS5zdHlsZSk7XG4gICAgICAgICAgICBmb3IgKHZhciBqID0gMDsgaiA8IGZyb21LZXlzLmxlbmd0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgc3R5bGVLZXkgPSBmcm9tS2V5c1tqXTtcbiAgICAgICAgICAgICAgICBpZiAoIW1hcFtzdHlsZUtleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgYWRkU3R5bGUuY2FsbChmcm9tLCBzdHlsZUtleSwgJycpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhdGNoQXR0cmlidXRlcyhmcm9tLCB0bykge1xuICAgICAgICB2YXIgbWFwID0ge307XG4gICAgICAgIHZhciBhdHRyLCBhdHRyS2V5LCBhdHRyVmFsLCBmcm9tS2V5cztcblxuICAgICAgICBpZiAodG8uYXR0cmlidXRlcykge1xuICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0by5hdHRyaWJ1dGVzLmxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICAgICAgYXR0ciA9IHRvLmF0dHJpYnV0ZXNbaV07XG4gICAgICAgICAgICAgICAgYXR0cktleSA9IGF0dHIubmFtZTtcbiAgICAgICAgICAgICAgICBpZiAoYXR0cktleSAhPT0gJ3N0eWxlJyAmJiBhdHRyS2V5ICE9PSAnY2xhc3MnKSB7XG4gICAgICAgICAgICAgICAgICAgIGZyb20uc2V0QXR0cmlidXRlKGF0dHJLZXksIGF0dHIudmFsdWUpO1xuICAgICAgICAgICAgICAgICAgICBtYXBbYXR0cktleV0gPSBhdHRyLnZhbHVlOyAgICAgICAgICAgICAgICAgXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGZyb20uYXR0cmlidXRlcykge1xuICAgICAgICAgICAgZnJvbUtleXMgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChmcm9tLmF0dHJpYnV0ZXMpO1xuICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBmcm9tS2V5cy5sZW5ndGg7IGorKykge1xuICAgICAgICAgICAgICAgIGF0dHIgPSBmcm9tS2V5c1tqXTtcbiAgICAgICAgICAgICAgICBhdHRyS2V5ID0gYXR0ci5uYW1lO1xuICAgICAgICAgICAgICAgIGlmIChhdHRyS2V5ICE9PSAnc3R5bGUnICYmIGF0dHJLZXkgIT09ICdjbGFzcycpIHtcbiAgICAgICAgICAgICAgICAgICAgaWYgKCFtYXBbYXR0cktleV0pIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGZyb20uc2V0QXR0cmlidXRlKGF0dHJLZXksICcnKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cblxuICAgIGZ1bmN0aW9uIHBhdGNoU2hhZG93Um9vdChmcm9tLCB0bykge1xuICAgICAgICBpZihmcm9tLnNoYWRvd1Jvb3QgJiYgdG8uc2hhZG93Um9vdCkge1xuICAgICAgICAgICAgX3BhdGNoKGZyb20uc2hhZG93Um9vdCwgdG8uc2hhZG93Um9vdCk7XG4gICAgICAgIH1cbiAgICB9XG5cbn07XG5cbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuLy8vLy8vLy8vLy8vLy8vLy8vLyBIZWxwZXIgTWV0aG9kcyAvLy8vLy8vLy8vLy8vLy8vLy8vXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuZnVuY3Rpb24gY3JlYXRlVGFnKHRhZykge1xuICAgIHZhciB0YWdOYW1lID0gcGFyc2VUYWcodGFnKTtcbiAgICB2YXIgZWwgICAgICA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQodGFnTmFtZVswXSk7XG5cbiAgICBpZiAodGFnTmFtZVsxXSA9PT0gJy4nKSB7XG4gICAgICAgIGVsLmNsYXNzTmFtZSA9IHRhZ05hbWVbMl07XG4gICAgfSBlbHNlIGlmICh0YWdOYW1lWzFdID09PSAnIycpIHtcbiAgICAgICAgZWwuaWQgPSB0YWdOYW1lWzJdO1xuICAgIH1cblxuICAgIHJldHVybiBlbDtcbn1cblxuZnVuY3Rpb24gYWRkQ2xhc3MoY2xhc3NOYW1lKSB7XG4gICAgdmFyIHNlcGFyYXRvciA9IHRoaXMuY2xhc3NOYW1lLmxlbmd0aCA+IDAgPyAnICcgOiAnJztcbiAgICBjbGFzc05hbWUgPSB0eXBlb2YgY2xhc3NOYW1lID09PSAnc3RyaW5nJyA/IGNsYXNzTmFtZSA6ICcnO1xuXG4gICAgaWYgKCFoYXNDbGFzcyh0aGlzLCBjbGFzc05hbWUpKSB7XG4gICAgICAgIHRoaXMuY2xhc3NOYW1lICs9IHNlcGFyYXRvciArIGNsYXNzTmFtZTtcbiAgICB9XG59XG5cbmZ1bmN0aW9uIHJlbW92ZUNsYXNzKGNsYXNzTmFtZSkge1xuICAgIGlmIChoYXNDbGFzcyh0aGlzLCBjbGFzc05hbWUpKSB7XG4gICAgICAgIHZhciBvbGQgPSB0aGlzLmNsYXNzTmFtZTtcbiAgICAgICAgdmFyIG91dCA9IG9sZC5yZXBsYWNlKG5ldyBSZWdFeHAoJyhcXFxcc3xeKScgKyBjbGFzc05hbWUgKyAnKFxcXFxzfCQpJyksICcgJyk7XG4gICAgICAgIHRoaXMuY2xhc3NOYW1lID0gb3V0O1xuICAgIH1cbn1cblxuZnVuY3Rpb24gYWRkU3R5bGUoYXR0ciwgdmFsKSB7XG4gICAgaWYgKHRoaXMuc3R5bGVbYXR0cl0gIT09IHZhbCkge1xuICAgICAgICB0aGlzLnN0eWxlW2F0dHJdID0gdmFsO1xuICAgIH1cbn1cblxuZnVuY3Rpb24gYWRkQXR0cmlidXRlKGF0dHIsIHZhbCkge1xuICAgIHRoaXMuc2V0QXR0cmlidXRlKGF0dHIsIHR5cGVvZiB2YWwgPT09ICd1bmRlZmluZWQnID8gJycgOiB2YWwpO1xufVxuXG5mdW5jdGlvbiBhZGRUZXh0KGNvbnRlbnQpIHtcbiAgICB0aGlzLnRleHRDb250ZW50ID0gY29udGVudDtcbn1cblxuZnVuY3Rpb24gcGF0Y2hFbGVtZW50KGRhdGEpIHtcbiAgICB0aGlzLnBhdGNoKGRhdGEpO1xufVxuXG5mdW5jdGlvbiBnZXRMYXN0RnJvbShhcnJheSkge1xuICAgIHJldHVybiBhcnJheVthcnJheS5sZW5ndGggLSAxXTtcbn1cblxuZnVuY3Rpb24gaGFzQ2xhc3MoZWwsIGNsYXNzTmFtZSkge1xuICByZXR1cm4gISFlbC5jbGFzc05hbWUubWF0Y2gobmV3IFJlZ0V4cCgnKFxcXFxzfF4pJytjbGFzc05hbWUrJyhcXFxcc3wkKScpKTtcbn1cblxuZnVuY3Rpb24gcGFyc2VUYWcodGFnKSB7XG4gICAgdGFnID0gdGFnLnJlcGxhY2UoL1suI10vLCBmdW5jdGlvbihkKSB7IHJldHVybiAnLCcgKyBkICsgJywnO30pXG4gICAgICAgICAgICAgLnNwbGl0KCcsJyk7XG4gICAgcmV0dXJuIHRhZztcbn1cblxuZnVuY3Rpb24gaXNDdXN0b21FbGVtZW50KHRhZykge1xuICAgIHJldHVybiAhIXRhZy5tYXRjaCgnLScpO1xufVxuXG5mdW5jdGlvbiBldmFsdWF0ZShkYXRhLCBmdW5jT3JWYWwpIHtcbiAgICBzd2l0Y2ggKHR5cGVvZiBmdW5jT3JWYWwpIHtcbiAgICAgICAgY2FzZSAnZnVuY3Rpb24nOlxuICAgICAgICAgICAgdHJ5IHtcbiAgICAgICAgICAgICAgICByZXR1cm4gZnVuY09yVmFsLmNhbGwodGhpcywgZGF0YSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgIGRlZmF1bHQ6XG4gICAgICAgICAgICByZXR1cm4gZnVuY09yVmFsO1xuXG4gICAgfVxufVxuIiwidmFyIFRyaW8gPSB7XG4gICAgRmFjdG9yeTogRmFjdG9yeSxcbiAgICBTZXJ2aWNlOiBTZXJ2aWNlLFxuICAgIENvbXBvbmVudDogQ29tcG9uZW50TWFuYWdlcixcbiAgICBWb3c6IFZvdyxcbiAgICBBSkFYOiB7XG4gICAgICAgIGludGVyY2VwdEFsbFJlcXVlc3Q6IGZ1bmN0aW9uKGNiKSB7XG4gICAgICAgICAgICBHTE9CQUxfQUpBWF9SRVFVRVNUX0lOVEVSQ0VQVCA9IGNiO1xuICAgICAgICB9LFxuICAgICAgICBpbnRlcmNlcHRBbGxSZXNwb25zZTogZnVuY3Rpb24oY2IpIHtcbiAgICAgICAgICAgIEdMT0JBTF9BSkFYX1JFU1BPTlNFX0lOVEVSQ0VQVCA9IGNiO1xuICAgICAgICB9XG4gICAgfSxcbiAgICBTdHlsaXplcjogbmV3IFN0eWxpemVyKCksXG4gICAgUmVuZGVyZXI6IG5ldyBSZW5kZXJlcigpLFxuICAgIE1vZHVsZTogbmV3IE1vZHVsZSgpLFxuICAgIFJlc291cmNlOiBuZXcgUmVzb3VyY2VNYW5hZ2VyKCksXG4gICAgVkVSU0lPTjogJzAuMS4yJ1xufTtcblxuaWYgKG1vZHVsZSAmJiBtb2R1bGUuZXhwb3J0cykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gVHJpbztcbn0gZWxzZSB7XG4gICAgd2luZG93LlRyaW8gPSBUcmlvO1xufVxuIiwid2luZG93LlRyaW8gPSByZXF1aXJlKCd0cmlvJyk7Il19
